{"ast":null,"code":"import _defineProperty from \"/Users/mata/app-cloudweb/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/components/page/sections/image/UploadImage.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport { ViewList, Insert, Delete, Patch } from '@webcms/orest';\nimport WebCmsGlobal from 'components/webcms-global';\nimport { useRouter } from 'next/router';\nimport { connect } from 'react-redux';\nimport { FIELDTYPE, isErrorMsg, OREST_ENDPOINT, OREST_UPLOAD } from '../../../../../../../model/orest/constants';\nimport Grid from '@material-ui/core/Grid';\nimport Card from '@material-ui/core/Card';\nimport Fab from '@material-ui/core/Fab';\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport { DropzoneDialog } from 'material-ui-dropzone';\nimport { makeStyles } from '@material-ui/core/styles';\nimport axios from 'axios';\nimport { toast } from 'react-toastify';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport Paper from '@material-ui/core/Paper';\nimport LoadingSpinner from '../../../../../../LoadingSpinner';\nimport { COLORS, UPLOAD_SUCCESS, DELETE_SUCCESS, SAVED_SUCCESS, PERCENTAGE_VALUES } from '../../../../constants';\nimport { toSelfName } from './../../../../../../../lib/helpers/useFunction';\nimport Typography from '@material-ui/core/Typography';\nimport CancelIcon from '@material-ui/icons/Cancel';\nimport IconButton from '@material-ui/core/IconButton';\nimport Divider from '@material-ui/core/Divider';\nimport validator from 'validator';\nimport { PercentageSlider } from '../../../../../../../model/slider';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport { FormControlLabel } from '@material-ui/core';\nimport InputColor from 'react-input-color';\nimport TextEditor from '../text-editor';\nimport BorderColorSharpIcon from '@material-ui/icons/BorderColorSharp';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    root: {\n      card: {\n        maxWidth: 345\n      },\n      media: {\n        height: 0,\n        paddingTop: '56.25%'\n      }\n    },\n    submit: {\n      marginRight: theme.spacing(1),\n      marginBottom: theme.spacing(1),\n      borderRadius: 20,\n      marginTop: theme.spacing(1),\n      \"float\": 'right'\n    },\n    fabBtn: {\n      marginBottom: theme.spacing(1),\n      marginLeft: theme.spacing(1)\n    },\n    disableEvent: {\n      pointerEvents: 'none',\n      opacity: 0.5\n    },\n    paperBlock: {\n      height: 250,\n      border: \"2px solid \".concat(COLORS === null || COLORS === void 0 ? void 0 : COLORS.secondary),\n      overflow: 'auto',\n      position: 'relative'\n    },\n    card: {\n      height: 245,\n      width: 392,\n      cursor: 'pointer'\n    },\n    heading: {\n      marginTop: theme.spacing(1),\n      marginLeft: theme.spacing(2),\n      fontWeight: 'bold',\n      fontSize: 15\n    },\n    textField: {\n      paddingRight: theme.spacing(1)\n    },\n    alignText: {\n      textAlign: 'right',\n      color: 'red'\n    }\n  };\n});\n\nvar UploadImage = function UploadImage(props) {\n  _s();\n\n  var _state$assets, _state$assets$colors, _state$assets$colors$;\n\n  var state = props.state,\n      component = props.component,\n      handleSectionComponent = props.handleSectionComponent,\n      handleNextDisable = props.handleNextDisable;\n  var router = useRouter();\n  var companyId = router.query.companyID;\n\n  var _useContext = useContext(WebCmsGlobal),\n      GENERAL_SETTINGS = _useContext.GENERAL_SETTINGS,\n      token = _useContext.token;\n\n  var authToken = token || router.query.authToken; //local state\n\n  var _useState = useState(false),\n      isDialogOpen = _useState[0],\n      setDialogOpen = _useState[1];\n\n  var _useState2 = useState([]),\n      images = _useState2[0],\n      setImages = _useState2[1];\n\n  var _useState3 = useState(1),\n      itemCount = _useState3[0],\n      setItemCount = _useState3[1];\n\n  var _useState4 = useState(''),\n      imageTitle = _useState4[0],\n      setImageTitle = _useState4[1];\n\n  var _useState5 = useState(''),\n      imageDesc = _useState5[0],\n      setImageDesc = _useState5[1];\n\n  var _useState6 = useState(false),\n      isSaving = _useState6[0],\n      setIsSaving = _useState6[1];\n\n  var _useState7 = useState(false),\n      isDeleting = _useState7[0],\n      setIsDeleting = _useState7[1];\n\n  var _useState8 = useState(false),\n      showDeleteBtn = _useState8[0],\n      setShowDeleteBtn = _useState8[1];\n\n  var _useState9 = useState(''),\n      cta = _useState9[0],\n      setCta = _useState9[1];\n\n  var _useState10 = useState(false),\n      isOptimizeImage = _useState10[0],\n      setOptimizeImage = _useState10[1];\n\n  var _useState11 = useState(100),\n      quality = _useState11[0],\n      setQuality = _useState11[1];\n\n  var _useState12 = useState(false),\n      isImageQualityChange = _useState12[0],\n      setImageQualityChange = _useState12[1];\n\n  var _useState13 = useState(state !== null && state !== void 0 && (_state$assets = state.assets) !== null && _state$assets !== void 0 && (_state$assets$colors = _state$assets.colors) !== null && _state$assets$colors !== void 0 && (_state$assets$colors$ = _state$assets$colors.slider) !== null && _state$assets$colors$ !== void 0 && _state$assets$colors$.main ? state.assets.colors.slider.main : '#fff'),\n      textColor = _useState13[0],\n      setTextColor = _useState13[1];\n\n  var _useState14 = useState({\n    isTextEditorDialogOpen: false,\n    editorValue: '',\n    dialogType: ''\n  }),\n      localState = _useState14[0],\n      setLocalState = _useState14[1];\n\n  var isTextEditorDialogOpen = localState.isTextEditorDialogOpen,\n      editorValue = localState.editorValue,\n      dialogType = localState.dialogType;\n  var imageID = '';\n  var classes = useStyles();\n  useEffect(function () {\n    if (images.length === 0) {\n      handleNextDisable(true);\n    } else {\n      handleNextDisable(false);\n    }\n  }, [images]);\n  useEffect(function () {\n    if (component !== null && component !== void 0 && component.gid) {\n      ViewList({\n        apiUrl: GENERAL_SETTINGS.OREST_URL,\n        endpoint: OREST_ENDPOINT.HCMITEMIMG,\n        token: authToken,\n        params: {\n          query: \"gid:\".concat(component.gid),\n          sort: 'orderno',\n          hotelrefno: Number(companyId)\n        }\n      }).then(function (res) {\n        if (res.status === 200) {\n          var _res$data, _res$data$data;\n\n          if ((res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : (_res$data$data = _res$data.data) === null || _res$data$data === void 0 ? void 0 : _res$data$data.length) > 0) {\n            var _res$data$data$, _res$data$data$2, _res$data$data$3, _res$data$data$4, _res$data$data$5, _res$data$data$6;\n\n            var updatedImages = [];\n            res.data.data.map(function (data) {\n              updatedImages.push(data);\n            });\n            setImages(updatedImages);\n            ((_res$data$data$ = res.data.data[0]) === null || _res$data$data$ === void 0 ? void 0 : _res$data$data$.title) && setImageTitle((_res$data$data$2 = res.data.data[0]) === null || _res$data$data$2 === void 0 ? void 0 : _res$data$data$2.title);\n            ((_res$data$data$3 = res.data.data[0]) === null || _res$data$data$3 === void 0 ? void 0 : _res$data$data$3.description) && setImageDesc((_res$data$data$4 = res.data.data[0]) === null || _res$data$data$4 === void 0 ? void 0 : _res$data$data$4.description);\n            ((_res$data$data$5 = res.data.data[0]) === null || _res$data$data$5 === void 0 ? void 0 : _res$data$data$5.cta) && setCta((_res$data$data$6 = res.data.data[0]) === null || _res$data$data$6 === void 0 ? void 0 : _res$data$data$6.cta);\n          }\n        } else {\n          var retErr = isErrorMsg(res);\n          toast.error(retErr.errorMsg, {\n            position: toast.POSITION.TOP_RIGHT\n          });\n        }\n      });\n    }\n  }, [component]);\n  useEffect(function () {\n    var _images$;\n\n    handleSectionComponent && (images === null || images === void 0 ? void 0 : images.length) && handleSectionComponent({\n      service: 'hcmitemimg',\n      type: 'image',\n      gid: (_images$ = images[0]) === null || _images$ === void 0 ? void 0 : _images$.gid,\n      textColor: textColor\n    });\n  }, [textColor]);\n\n  var openDialog = function openDialog() {\n    //it opens dialog for image upload\n    setDialogOpen(true);\n  };\n\n  var closeDialog = function closeDialog() {\n    //it closes dialog for image upload\n    setDialogOpen(false);\n  };\n\n  var ImageUpload = function ImageUpload(apiUrl, endPoint, token, masterID, file) {\n    var url = apiUrl + '/' + endPoint + OREST_UPLOAD;\n    var binaryData = [];\n    binaryData.push(file);\n    var formData = new FormData();\n    formData.append('file', new Blob(binaryData, {\n      type: file.type\n    }), toSelfName(file.name));\n    var options = {\n      url: url,\n      method: 'post',\n      headers: {\n        Authorization: \"Bearer \".concat(token),\n        'Content-Type': 'multipart/form-data'\n      },\n      params: {\n        orsactive: true,\n        masterid: masterID,\n        hotelrefno: companyId,\n        quality: quality / 100,\n        scale: quality / 100\n      },\n      data: formData\n    };\n    return axios(options).then(function (response) {\n      return response;\n    })[\"catch\"](function (error) {\n      return error.response || {\n        status: 0\n      };\n    });\n  };\n\n  function asyncUpload(file, itemTreated, callback) {\n    if (state.hcmItemId) {\n      setTimeout(function () {\n        Insert({\n          apiUrl: GENERAL_SETTINGS.OREST_URL,\n          endpoint: OREST_ENDPOINT.HCMITEMIMG,\n          token: authToken,\n          data: {\n            itemid: state.hcmItemId,\n            imgtype: FIELDTYPE.IMG,\n            orderno: itemTreated,\n            hotelrefno: Number(companyId),\n            imgquality: quality / 100,\n            imgscale: quality / 100\n          }\n        }).then(function (r1) {\n          if (r1.status === 200) {\n            imageID = r1.data.data.id;\n            ImageUpload(GENERAL_SETTINGS.OREST_URL, OREST_ENDPOINT.RAFILE, authToken, r1.data.data.mid, file).then(function (r) {\n              if (r.status === 200) {\n                handleSectionComponent({\n                  service: 'hcmitemimg',\n                  type: 'image',\n                  gid: r1.data.data.gid,\n                  textColor: textColor\n                });\n                callback();\n              } else {\n                callback();\n              }\n            });\n          } else {\n            callback();\n          }\n        });\n      }, 100);\n    }\n  }\n\n  var saveImage = function saveImage(files) {\n    setIsSaving(true);\n    var req = files.map(function (file) {\n      return new Promise(function (resolve) {\n        asyncUpload(file, itemCount, resolve);\n        setItemCount(function (itemCount) {\n          return itemCount + 1;\n        });\n      });\n    });\n    Promise.all(req).then(function () {\n      ViewList({\n        apiUrl: GENERAL_SETTINGS.OREST_URL,\n        endpoint: OREST_ENDPOINT.HCMITEMIMG,\n        token: authToken,\n        params: {\n          query: \"id:\".concat(imageID),\n          sort: 'orderno',\n          hotelrefno: Number(companyId)\n        }\n      }).then(function (res) {\n        setIsSaving(false);\n\n        if (res.status === 200) {\n          var updatedImages = [];\n          res.data.data.map(function (data) {\n            updatedImages.push(data);\n          });\n          setImages(updatedImages);\n          toast.success(UPLOAD_SUCCESS, {\n            position: toast.POSITION.TOP_RIGHT\n          });\n          closeDialog();\n        } else {\n          var retErr = isErrorMsg(res);\n          toast.error(retErr.errorMsg, {\n            position: toast.POSITION.TOP_RIGHT\n          });\n        }\n      });\n    });\n  };\n\n  var deleteImage = function deleteImage() {\n    setIsDeleting(true);\n    Delete({\n      apiUrl: GENERAL_SETTINGS.OREST_URL,\n      endpoint: OREST_ENDPOINT.HCMITEMIMG,\n      token: authToken,\n      gid: images[0].gid,\n      params: {\n        hotelrefno: Number(companyId)\n      }\n    }).then(function (res) {\n      setIsDeleting(false);\n\n      if (res.status === 200) {\n        setImages([]);\n        toast.success(DELETE_SUCCESS, {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      } else {\n        var retErr = isErrorMsg(res);\n        toast.error(retErr.errorMsg, {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      }\n    });\n  };\n\n  var handleUpdateImage = function handleUpdateImage() {\n    setIsSaving(true);\n    Patch({\n      // update slider\n      apiUrl: GENERAL_SETTINGS.OREST_URL,\n      endpoint: OREST_ENDPOINT.HCMITEMIMG,\n      token: authToken,\n      gid: images[0].gid,\n      params: {\n        hotelrefno: Number(companyId)\n      },\n      data: {\n        title: imageTitle,\n        description: imageDesc,\n        cta: cta\n      }\n    }).then(function (res) {\n      setIsSaving(false);\n\n      if (res.status === 200) {\n        toast.success(SAVED_SUCCESS, {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      } else {\n        var retErr = isErrorMsg(res);\n        toast.error(retErr.errorMsg, {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      }\n    });\n  };\n\n  var handleImageQualityChange = function handleImageQualityChange(value) {\n    if (value >= 10 && value <= 90 && value % 10 === 0) {\n      if (images !== null && images !== void 0 && images.length) {\n        Patch({\n          // update image\n          apiUrl: GENERAL_SETTINGS.OREST_URL,\n          endpoint: OREST_ENDPOINT.HCMITEMIMG,\n          token: authToken,\n          gid: images[0].gid,\n          params: {\n            hotelrefno: Number(companyId)\n          },\n          data: {\n            imgquality: isImageQualityChange ? value / 100 : quality / 100,\n            imgscale: isImageQualityChange ? value / 100 : quality / 100\n          }\n        }).then(function (res1) {\n          var _res1$data;\n\n          if ((res1 === null || res1 === void 0 ? void 0 : res1.status) === 200 && res1 !== null && res1 !== void 0 && (_res1$data = res1.data) !== null && _res1$data !== void 0 && _res1$data.data) {\n            setQuality(value);\n          } else {\n            var retErr = isErrorMsg(res);\n            toast.error(retErr.errorMsg, {\n              position: toast.POSITION.TOP_RIGHT\n            });\n          }\n        });\n      } else {\n        setQuality(value);\n      }\n    }\n  };\n\n  var handleDialogOpen = function handleDialogOpen(type) {\n    if (type === 'title') {\n      setLocalState(function (prev) {\n        return _objectSpread(_objectSpread({}, prev), {}, {\n          isTextEditorDialogOpen: true,\n          dialogType: type,\n          editorValue: imageTitle\n        });\n      });\n    }\n\n    if (type === 'description') {\n      setLocalState(function (prev) {\n        return _objectSpread(_objectSpread({}, prev), {}, {\n          isTextEditorDialogOpen: true,\n          dialogType: type,\n          editorValue: imageDesc\n        });\n      });\n    }\n  };\n\n  var handleTextEditorValue = function handleTextEditorValue(value) {\n    if (dialogType === 'title') {\n      setImageTitle(value);\n    }\n\n    if (dialogType === 'description') {\n      setImageDesc(value);\n    }\n\n    setLocalState(function (prev) {\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        isTextEditorDialogOpen: false,\n        dialogType: '',\n        editorValue: ''\n      });\n    });\n  };\n\n  var handleCancelEditor = function handleCancelEditor() {\n    setLocalState(function (prev) {\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        isTextEditorDialogOpen: false,\n        dialogType: '',\n        editorValue: ''\n      });\n    });\n  };\n\n  if (isSaving) {\n    return __jsx(LoadingSpinner, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 16\n      }\n    });\n  }\n\n  return __jsx(React.Fragment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 426,\n      columnNumber: 9\n    }\n  }, state.hcmItemId && __jsx(React.Fragment, null, __jsx(Grid, {\n    container: true,\n    justify: 'space-between',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 21\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 6,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 430,\n      columnNumber: 25\n    }\n  }, __jsx(FormControlLabel, {\n    className: classes.labelFont,\n    control: __jsx(Checkbox, {\n      size: 'small',\n      checked: isOptimizeImage,\n      onChange: function onChange() {\n        var _state$assets2, _state$assets2$meta;\n\n        !isImageQualityChange && setQuality((state === null || state === void 0 ? void 0 : (_state$assets2 = state.assets) === null || _state$assets2 === void 0 ? void 0 : (_state$assets2$meta = _state$assets2.meta) === null || _state$assets2$meta === void 0 ? void 0 : _state$assets2$meta.imageQuality) * 100);\n        setOptimizeImage(!isOptimizeImage);\n      },\n      color: \"primary\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 37\n      }\n    }),\n    label: \"Optimize Images\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 29\n    }\n  })), __jsx(Grid, {\n    item: true,\n    xs: 6,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 447,\n      columnNumber: 25\n    }\n  }, __jsx(Grid, {\n    container: true,\n    justify: 'flex-end',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 29\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 1,\n    style: {\n      marginTop: 8\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 449,\n      columnNumber: 33\n    }\n  }, __jsx(Typography, {\n    component: 'span',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 450,\n      columnNumber: 37\n    }\n  }, \"Text\")), __jsx(Grid, {\n    item: true,\n    xs: 2,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 452,\n      columnNumber: 33\n    }\n  }, __jsx(InputColor, {\n    onChange: function onChange(color) {\n      return setTextColor(color.hex);\n    },\n    placement: \"right\",\n    initialValue: textColor,\n    style: {\n      marginTop: 8\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 453,\n      columnNumber: 37\n    }\n  }))))), __jsx(Grid, {\n    container: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 463,\n      columnNumber: 21\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 12,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 464,\n      columnNumber: 25\n    }\n  }, isOptimizeImage && __jsx(PercentageSlider, {\n    marks: PERCENTAGE_VALUES,\n    value: quality,\n    onChange: function onChange(e, value) {\n      handleImageQualityChange(value);\n      !isImageQualityChange && setImageQualityChange(true);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 466,\n      columnNumber: 33\n    }\n  }))), __jsx(Grid, {\n    container: true,\n    justify: 'flex-start',\n    spacing: 3,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 477,\n      columnNumber: 21\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 6,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 478,\n      columnNumber: 25\n    }\n  }, __jsx(Paper, {\n    className: classes.paperBlock,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 479,\n      columnNumber: 29\n    }\n  }, images.length > 0 && images.map(function (value, index) {\n    return __jsx(Grid, {\n      container: true,\n      key: index,\n      justify: 'center',\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 483,\n        columnNumber: 45\n      }\n    }, __jsx(Grid, {\n      item: true,\n      className: isDeleting ? classes.disableEvent : '',\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 484,\n        columnNumber: 49\n      }\n    }, __jsx(Card, {\n      className: classes.card,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 485,\n        columnNumber: 53\n      }\n    }, __jsx(\"div\", {\n      style: {\n        backgroundImage: \"url(\".concat(GENERAL_SETTINGS.STATIC_URL + value.fileurl, \")\"),\n        height: '100%',\n        width: '100%',\n        backgroundSize: 'cover'\n      },\n      onMouseEnter: function onMouseEnter() {\n        return setShowDeleteBtn(true);\n      },\n      onMouseLeave: function onMouseLeave() {\n        return setShowDeleteBtn(false);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 486,\n        columnNumber: 57\n      }\n    }, showDeleteBtn && __jsx(IconButton, {\n      onClick: deleteImage,\n      disabled: isDeleting,\n      \"aria-label\": \"upload picture\",\n      component: \"span\",\n      style: {\n        \"float\": 'right'\n      },\n      color: 'primary',\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 499,\n        columnNumber: 65\n      }\n    }, __jsx(CancelIcon, {\n      style: {\n        width: 30,\n        height: 30\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 507,\n        columnNumber: 69\n      }\n    }))))));\n  }), images.length === 0 && __jsx(Typography, {\n    component: 'div',\n    style: {\n      height: 250,\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 517,\n      columnNumber: 37\n    }\n  }, __jsx(Fab, {\n    onClick: openDialog,\n    variant: \"extended\",\n    size: \"small\",\n    color: \"primary\",\n    \"aria-label\": \"add\",\n    className: classes.fabBtn,\n    disabled: images.length > 0,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 526,\n      columnNumber: 41\n    }\n  }, __jsx(CloudUploadIcon, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 535,\n      columnNumber: 45\n    }\n  }), \"UPLOAD\")), __jsx(DropzoneDialog, {\n    open: isDialogOpen,\n    onSave: saveImage,\n    acceptedFiles: ['image/jpeg', 'image/png', 'image/bmp', 'image/gif'],\n    showPreviews: true,\n    maxFileSize: 5000000,\n    onClose: closeDialog,\n    filesLimit: 1,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 540,\n      columnNumber: 33\n    }\n  }))), __jsx(Grid, {\n    item: true,\n    xs: 6,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 551,\n      columnNumber: 25\n    }\n  }, __jsx(Paper, {\n    className: classes.paperBlock,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 552,\n      columnNumber: 29\n    }\n  }, __jsx(Grid, {\n    container: true,\n    justify: 'flex-start',\n    spacing: 3,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 553,\n      columnNumber: 33\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 3,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 554,\n      columnNumber: 37\n    }\n  }, __jsx(Typography, {\n    component: 'h6',\n    variant: 'h6',\n    className: classes.heading,\n    style: {\n      marginTop: 24\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 555,\n      columnNumber: 41\n    }\n  }, \"Title\")), __jsx(Grid, {\n    item: true,\n    xs: 9,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 564,\n      columnNumber: 37\n    }\n  }, __jsx(IconButton, {\n    \"aria-label\": \"Edit Title\",\n    color: \"primary\",\n    onClick: function onClick() {\n      return handleDialogOpen('title');\n    },\n    style: {\n      \"float\": 'right'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 565,\n      columnNumber: 41\n    }\n  }, __jsx(BorderColorSharpIcon, {\n    color: \"primary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 571,\n      columnNumber: 45\n    }\n  })))), __jsx(Grid, {\n    container: true,\n    justify: 'flex-start',\n    spacing: 3,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 575,\n      columnNumber: 33\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 3,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 576,\n      columnNumber: 37\n    }\n  }, __jsx(Typography, {\n    component: 'h6',\n    variant: 'h6',\n    className: classes.heading,\n    size: 'small',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 577,\n      columnNumber: 41\n    }\n  }, \"Description\")), __jsx(Grid, {\n    item: true,\n    xs: 9,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 586,\n      columnNumber: 37\n    }\n  }, __jsx(IconButton, {\n    \"aria-label\": \"Edit Title\",\n    color: \"primary\",\n    onClick: function onClick() {\n      return handleDialogOpen('description');\n    },\n    style: {\n      \"float\": 'right'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 587,\n      columnNumber: 41\n    }\n  }, __jsx(BorderColorSharpIcon, {\n    color: \"primary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 593,\n      columnNumber: 45\n    }\n  })))), (state.type === 'email' || state.type === 'emailOnly') && __jsx(Grid, {\n    container: true,\n    justify: 'flex-start',\n    spacing: 3,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 598,\n      columnNumber: 37\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 3,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 599,\n      columnNumber: 41\n    }\n  }, __jsx(Typography, {\n    component: 'h6',\n    variant: 'h6',\n    className: classes.heading,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 600,\n      columnNumber: 45\n    }\n  }, \"Link\")), __jsx(Grid, {\n    item: true,\n    xs: 9,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 604,\n      columnNumber: 41\n    }\n  }, __jsx(TextField, {\n    id: \"image-description\",\n    variant: 'outlined',\n    fullWidth: true,\n    placeholder: 'Please Link here',\n    onChange: function onChange(e) {\n      return setCta(e.target.value);\n    },\n    size: 'small',\n    className: classes.textField,\n    error: cta ? !validator.isURL(cta) : false,\n    value: cta,\n    helperText: cta && __jsx(Typography, {\n      variant: \"caption\",\n      className: classes.alignText,\n      display: \"block\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 617,\n        columnNumber: 57\n      }\n    }, \"\".concat(cta === null || cta === void 0 ? void 0 : cta.length, \" < 100\")),\n    inputProps: {\n      maxLength: 99\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 605,\n      columnNumber: 45\n    }\n  }))), __jsx(Divider, {\n    style: {\n      marginTop: 8\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 631,\n      columnNumber: 33\n    }\n  }), __jsx(Button, {\n    onClick: handleUpdateImage,\n    variant: \"contained\",\n    size: \"small\",\n    color: \"primary\",\n    \"aria-label\": \"add\",\n    className: classes.submit,\n    disabled: images.length === 0,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 632,\n      columnNumber: 33\n    }\n  }, \"SUBMIT\"))))), isTextEditorDialogOpen && __jsx(TextEditor, {\n    handleSaveTextEditor: handleTextEditorValue,\n    handleCancelTextEditor: handleCancelEditor,\n    data: editorValue,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 649,\n      columnNumber: 17\n    }\n  }));\n};\n\n_s(UploadImage, \"sXVQ8rN6xO0/pNsCRbzb2rOP/S4=\", false, function () {\n  return [useRouter, useStyles];\n});\n\n_c = UploadImage;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    state: state.formReducer.pageBuilder\n  };\n};\n\nexport default connect(mapStateToProps)(UploadImage);\n\nvar _c;\n\n$RefreshReg$(_c, \"UploadImage\");","map":{"version":3,"sources":["/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/components/page/sections/image/UploadImage.js"],"names":["React","useContext","useEffect","useState","ViewList","Insert","Delete","Patch","WebCmsGlobal","useRouter","connect","FIELDTYPE","isErrorMsg","OREST_ENDPOINT","OREST_UPLOAD","Grid","Card","Fab","CloudUploadIcon","DropzoneDialog","makeStyles","axios","toast","TextField","Button","Paper","LoadingSpinner","COLORS","UPLOAD_SUCCESS","DELETE_SUCCESS","SAVED_SUCCESS","PERCENTAGE_VALUES","toSelfName","Typography","CancelIcon","IconButton","Divider","validator","PercentageSlider","Checkbox","FormControlLabel","InputColor","TextEditor","BorderColorSharpIcon","useStyles","theme","root","card","maxWidth","media","height","paddingTop","submit","marginRight","spacing","marginBottom","borderRadius","marginTop","fabBtn","marginLeft","disableEvent","pointerEvents","opacity","paperBlock","border","secondary","overflow","position","width","cursor","heading","fontWeight","fontSize","textField","paddingRight","alignText","textAlign","color","UploadImage","props","state","component","handleSectionComponent","handleNextDisable","router","companyId","query","companyID","GENERAL_SETTINGS","token","authToken","isDialogOpen","setDialogOpen","images","setImages","itemCount","setItemCount","imageTitle","setImageTitle","imageDesc","setImageDesc","isSaving","setIsSaving","isDeleting","setIsDeleting","showDeleteBtn","setShowDeleteBtn","cta","setCta","isOptimizeImage","setOptimizeImage","quality","setQuality","isImageQualityChange","setImageQualityChange","assets","colors","slider","main","textColor","setTextColor","isTextEditorDialogOpen","editorValue","dialogType","localState","setLocalState","imageID","classes","length","gid","apiUrl","OREST_URL","endpoint","HCMITEMIMG","params","sort","hotelrefno","Number","then","res","status","data","updatedImages","map","push","title","description","retErr","error","errorMsg","POSITION","TOP_RIGHT","service","type","openDialog","closeDialog","ImageUpload","endPoint","masterID","file","url","binaryData","formData","FormData","append","Blob","name","options","method","headers","Authorization","orsactive","masterid","scale","response","asyncUpload","itemTreated","callback","hcmItemId","setTimeout","itemid","imgtype","IMG","orderno","imgquality","imgscale","r1","id","RAFILE","mid","r","saveImage","files","req","Promise","resolve","all","success","deleteImage","handleUpdateImage","handleImageQualityChange","value","res1","handleDialogOpen","prev","handleTextEditorValue","handleCancelEditor","labelFont","meta","imageQuality","hex","e","index","backgroundImage","STATIC_URL","fileurl","backgroundSize","display","alignItems","justifyContent","target","isURL","maxLength","mapStateToProps","formReducer","pageBuilder"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react'\nimport { ViewList, Insert, Delete, Patch } from '@webcms/orest'\nimport WebCmsGlobal from 'components/webcms-global'\nimport { useRouter } from 'next/router'\nimport { connect } from 'react-redux'\nimport { FIELDTYPE, isErrorMsg, OREST_ENDPOINT, OREST_UPLOAD } from '../../../../../../../model/orest/constants'\nimport Grid from '@material-ui/core/Grid'\nimport Card from '@material-ui/core/Card'\nimport Fab from '@material-ui/core/Fab'\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload'\nimport { DropzoneDialog } from 'material-ui-dropzone'\nimport { makeStyles } from '@material-ui/core/styles'\nimport axios from 'axios'\nimport { toast } from 'react-toastify'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Paper from '@material-ui/core/Paper'\nimport LoadingSpinner from '../../../../../../LoadingSpinner'\nimport { COLORS, UPLOAD_SUCCESS, DELETE_SUCCESS, SAVED_SUCCESS, PERCENTAGE_VALUES } from '../../../../constants';\nimport { toSelfName } from './../../../../../../../lib/helpers/useFunction';\nimport Typography from '@material-ui/core/Typography'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport IconButton from '@material-ui/core/IconButton'\nimport Divider from '@material-ui/core/Divider'\nimport validator from 'validator'\nimport { PercentageSlider } from '../../../../../../../model/slider'\nimport Checkbox from '@material-ui/core/Checkbox'\nimport { FormControlLabel } from '@material-ui/core'\nimport InputColor from 'react-input-color'\nimport TextEditor from '../text-editor'\nimport BorderColorSharpIcon from '@material-ui/icons/BorderColorSharp'\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        card: {\n            maxWidth: 345,\n        },\n        media: {\n            height: 0,\n            paddingTop: '56.25%',\n        },\n    },\n    submit: {\n        marginRight: theme.spacing(1),\n        marginBottom: theme.spacing(1),\n        borderRadius: 20,\n        marginTop: theme.spacing(1),\n        float: 'right',\n    },\n    fabBtn: {\n        marginBottom: theme.spacing(1),\n        marginLeft: theme.spacing(1),\n    },\n    disableEvent: {\n        pointerEvents: 'none',\n        opacity: 0.5,\n    },\n    paperBlock: {\n        height: 250,\n        border: `2px solid ${COLORS?.secondary}`,\n        overflow: 'auto',\n        position: 'relative',\n    },\n    card: {\n        height: 245,\n        width: 392,\n        cursor: 'pointer',\n    },\n    heading: {\n        marginTop: theme.spacing(1),\n        marginLeft: theme.spacing(2),\n        fontWeight: 'bold',\n        fontSize: 15,\n    },\n    textField: {\n        paddingRight: theme.spacing(1),\n    },\n    alignText: {\n        textAlign: 'right',\n        color: 'red',\n    },\n}))\n\nconst UploadImage = (props) => {\n    const { state, component, handleSectionComponent, handleNextDisable } = props\n\n    const router = useRouter()\n    const companyId = router.query.companyID\n    const { GENERAL_SETTINGS, token } = useContext(WebCmsGlobal)\n    const authToken = token || router.query.authToken\n    //local state\n    const [isDialogOpen, setDialogOpen] = useState(false)\n    const [images, setImages] = useState([])\n    const [itemCount, setItemCount] = useState(1)\n    const [imageTitle, setImageTitle] = useState('')\n    const [imageDesc, setImageDesc] = useState('')\n    const [isSaving, setIsSaving] = useState(false)\n    const [isDeleting, setIsDeleting] = useState(false)\n    const [showDeleteBtn, setShowDeleteBtn] = useState(false)\n    const [cta, setCta] = useState('')\n    const [isOptimizeImage, setOptimizeImage] = useState(false)\n    const [quality, setQuality] = useState(100)\n    const [isImageQualityChange, setImageQualityChange] = useState(false)\n    const [textColor, setTextColor] = useState(\n        state?.assets?.colors?.slider?.main ? state.assets.colors.slider.main : '#fff'\n    )\n    const [localState, setLocalState] = useState({\n        isTextEditorDialogOpen: false,\n        editorValue: '',\n        dialogType: '',\n    })\n\n    const { isTextEditorDialogOpen, editorValue, dialogType } = localState\n\n    let imageID = ''\n\n    const classes = useStyles()\n\n    useEffect(() => {\n        if (images.length === 0) {\n            handleNextDisable(true)\n        } else {\n            handleNextDisable(false)\n        }\n    }, [images])\n\n    useEffect(() => {\n        if (component?.gid) {\n            ViewList({\n                apiUrl: GENERAL_SETTINGS.OREST_URL,\n                endpoint: OREST_ENDPOINT.HCMITEMIMG,\n                token: authToken,\n                params: {\n                    query: `gid:${component.gid}`,\n                    sort: 'orderno',\n                    hotelrefno: Number(companyId),\n                },\n            }).then((res) => {\n                if (res.status === 200) {\n                    if (res?.data?.data?.length > 0) {\n                        let updatedImages = []\n                        res.data.data.map((data) => {\n                            updatedImages.push(data)\n                        })\n                        setImages(updatedImages)\n                        res.data.data[0]?.title && setImageTitle(res.data.data[0]?.title)\n                        res.data.data[0]?.description && setImageDesc(res.data.data[0]?.description)\n                        res.data.data[0]?.cta && setCta(res.data.data[0]?.cta)\n                    }\n                } else {\n                    const retErr = isErrorMsg(res)\n                    toast.error(retErr.errorMsg, {\n                        position: toast.POSITION.TOP_RIGHT,\n                    })\n                }\n            })\n        }\n    }, [component])\n\n    useEffect(() => {\n        handleSectionComponent &&\n            images?.length &&\n            handleSectionComponent({\n                service: 'hcmitemimg',\n                type: 'image',\n                gid: images[0]?.gid,\n                textColor: textColor,\n            })\n    }, [textColor])\n\n    const openDialog = () => {\n        //it opens dialog for image upload\n        setDialogOpen(true)\n    }\n\n    const closeDialog = () => {\n        //it closes dialog for image upload\n        setDialogOpen(false)\n    }\n\n    const ImageUpload = (apiUrl, endPoint, token, masterID, file) => {\n        const url = apiUrl + '/' + endPoint + OREST_UPLOAD\n        let binaryData = []\n        binaryData.push(file)\n        let formData = new FormData()\n        formData.append('file', new Blob(binaryData, { type: file.type }), toSelfName(file.name));\n\n        const options = {\n            url: url,\n            method: 'post',\n            headers: {\n                Authorization: `Bearer ${token}`,\n                'Content-Type': 'multipart/form-data',\n            },\n            params: {\n                orsactive: true,\n                masterid: masterID,\n                hotelrefno: companyId,\n                quality: quality / 100,\n                scale: quality / 100,\n            },\n            data: formData,\n        }\n\n        return axios(options)\n            .then((response) => {\n                return response\n            })\n            .catch((error) => {\n                return error.response || { status: 0 }\n            })\n    }\n\n    function asyncUpload(file, itemTreated, callback) {\n        if (state.hcmItemId) {\n            setTimeout(() => {\n                Insert({\n                    apiUrl: GENERAL_SETTINGS.OREST_URL,\n                    endpoint: OREST_ENDPOINT.HCMITEMIMG,\n                    token: authToken,\n                    data: {\n                        itemid: state.hcmItemId,\n                        imgtype: FIELDTYPE.IMG,\n                        orderno: itemTreated,\n                        hotelrefno: Number(companyId),\n                        imgquality: quality / 100,\n                        imgscale: quality / 100,\n                    },\n                }).then((r1) => {\n                    if (r1.status === 200) {\n                        imageID = r1.data.data.id\n                        ImageUpload(\n                            GENERAL_SETTINGS.OREST_URL,\n                            OREST_ENDPOINT.RAFILE,\n                            authToken,\n                            r1.data.data.mid,\n                            file\n                        ).then((r) => {\n                            if (r.status === 200) {\n                                handleSectionComponent({\n                                    service: 'hcmitemimg',\n                                    type: 'image',\n                                    gid: r1.data.data.gid,\n                                    textColor: textColor,\n                                })\n                                callback()\n                            } else {\n                                callback()\n                            }\n                        })\n                    } else {\n                        callback()\n                    }\n                })\n            }, 100)\n        }\n    }\n\n    const saveImage = (files) => {\n        setIsSaving(true)\n        let req = files.map((file) => {\n            return new Promise((resolve) => {\n                asyncUpload(file, itemCount, resolve)\n                setItemCount((itemCount) => itemCount + 1)\n            })\n        })\n        Promise.all(req).then(() => {\n            ViewList({\n                apiUrl: GENERAL_SETTINGS.OREST_URL,\n                endpoint: OREST_ENDPOINT.HCMITEMIMG,\n                token: authToken,\n                params: {\n                    query: `id:${imageID}`,\n                    sort: 'orderno',\n                    hotelrefno: Number(companyId),\n                },\n            }).then((res) => {\n                setIsSaving(false)\n                if (res.status === 200) {\n                    let updatedImages = []\n                    res.data.data.map((data) => {\n                        updatedImages.push(data)\n                    })\n                    setImages(updatedImages)\n                    toast.success(UPLOAD_SUCCESS, {\n                        position: toast.POSITION.TOP_RIGHT,\n                    })\n                    closeDialog()\n                } else {\n                    const retErr = isErrorMsg(res)\n                    toast.error(retErr.errorMsg, {\n                        position: toast.POSITION.TOP_RIGHT,\n                    })\n                }\n            })\n        })\n    }\n\n    const deleteImage = () => {\n        setIsDeleting(true)\n        Delete({\n            apiUrl: GENERAL_SETTINGS.OREST_URL,\n            endpoint: OREST_ENDPOINT.HCMITEMIMG,\n            token: authToken,\n            gid: images[0].gid,\n            params: {\n                hotelrefno: Number(companyId),\n            },\n        }).then((res) => {\n            setIsDeleting(false)\n            if (res.status === 200) {\n                setImages([])\n                toast.success(DELETE_SUCCESS, {\n                    position: toast.POSITION.TOP_RIGHT,\n                })\n            } else {\n                const retErr = isErrorMsg(res)\n                toast.error(retErr.errorMsg, {\n                    position: toast.POSITION.TOP_RIGHT,\n                })\n            }\n        })\n    }\n\n    const handleUpdateImage = () => {\n        setIsSaving(true)\n        Patch({\n            // update slider\n            apiUrl: GENERAL_SETTINGS.OREST_URL,\n            endpoint: OREST_ENDPOINT.HCMITEMIMG,\n            token: authToken,\n            gid: images[0].gid,\n            params: {\n                hotelrefno: Number(companyId),\n            },\n            data: {\n                title: imageTitle,\n                description: imageDesc,\n                cta: cta,\n            },\n        }).then((res) => {\n            setIsSaving(false)\n            if (res.status === 200) {\n                toast.success(SAVED_SUCCESS, {\n                    position: toast.POSITION.TOP_RIGHT,\n                })\n            } else {\n                const retErr = isErrorMsg(res)\n                toast.error(retErr.errorMsg, {\n                    position: toast.POSITION.TOP_RIGHT,\n                })\n            }\n        })\n    }\n\n    const handleImageQualityChange = (value) => {\n        if (value >= 10 && value <= 90 && value % 10 === 0) {\n            if (images?.length) {\n                Patch({\n                    // update image\n                    apiUrl: GENERAL_SETTINGS.OREST_URL,\n                    endpoint: OREST_ENDPOINT.HCMITEMIMG,\n                    token: authToken,\n                    gid: images[0].gid,\n                    params: {\n                        hotelrefno: Number(companyId),\n                    },\n                    data: {\n                        imgquality: isImageQualityChange ? value / 100 : quality / 100,\n                        imgscale: isImageQualityChange ? value / 100 : quality / 100,\n                    },\n                }).then((res1) => {\n                    if (res1?.status === 200 && res1?.data?.data) {\n                        setQuality(value)\n                    } else {\n                        const retErr = isErrorMsg(res)\n                        toast.error(retErr.errorMsg, {\n                            position: toast.POSITION.TOP_RIGHT,\n                        })\n                    }\n                })\n            } else {\n                setQuality(value)\n            }\n        }\n    }\n\n    const handleDialogOpen = (type) => {\n        if (type === 'title') {\n            setLocalState((prev) => ({\n                ...prev,\n                isTextEditorDialogOpen: true,\n                dialogType: type,\n                editorValue: imageTitle,\n            }))\n        }\n        if (type === 'description') {\n            setLocalState((prev) => ({\n                ...prev,\n                isTextEditorDialogOpen: true,\n                dialogType: type,\n                editorValue: imageDesc,\n            }))\n        }\n    }\n\n    const handleTextEditorValue = (value) => {\n        if (dialogType === 'title') {\n            setImageTitle(value)\n        }\n        if (dialogType === 'description') {\n            setImageDesc(value)\n        }\n        setLocalState((prev) => ({ ...prev, isTextEditorDialogOpen: false, dialogType: '', editorValue: '' }))\n    }\n\n    const handleCancelEditor = () => {\n        setLocalState((prev) => ({ ...prev, isTextEditorDialogOpen: false, dialogType: '', editorValue: '' }))\n    }\n\n    if (isSaving) {\n        return <LoadingSpinner />\n    }\n\n    return (\n        <React.Fragment>\n            {state.hcmItemId && (\n                <>\n                    <Grid container={true} justify={'space-between'}>\n                        <Grid item xs={6}>\n                            <FormControlLabel\n                                className={classes.labelFont}\n                                control={\n                                    <Checkbox\n                                        size={'small'}\n                                        checked={isOptimizeImage}\n                                        onChange={() => {\n                                            !isImageQualityChange && setQuality(state?.assets?.meta?.imageQuality * 100)\n                                            setOptimizeImage(!isOptimizeImage)\n                                        }}\n                                        color=\"primary\"\n                                    />\n                                }\n                                label=\"Optimize Images\"\n                            />\n                        </Grid>\n                        <Grid item xs={6}>\n                            <Grid container={true} justify={'flex-end'}>\n                                <Grid item xs={1} style={{ marginTop: 8 }}>\n                                    <Typography component={'span'}>Text</Typography>\n                                </Grid>\n                                <Grid item xs={2}>\n                                    <InputColor\n                                        onChange={(color) => setTextColor(color.hex)}\n                                        placement=\"right\"\n                                        initialValue={textColor}\n                                        style={{ marginTop: 8 }}\n                                    />\n                                </Grid>\n                            </Grid>\n                        </Grid>\n                    </Grid>\n                    <Grid container>\n                        <Grid item xs={12}>\n                            {isOptimizeImage && (\n                                <PercentageSlider\n                                    marks={PERCENTAGE_VALUES}\n                                    value={quality}\n                                    onChange={(e, value) => {\n                                        handleImageQualityChange(value)\n                                        !isImageQualityChange && setImageQualityChange(true)\n                                    }}\n                                />\n                            )}\n                        </Grid>\n                    </Grid>\n                    <Grid container={true} justify={'flex-start'} spacing={3}>\n                        <Grid item={true} xs={6}>\n                            <Paper className={classes.paperBlock}>\n                                {images.length > 0 &&\n                                    images.map((value, index) => {\n                                        return (\n                                            <Grid container={true} key={index} justify={'center'}>\n                                                <Grid item className={isDeleting ? classes.disableEvent : ''}>\n                                                    <Card className={classes.card}>\n                                                        <div\n                                                            style={{\n                                                                backgroundImage: `url(${\n                                                                    GENERAL_SETTINGS.STATIC_URL + value.fileurl\n                                                                })`,\n                                                                height: '100%',\n                                                                width: '100%',\n                                                                backgroundSize: 'cover',\n                                                            }}\n                                                            onMouseEnter={() => setShowDeleteBtn(true)}\n                                                            onMouseLeave={() => setShowDeleteBtn(false)}\n                                                        >\n                                                            {showDeleteBtn && (\n                                                                <IconButton\n                                                                    onClick={deleteImage}\n                                                                    disabled={isDeleting}\n                                                                    aria-label=\"upload picture\"\n                                                                    component=\"span\"\n                                                                    style={{ float: 'right' }}\n                                                                    color={'primary'}\n                                                                >\n                                                                    <CancelIcon style={{ width: 30, height: 30 }} />\n                                                                </IconButton>\n                                                            )}\n                                                        </div>\n                                                    </Card>\n                                                </Grid>\n                                            </Grid>\n                                        )\n                                    })}\n                                {images.length === 0 && (\n                                    <Typography\n                                        component={'div'}\n                                        style={{\n                                            height: 250,\n                                            display: 'flex',\n                                            alignItems: 'center',\n                                            justifyContent: 'center',\n                                        }}\n                                    >\n                                        <Fab\n                                            onClick={openDialog}\n                                            variant=\"extended\"\n                                            size=\"small\"\n                                            color=\"primary\"\n                                            aria-label=\"add\"\n                                            className={classes.fabBtn}\n                                            disabled={images.length > 0}\n                                        >\n                                            <CloudUploadIcon />\n                                            UPLOAD\n                                        </Fab>\n                                    </Typography>\n                                )}\n                                <DropzoneDialog\n                                    open={isDialogOpen}\n                                    onSave={saveImage}\n                                    acceptedFiles={['image/jpeg', 'image/png', 'image/bmp', 'image/gif']}\n                                    showPreviews={true}\n                                    maxFileSize={5000000}\n                                    onClose={closeDialog}\n                                    filesLimit={1}\n                                />\n                            </Paper>\n                        </Grid>\n                        <Grid item={true} xs={6}>\n                            <Paper className={classes.paperBlock}>\n                                <Grid container justify={'flex-start'} spacing={3}>\n                                    <Grid item xs={3}>\n                                        <Typography\n                                            component={'h6'}\n                                            variant={'h6'}\n                                            className={classes.heading}\n                                            style={{ marginTop: 24 }}\n                                        >\n                                            Title\n                                        </Typography>\n                                    </Grid>\n                                    <Grid item xs={9}>\n                                        <IconButton\n                                            aria-label=\"Edit Title\"\n                                            color=\"primary\"\n                                            onClick={() => handleDialogOpen('title')}\n                                            style={{ float: 'right' }}\n                                        >\n                                            <BorderColorSharpIcon color=\"primary\" />\n                                        </IconButton>\n                                    </Grid>\n                                </Grid>\n                                <Grid container justify={'flex-start'} spacing={3}>\n                                    <Grid item xs={3}>\n                                        <Typography\n                                            component={'h6'}\n                                            variant={'h6'}\n                                            className={classes.heading}\n                                            size={'small'}\n                                        >\n                                            Description\n                                        </Typography>\n                                    </Grid>\n                                    <Grid item xs={9}>\n                                        <IconButton\n                                            aria-label=\"Edit Title\"\n                                            color=\"primary\"\n                                            onClick={() => handleDialogOpen('description')}\n                                            style={{ float: 'right' }}\n                                        >\n                                            <BorderColorSharpIcon color=\"primary\" />\n                                        </IconButton>\n                                    </Grid>\n                                </Grid>\n                                {(state.type === 'email' || state.type === 'emailOnly') && (\n                                    <Grid container justify={'flex-start'} spacing={3}>\n                                        <Grid item xs={3}>\n                                            <Typography component={'h6'} variant={'h6'} className={classes.heading}>\n                                                Link\n                                            </Typography>\n                                        </Grid>\n                                        <Grid item xs={9}>\n                                            <TextField\n                                                id=\"image-description\"\n                                                variant={'outlined'}\n                                                fullWidth\n                                                placeholder={'Please Link here'}\n                                                onChange={(e) => setCta(e.target.value)}\n                                                size={'small'}\n                                                className={classes.textField}\n                                                error={cta ? !validator.isURL(cta) : false}\n                                                value={cta}\n                                                helperText={\n                                                    cta && (\n                                                        <Typography\n                                                            variant=\"caption\"\n                                                            className={classes.alignText}\n                                                            display=\"block\"\n                                                        >\n                                                            {`${cta?.length} < 100`}\n                                                        </Typography>\n                                                    )\n                                                }\n                                                inputProps={{ maxLength: 99 }}\n                                            />\n                                        </Grid>\n                                    </Grid>\n                                )}\n                                <Divider style={{ marginTop: 8 }} />\n                                <Button\n                                    onClick={handleUpdateImage}\n                                    variant=\"contained\"\n                                    size=\"small\"\n                                    color=\"primary\"\n                                    aria-label=\"add\"\n                                    className={classes.submit}\n                                    disabled={images.length === 0}\n                                >\n                                    SUBMIT\n                                </Button>\n                            </Paper>\n                        </Grid>\n                    </Grid>\n                </>\n            )}\n            {isTextEditorDialogOpen && (\n                <TextEditor\n                    handleSaveTextEditor={handleTextEditorValue}\n                    handleCancelTextEditor={handleCancelEditor}\n                    data={editorValue}\n                />\n            )}\n        </React.Fragment>\n    )\n}\n\nconst mapStateToProps = (state) => {\n    return {\n        state: state.formReducer.pageBuilder,\n    }\n}\n\nexport default connect(mapStateToProps)(UploadImage)\n"]},"metadata":{},"sourceType":"module"}
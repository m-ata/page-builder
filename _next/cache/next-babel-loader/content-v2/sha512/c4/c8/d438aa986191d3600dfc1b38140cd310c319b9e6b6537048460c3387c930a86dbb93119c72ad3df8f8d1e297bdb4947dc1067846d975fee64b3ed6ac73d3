{"ast":null,"code":"var _jsxFileName = \"/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/components/page/sections/video/EditVideo.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport { Grid, Paper, Typography, Fab } from '@material-ui/core';\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { COLORS } from '../../../../constants';\nimport { DropzoneDialog } from 'material-ui-dropzone';\nimport { Upload } from '@webcms/orest';\nimport { isErrorMsg } from '../../../../../../../model/orest/constants';\nimport useTranslation from '../../../../../../../lib/translations/hooks/useTranslation';\nimport WebCmsGlobal from '../../../../../../webcms-global';\nimport { useRouter } from 'next/router';\nimport { useSelector } from 'react-redux';\nimport { toast } from 'react-toastify';\nimport ReactPlayer from 'react-player';\nimport LoadingSpinner from '../../../../../../LoadingSpinner';\nconst useStyles = makeStyles(theme => ({\n  root: {\n    card: {\n      maxWidth: 345\n    },\n    media: {\n      height: 0,\n      paddingTop: '56.25%'\n    }\n  },\n  submit: {\n    marginRight: theme.spacing(1),\n    marginBottom: theme.spacing(1),\n    borderRadius: 20,\n    marginTop: theme.spacing(1),\n    float: 'right'\n  },\n  fabBtn: {\n    marginBottom: theme.spacing(1),\n    marginLeft: theme.spacing(1)\n  },\n  disableEvent: {\n    pointerEvents: 'none',\n    opacity: 0.5\n  },\n  paperBlock: {\n    height: 245,\n    border: `2px solid ${COLORS === null || COLORS === void 0 ? void 0 : COLORS.secondary}`,\n    overflow: 'auto',\n    position: 'relative'\n  },\n  card: {\n    height: 245,\n    width: 392,\n    cursor: 'pointer'\n  },\n  heading: {\n    marginTop: theme.spacing(1),\n    marginLeft: theme.spacing(2),\n    fontWeight: 'bold',\n    fontSize: 15\n  },\n  textField: {\n    paddingRight: theme.spacing(1)\n  },\n  alignText: {\n    textAlign: 'right',\n    color: 'red'\n  },\n  emptyDiv: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    height: 245\n  },\n  defaultUploadBtn: {\n    float: 'right',\n    marginBottom: 8\n  }\n}));\n\nconst EditVideo = props => {\n  const {\n    handleCmponent,\n    videoComponent\n  } = props;\n  const {\n    0: localState,\n    1: setLocalState\n  } = useState({\n    videoFileUrl: null,\n    isOpenDialog: false,\n    isRequestSend: false,\n    fullVideoUrl: null\n  });\n  const {\n    videoFileUrl,\n    isOpenDialog,\n    isRequestSend\n  } = localState;\n  const classes = useStyles(); //context\n\n  const {\n    t\n  } = useTranslation();\n  const {\n    GENERAL_SETTINGS,\n    token\n  } = useContext(WebCmsGlobal);\n  const router = useRouter();\n  const companyId = router.query.companyID;\n  const authToken = token || router.query.authToken;\n  const state = useSelector(state => {\n    var _state$formReducer;\n\n    return state === null || state === void 0 ? void 0 : (_state$formReducer = state.formReducer) === null || _state$formReducer === void 0 ? void 0 : _state$formReducer.pageBuilder;\n  });\n  useEffect(() => {\n    videoComponent && setLocalState(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n      videoFileUrl: videoComponent.url,\n      fullVideoUrl: GENERAL_SETTINGS.STATIC_URL + videoComponent.url\n    }));\n  }, [videoComponent]);\n  useEffect(() => {\n    handleCmponent({\n      service: 'hcmitemvideo',\n      type: 'video',\n      url: videoFileUrl\n    });\n  }, [videoFileUrl]);\n\n  const handlevideoFileUrlUpload = file => {\n    setLocalState(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n      isOpenDialog: false,\n      isRequestSend: true\n    }));\n    Upload({\n      apiUrl: GENERAL_SETTINGS.OREST_URL,\n      token: authToken,\n      params: {\n        masterid: state.hotelMid,\n        orsactive: true,\n        hotelrefno: Number(companyId),\n        quality: '0.1F'\n      },\n      files: file\n    }).then(r => {\n      if (r.status === 200) {\n        let url = r.data.data.url.replace('/var/otello', '').replace('/public', '');\n        setLocalState(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n          videoFileUrl: url,\n          fullVideoUrl: GENERAL_SETTINGS.STATIC_URL + url,\n          isRequestSend: false\n        }));\n        toast.success(t('str_haveBeenUploadedMsg'), {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      } else {\n        const error = isErrorMsg(r);\n        toast.error(t(error.errMsg), {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      }\n    });\n  };\n\n  if (isRequestSend) {\n    return __jsx(LoadingSpinner, {\n      size: 50,\n      style: {\n        color: COLORS.secondary\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 16\n      }\n    });\n  }\n\n  return __jsx(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 9\n    }\n  }, videoFileUrl && __jsx(Typography, {\n    component: 'div',\n    className: classes.defaultUploadBtn,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 17\n    }\n  }, __jsx(Fab, {\n    onClick: () => setLocalState(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n      isOpenDialog: true\n    })),\n    variant: \"extended\",\n    size: \"small\",\n    color: \"primary\",\n    \"aria-label\": \"add\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 21\n    }\n  }, __jsx(CloudUploadIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 25\n    }\n  }), \"UPLOAD\")), __jsx(Grid, {\n    container: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 13\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 12,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 21\n    }\n  }, __jsx(Paper, {\n    className: classes.paperBlock,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 25\n    }\n  }, videoFileUrl ? __jsx(ReactPlayer, {\n    url: GENERAL_SETTINGS.STATIC_URL + videoFileUrl,\n    width: \"100%\",\n    height: \"100%\",\n    controls: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 33\n    }\n  }) : __jsx(Typography, {\n    component: 'div',\n    className: classes.emptyDiv,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 33\n    }\n  }, __jsx(Fab, {\n    onClick: () => setLocalState(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n      isOpenDialog: true\n    })),\n    variant: \"extended\",\n    size: \"small\",\n    color: \"primary\",\n    \"aria-label\": \"add\",\n    className: classes.fabBtn,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 37\n    }\n  }, __jsx(CloudUploadIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 41\n    }\n  }), \"UPLOAD\"))))), __jsx(DropzoneDialog, {\n    open: isOpenDialog,\n    onSave: handlevideoFileUrlUpload,\n    acceptedFiles: ['video/mp4'],\n    showPreviews: true,\n    filesLimit: 3,\n    maxFileSize: 200000000,\n    onClose: () => setLocalState(prevState => _objectSpread(_objectSpread({}, prevState), {}, {\n      isOpenDialog: false\n    })),\n    submitButtonText: t('str_save'),\n    cancelButtonText: t('str_cancel'),\n    dialogTitle: t('str_uploadAFile'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 13\n    }\n  }));\n};\n\nexport default EditVideo;","map":{"version":3,"sources":["/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/components/page/sections/video/EditVideo.js"],"names":["React","useContext","useEffect","useState","Grid","Paper","Typography","Fab","CloudUploadIcon","makeStyles","COLORS","DropzoneDialog","Upload","isErrorMsg","useTranslation","WebCmsGlobal","useRouter","useSelector","toast","ReactPlayer","LoadingSpinner","useStyles","theme","root","card","maxWidth","media","height","paddingTop","submit","marginRight","spacing","marginBottom","borderRadius","marginTop","float","fabBtn","marginLeft","disableEvent","pointerEvents","opacity","paperBlock","border","secondary","overflow","position","width","cursor","heading","fontWeight","fontSize","textField","paddingRight","alignText","textAlign","color","emptyDiv","display","alignItems","justifyContent","defaultUploadBtn","EditVideo","props","handleCmponent","videoComponent","localState","setLocalState","videoFileUrl","isOpenDialog","isRequestSend","fullVideoUrl","classes","t","GENERAL_SETTINGS","token","router","companyId","query","companyID","authToken","state","formReducer","pageBuilder","prevState","url","STATIC_URL","service","type","handlevideoFileUrlUpload","file","apiUrl","OREST_URL","params","masterid","hotelMid","orsactive","hotelrefno","Number","quality","files","then","r","status","data","replace","success","POSITION","TOP_RIGHT","error","errMsg"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,UAAhB,EAA4BC,SAA5B,EAAuCC,QAAvC,QAAuD,OAAvD;AACA,SAASC,IAAT,EAAeC,KAAf,EAAsBC,UAAtB,EAAkCC,GAAlC,QAA6C,mBAA7C;AACA,OAAOC,eAAP,MAA4B,gCAA5B;AACA,SAASC,UAAT,QAA2B,0BAA3B;AACA,SAASC,MAAT,QAAuB,uBAAvB;AACA,SAASC,cAAT,QAA+B,sBAA/B;AACA,SAASC,MAAT,QAAuB,eAAvB;AACA,SAASC,UAAT,QAA2B,4CAA3B;AACA,OAAOC,cAAP,MAA2B,4DAA3B;AACA,OAAOC,YAAP,MAAyB,iCAAzB;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,KAAT,QAAsB,gBAAtB;AACA,OAAOC,WAAP,MAAwB,cAAxB;AACA,OAAOC,cAAP,MAA2B,kCAA3B;AAEA,MAAMC,SAAS,GAAGZ,UAAU,CAAEa,KAAD,KAAY;AACrCC,EAAAA,IAAI,EAAE;AACFC,IAAAA,IAAI,EAAE;AACFC,MAAAA,QAAQ,EAAE;AADR,KADJ;AAIFC,IAAAA,KAAK,EAAE;AACHC,MAAAA,MAAM,EAAE,CADL;AAEHC,MAAAA,UAAU,EAAE;AAFT;AAJL,GAD+B;AAUrCC,EAAAA,MAAM,EAAE;AACJC,IAAAA,WAAW,EAAER,KAAK,CAACS,OAAN,CAAc,CAAd,CADT;AAEJC,IAAAA,YAAY,EAAEV,KAAK,CAACS,OAAN,CAAc,CAAd,CAFV;AAGJE,IAAAA,YAAY,EAAE,EAHV;AAIJC,IAAAA,SAAS,EAAEZ,KAAK,CAACS,OAAN,CAAc,CAAd,CAJP;AAKJI,IAAAA,KAAK,EAAE;AALH,GAV6B;AAiBrCC,EAAAA,MAAM,EAAE;AACJJ,IAAAA,YAAY,EAAEV,KAAK,CAACS,OAAN,CAAc,CAAd,CADV;AAEJM,IAAAA,UAAU,EAAEf,KAAK,CAACS,OAAN,CAAc,CAAd;AAFR,GAjB6B;AAqBrCO,EAAAA,YAAY,EAAE;AACVC,IAAAA,aAAa,EAAE,MADL;AAEVC,IAAAA,OAAO,EAAE;AAFC,GArBuB;AAyBrCC,EAAAA,UAAU,EAAE;AACRd,IAAAA,MAAM,EAAE,GADA;AAERe,IAAAA,MAAM,EAAG,aAAYhC,MAAb,aAAaA,MAAb,uBAAaA,MAAM,CAAEiC,SAAU,EAF/B;AAGRC,IAAAA,QAAQ,EAAE,MAHF;AAIRC,IAAAA,QAAQ,EAAE;AAJF,GAzByB;AA+BrCrB,EAAAA,IAAI,EAAE;AACFG,IAAAA,MAAM,EAAE,GADN;AAEFmB,IAAAA,KAAK,EAAE,GAFL;AAGFC,IAAAA,MAAM,EAAE;AAHN,GA/B+B;AAoCrCC,EAAAA,OAAO,EAAE;AACLd,IAAAA,SAAS,EAAEZ,KAAK,CAACS,OAAN,CAAc,CAAd,CADN;AAELM,IAAAA,UAAU,EAAEf,KAAK,CAACS,OAAN,CAAc,CAAd,CAFP;AAGLkB,IAAAA,UAAU,EAAE,MAHP;AAILC,IAAAA,QAAQ,EAAE;AAJL,GApC4B;AA0CrCC,EAAAA,SAAS,EAAE;AACPC,IAAAA,YAAY,EAAE9B,KAAK,CAACS,OAAN,CAAc,CAAd;AADP,GA1C0B;AA6CrCsB,EAAAA,SAAS,EAAE;AACPC,IAAAA,SAAS,EAAE,OADJ;AAEPC,IAAAA,KAAK,EAAE;AAFA,GA7C0B;AAiDrCC,EAAAA,QAAQ,EAAE;AACNC,IAAAA,OAAO,EAAE,MADH;AAENC,IAAAA,UAAU,EAAE,QAFN;AAGNC,IAAAA,cAAc,EAAE,QAHV;AAINhC,IAAAA,MAAM,EAAE;AAJF,GAjD2B;AAuDrCiC,EAAAA,gBAAgB,EAAE;AACdzB,IAAAA,KAAK,EAAE,OADO;AAEdH,IAAAA,YAAY,EAAE;AAFA;AAvDmB,CAAZ,CAAD,CAA5B;;AA6DA,MAAM6B,SAAS,GAAIC,KAAD,IAAW;AACzB,QAAM;AAAEC,IAAAA,cAAF;AAAkBC,IAAAA;AAAlB,MAAqCF,KAA3C;AACA,QAAM;AAAA,OAACG,UAAD;AAAA,OAAaC;AAAb,MAA8B/D,QAAQ,CAAC;AACzCgE,IAAAA,YAAY,EAAE,IAD2B;AAEzCC,IAAAA,YAAY,EAAE,KAF2B;AAGzCC,IAAAA,aAAa,EAAE,KAH0B;AAIzCC,IAAAA,YAAY,EAAE;AAJ2B,GAAD,CAA5C;AAOA,QAAM;AAAEH,IAAAA,YAAF;AAAgBC,IAAAA,YAAhB;AAA8BC,IAAAA;AAA9B,MAAgDJ,UAAtD;AAEA,QAAMM,OAAO,GAAGlD,SAAS,EAAzB,CAXyB,CAYzB;;AACA,QAAM;AAAEmD,IAAAA;AAAF,MAAQ1D,cAAc,EAA5B;AACA,QAAM;AAAE2D,IAAAA,gBAAF;AAAoBC,IAAAA;AAApB,MAA8BzE,UAAU,CAACc,YAAD,CAA9C;AACA,QAAM4D,MAAM,GAAG3D,SAAS,EAAxB;AACA,QAAM4D,SAAS,GAAGD,MAAM,CAACE,KAAP,CAAaC,SAA/B;AACA,QAAMC,SAAS,GAAGL,KAAK,IAAIC,MAAM,CAACE,KAAP,CAAaE,SAAxC;AACA,QAAMC,KAAK,GAAG/D,WAAW,CAAE+D,KAAD;AAAA;;AAAA,WAAWA,KAAX,aAAWA,KAAX,6CAAWA,KAAK,CAAEC,WAAlB,uDAAW,mBAAoBC,WAA/B;AAAA,GAAD,CAAzB;AAEAhF,EAAAA,SAAS,CAAC,MAAM;AACZ8D,IAAAA,cAAc,IAAIE,aAAa,CAAEiB,SAAD,oCAAqBA,SAArB;AAAgChB,MAAAA,YAAY,EAAEH,cAAc,CAACoB,GAA7D;AAAkEd,MAAAA,YAAY,EAAEG,gBAAgB,CAACY,UAAjB,GAA8BrB,cAAc,CAACoB;AAA7H,MAAD,CAA/B;AACH,GAFQ,EAEN,CAACpB,cAAD,CAFM,CAAT;AAIA9D,EAAAA,SAAS,CAAC,MAAM;AACZ6D,IAAAA,cAAc,CAAC;AACXuB,MAAAA,OAAO,EAAE,cADE;AAEXC,MAAAA,IAAI,EAAE,OAFK;AAGXH,MAAAA,GAAG,EAAEjB;AAHM,KAAD,CAAd;AAKH,GANQ,EAMN,CAACA,YAAD,CANM,CAAT;;AAQA,QAAMqB,wBAAwB,GAAIC,IAAD,IAAU;AACvCvB,IAAAA,aAAa,CAAEiB,SAAD,oCAAqBA,SAArB;AAAgCf,MAAAA,YAAY,EAAE,KAA9C;AAAqDC,MAAAA,aAAa,EAAE;AAApE,MAAD,CAAb;AACAzD,IAAAA,MAAM,CAAC;AACH8E,MAAAA,MAAM,EAAEjB,gBAAgB,CAACkB,SADtB;AAEHjB,MAAAA,KAAK,EAAEK,SAFJ;AAGHa,MAAAA,MAAM,EAAE;AACJC,QAAAA,QAAQ,EAAEb,KAAK,CAACc,QADZ;AAEJC,QAAAA,SAAS,EAAE,IAFP;AAGJC,QAAAA,UAAU,EAAEC,MAAM,CAACrB,SAAD,CAHd;AAIJsB,QAAAA,OAAO,EAAE;AAJL,OAHL;AASHC,MAAAA,KAAK,EAAEV;AATJ,KAAD,CAAN,CAUGW,IAVH,CAUSC,CAAD,IAAO;AACX,UAAIA,CAAC,CAACC,MAAF,KAAa,GAAjB,EAAsB;AAClB,YAAIlB,GAAG,GAAGiB,CAAC,CAACE,IAAF,CAAOA,IAAP,CAAYnB,GAAZ,CAAgBoB,OAAhB,CAAwB,aAAxB,EAAuC,EAAvC,EAA2CA,OAA3C,CAAmD,SAAnD,EAA8D,EAA9D,CAAV;AACAtC,QAAAA,aAAa,CAAEiB,SAAD,oCAAqBA,SAArB;AAAgChB,UAAAA,YAAY,EAAEiB,GAA9C;AAAmDd,UAAAA,YAAY,EAAEG,gBAAgB,CAACY,UAAjB,GAA8BD,GAA/F;AAAoGf,UAAAA,aAAa,EAAE;AAAnH,UAAD,CAAb;AACAnD,QAAAA,KAAK,CAACuF,OAAN,CAAcjC,CAAC,CAAC,yBAAD,CAAf,EAA4C;AACxC3B,UAAAA,QAAQ,EAAE3B,KAAK,CAACwF,QAAN,CAAeC;AADe,SAA5C;AAGH,OAND,MAMO;AACH,cAAMC,KAAK,GAAG/F,UAAU,CAACwF,CAAD,CAAxB;AACAnF,QAAAA,KAAK,CAAC0F,KAAN,CAAYpC,CAAC,CAACoC,KAAK,CAACC,MAAP,CAAb,EAA6B;AACzBhE,UAAAA,QAAQ,EAAE3B,KAAK,CAACwF,QAAN,CAAeC;AADA,SAA7B;AAGH;AACJ,KAvBD;AAwBH,GA1BD;;AA4BA,MAAItC,aAAJ,EAAmB;AACf,WAAO,MAAC,cAAD;AAAgB,MAAA,IAAI,EAAE,EAAtB;AAA0B,MAAA,KAAK,EAAE;AAAEd,QAAAA,KAAK,EAAE7C,MAAM,CAACiC;AAAhB,OAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AACH;;AAED,SACI,MAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACKwB,YAAY,IACT,MAAC,UAAD;AAAY,IAAA,SAAS,EAAE,KAAvB;AAA8B,IAAA,SAAS,EAAEI,OAAO,CAACX,gBAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,MAAC,GAAD;AACI,IAAA,OAAO,EAAE,MAAMM,aAAa,CAAEiB,SAAD,oCAAqBA,SAArB;AAAgCf,MAAAA,YAAY,EAAE;AAA9C,MAAD,CADhC;AAEI,IAAA,OAAO,EAAC,UAFZ;AAGI,IAAA,IAAI,EAAC,OAHT;AAII,IAAA,KAAK,EAAC,SAJV;AAKI,kBAAW,KALf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAOI,MAAC,eAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAPJ,WADJ,CAFR,EAeI,MAAC,IAAD;AAAM,IAAA,SAAS,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAEQ,MAAC,IAAD;AAAM,IAAA,IAAI,MAAV;AAAW,IAAA,EAAE,EAAE,EAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,MAAC,KAAD;AAAO,IAAA,SAAS,EAAEG,OAAO,CAAC9B,UAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACK0B,YAAY,GACT,MAAC,WAAD;AACI,IAAA,GAAG,EAAEM,gBAAgB,CAACY,UAAjB,GAA8BlB,YADvC;AAEI,IAAA,KAAK,EAAC,MAFV;AAGI,IAAA,MAAM,EAAC,MAHX;AAII,IAAA,QAAQ,EAAE,IAJd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADS,GAQT,MAAC,UAAD;AAAY,IAAA,SAAS,EAAE,KAAvB;AAA8B,IAAA,SAAS,EAAEI,OAAO,CAACf,QAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACI,MAAC,GAAD;AACI,IAAA,OAAO,EAAE,MACLU,aAAa,CAAEiB,SAAD,oCAAqBA,SAArB;AAAgCf,MAAAA,YAAY,EAAE;AAA9C,MAAD,CAFrB;AAII,IAAA,OAAO,EAAC,UAJZ;AAKI,IAAA,IAAI,EAAC,OALT;AAMI,IAAA,KAAK,EAAC,SANV;AAOI,kBAAW,KAPf;AAQI,IAAA,SAAS,EAAEG,OAAO,CAACnC,MARvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAUI,MAAC,eAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAVJ,WADJ,CATR,CADJ,CAFR,CAfJ,EA+CI,MAAC,cAAD;AACI,IAAA,IAAI,EAAEgC,YADV;AAEI,IAAA,MAAM,EAAEoB,wBAFZ;AAGI,IAAA,aAAa,EAAE,CAAC,WAAD,CAHnB;AAII,IAAA,YAAY,EAAE,IAJlB;AAKI,IAAA,UAAU,EAAE,CALhB;AAMI,IAAA,WAAW,EAAE,SANjB;AAOI,IAAA,OAAO,EAAE,MAAMtB,aAAa,CAAEiB,SAAD,oCAAqBA,SAArB;AAAgCf,MAAAA,YAAY,EAAE;AAA9C,MAAD,CAPhC;AAQI,IAAA,gBAAgB,EAAEI,CAAC,CAAC,UAAD,CARvB;AASI,IAAA,gBAAgB,EAAEA,CAAC,CAAC,YAAD,CATvB;AAUI,IAAA,WAAW,EAAEA,CAAC,CAAC,iBAAD,CAVlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IA/CJ,CADJ;AA8DH,CA9HD;;AA+HA,eAAeX,SAAf","sourcesContent":["import React, { useContext, useEffect, useState } from 'react'\nimport { Grid, Paper, Typography, Fab } from '@material-ui/core'\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { COLORS } from '../../../../constants'\nimport { DropzoneDialog } from 'material-ui-dropzone'\nimport { Upload } from '@webcms/orest'\nimport { isErrorMsg } from '../../../../../../../model/orest/constants'\nimport useTranslation from '../../../../../../../lib/translations/hooks/useTranslation'\nimport WebCmsGlobal from '../../../../../../webcms-global'\nimport { useRouter } from 'next/router'\nimport { useSelector } from 'react-redux'\nimport { toast } from 'react-toastify'\nimport ReactPlayer from 'react-player'\nimport LoadingSpinner from '../../../../../../LoadingSpinner'\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        card: {\n            maxWidth: 345,\n        },\n        media: {\n            height: 0,\n            paddingTop: '56.25%',\n        },\n    },\n    submit: {\n        marginRight: theme.spacing(1),\n        marginBottom: theme.spacing(1),\n        borderRadius: 20,\n        marginTop: theme.spacing(1),\n        float: 'right',\n    },\n    fabBtn: {\n        marginBottom: theme.spacing(1),\n        marginLeft: theme.spacing(1),\n    },\n    disableEvent: {\n        pointerEvents: 'none',\n        opacity: 0.5,\n    },\n    paperBlock: {\n        height: 245,\n        border: `2px solid ${COLORS?.secondary}`,\n        overflow: 'auto',\n        position: 'relative',\n    },\n    card: {\n        height: 245,\n        width: 392,\n        cursor: 'pointer',\n    },\n    heading: {\n        marginTop: theme.spacing(1),\n        marginLeft: theme.spacing(2),\n        fontWeight: 'bold',\n        fontSize: 15,\n    },\n    textField: {\n        paddingRight: theme.spacing(1),\n    },\n    alignText: {\n        textAlign: 'right',\n        color: 'red',\n    },\n    emptyDiv: {\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        height: 245,\n    },\n    defaultUploadBtn: {\n        float: 'right',\n        marginBottom: 8\n    }\n}))\n\nconst EditVideo = (props) => {\n    const { handleCmponent, videoComponent } = props\n    const [localState, setLocalState] = useState({\n        videoFileUrl: null,\n        isOpenDialog: false,\n        isRequestSend: false,\n        fullVideoUrl: null\n    })\n\n    const { videoFileUrl, isOpenDialog, isRequestSend } = localState\n\n    const classes = useStyles()\n    //context\n    const { t } = useTranslation()\n    const { GENERAL_SETTINGS, token } = useContext(WebCmsGlobal)\n    const router = useRouter()\n    const companyId = router.query.companyID\n    const authToken = token || router.query.authToken\n    const state = useSelector((state) => state?.formReducer?.pageBuilder)\n\n    useEffect(() => {\n        videoComponent && setLocalState((prevState) => ({ ...prevState, videoFileUrl: videoComponent.url, fullVideoUrl: GENERAL_SETTINGS.STATIC_URL + videoComponent.url }))\n    }, [videoComponent]);\n\n    useEffect(() => {\n        handleCmponent({\n            service: 'hcmitemvideo',\n            type: 'video',\n            url: videoFileUrl,\n        })\n    }, [videoFileUrl])\n\n    const handlevideoFileUrlUpload = (file) => {\n        setLocalState((prevState) => ({ ...prevState, isOpenDialog: false, isRequestSend: true }))\n        Upload({\n            apiUrl: GENERAL_SETTINGS.OREST_URL,\n            token: authToken,\n            params: {\n                masterid: state.hotelMid,\n                orsactive: true,\n                hotelrefno: Number(companyId),\n                quality: '0.1F',\n            },\n            files: file,\n        }).then((r) => {\n            if (r.status === 200) {\n                let url = r.data.data.url.replace('/var/otello', '').replace('/public', '')\n                setLocalState((prevState) => ({ ...prevState, videoFileUrl: url, fullVideoUrl: GENERAL_SETTINGS.STATIC_URL + url, isRequestSend: false }))\n                toast.success(t('str_haveBeenUploadedMsg'), {\n                    position: toast.POSITION.TOP_RIGHT,\n                })\n            } else {\n                const error = isErrorMsg(r)\n                toast.error(t(error.errMsg), {\n                    position: toast.POSITION.TOP_RIGHT,\n                })\n            }\n        })\n    }\n\n    if (isRequestSend) {\n        return <LoadingSpinner size={50} style={{ color: COLORS.secondary }} />\n    }\n\n    return (\n        <React.Fragment>\n            {videoFileUrl && (\n                <Typography component={'div'} className={classes.defaultUploadBtn}>\n                    <Fab\n                        onClick={() => setLocalState((prevState) => ({ ...prevState, isOpenDialog: true }))}\n                        variant=\"extended\"\n                        size=\"small\"\n                        color=\"primary\"\n                        aria-label=\"add\"\n                    >\n                        <CloudUploadIcon />\n                        UPLOAD\n                    </Fab>\n                </Typography>\n            )}\n            <Grid container>\n                {\n                    <Grid item xs={12}>\n                        <Paper className={classes.paperBlock}>\n                            {videoFileUrl ? (\n                                <ReactPlayer\n                                    url={GENERAL_SETTINGS.STATIC_URL + videoFileUrl}\n                                    width=\"100%\"\n                                    height=\"100%\"\n                                    controls={true}\n                                />\n                            ) : (\n                                <Typography component={'div'} className={classes.emptyDiv}>\n                                    <Fab\n                                        onClick={() =>\n                                            setLocalState((prevState) => ({ ...prevState, isOpenDialog: true }))\n                                        }\n                                        variant=\"extended\"\n                                        size=\"small\"\n                                        color=\"primary\"\n                                        aria-label=\"add\"\n                                        className={classes.fabBtn}\n                                    >\n                                        <CloudUploadIcon />\n                                        UPLOAD\n                                    </Fab>\n                                </Typography>\n                            )}\n                        </Paper>\n                    </Grid>\n                }\n            </Grid>\n            <DropzoneDialog\n                open={isOpenDialog}\n                onSave={handlevideoFileUrlUpload}\n                acceptedFiles={['video/mp4']}\n                showPreviews={true}\n                filesLimit={3}\n                maxFileSize={200000000}\n                onClose={() => setLocalState((prevState) => ({ ...prevState, isOpenDialog: false }))}\n                submitButtonText={t('str_save')}\n                cancelButtonText={t('str_cancel')}\n                dialogTitle={t('str_uploadAFile')}\n            />\n        </React.Fragment>\n    )\n}\nexport default EditVideo\n"]},"metadata":{},"sourceType":"module"}
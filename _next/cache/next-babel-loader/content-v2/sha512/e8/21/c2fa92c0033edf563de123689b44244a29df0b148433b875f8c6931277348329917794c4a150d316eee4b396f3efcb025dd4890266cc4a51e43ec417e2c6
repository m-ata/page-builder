{"ast":null,"code":"var _jsxFileName = \"/Users/mata/app-cloudweb/components/survey/surveytree/options/Select.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState } from 'react';\nimport { Select } from '@material-ui/core';\nimport FormControl from '@material-ui/core/FormControl';\nimport { SURVEY_INPUT_VARIANT } from '../../../../assets/const';\nimport useSurveyAction from '../../../../model/survey/useSurveyAction';\nimport { useSelector } from 'react-redux';\nimport { makeStyles } from '@material-ui/core/styles';\nimport styles from '../../style/SurveyOptions.style';\nimport OnePageSurvey from '../render-types/OnePageSurvey';\nimport HasNote from './sub-components/HasNote';\nimport HasFile from './sub-components/HasFile';\nimport SurveyTooltip from 'components/survey/helper/SurveyTooltip';\nconst useStyles = makeStyles(styles);\n\nfunction getOptionFromOptionValue(options, optionValue) {\n  if (options && options.length > 0) {\n    let data = [];\n    options.map(k => {\n      data = _objectSpread(_objectSpread({}, data), {}, {\n        [k.id]: k\n      });\n    });\n    return data[optionValue];\n  } else {\n    return null;\n  }\n}\n\nexport default function SelectOption(props) {\n  const {\n    options,\n    optionTyp,\n    index\n  } = props; //style\n\n  const classes = useStyles(); //redux\n\n  const {\n    setSurveyAnswer\n  } = useSurveyAction();\n  const surveyTrans = useSelector(state => state.survey.trans);\n  const surveyIsValid = useSelector(state => state.survey.isValid);\n  const oldAnswers = useSelector(state => state.survey.answers[surveyTrans] && state.survey.answers[surveyTrans][options[0].parentid]);\n  const oldAnswer = oldAnswers && Object.keys(oldAnswers).map(k => _objectSpread(_objectSpread({}, oldAnswers[k]), {}, {\n    id: k\n  })).filter(j => {\n    return j.typ === optionTyp;\n  }); //state\n\n  const {\n    0: option,\n    1: setOption\n  } = useState(getOptionFromOptionValue(options, oldAnswer && oldAnswer[0] ? oldAnswer[0].id : ''));\n  const {\n    0: optionValue,\n    1: setOptionValue\n  } = useState(oldAnswer && oldAnswer[0] ? oldAnswer[0].id : '');\n  const {\n    0: answerNote,\n    1: setAnswerNote\n  } = useState(oldAnswer && oldAnswer[0] ? oldAnswer[0].answernote || '' : '');\n\n  const handleChangeOption = event => {\n    const value = event.target.value;\n    setOption(getOptionFromOptionValue(options, value)); //clear answerNote\n\n    setAnswerNote('');\n    setOptionValue(value);\n\n    if (value && value !== '' && value !== 0) {\n      setSurveyAnswer(surveyTrans, options[0].parentid, value, {\n        typ: optionTyp,\n        parentid: options[0].parentid\n      });\n    }\n  };\n\n  const handleChangeAnswerNote = event => {\n    const value = event.target.value;\n    setAnswerNote(value);\n    setSurveyAnswer(surveyTrans, options[0].parentid, optionValue, {\n      typ: optionTyp,\n      parentid: options[0].parentid,\n      answernote: value\n    });\n  };\n\n  return __jsx(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: classes.optionContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }\n  }, __jsx(SurveyTooltip, {\n    title: option && option.note || '',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 17\n    }\n  }, __jsx(FormControl, {\n    variant: SURVEY_INPUT_VARIANT,\n    fullWidth: true,\n    disabled: surveyIsValid,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 21\n    }\n  }, __jsx(Select, {\n    native: true,\n    value: optionValue,\n    onChange: handleChangeOption,\n    className: classes.textField,\n    inputProps: {\n      name: 'language-native-select',\n      id: 'language-native-select',\n      className: classes.textFieldInput\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 25\n    }\n  }, __jsx(\"option\", {\n    \"aria-label\": \"None\",\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 29\n    }\n  }), options.map((option, i) => {\n    if (option.typ === optionTyp) {\n      return __jsx(\"option\", {\n        value: String(option.id),\n        key: i,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 41\n        }\n      }, option.langwordtxt || option.description);\n    }\n  }))))), option && option.hasnote && __jsx(HasNote, {\n    labelvisible: option.itemlabelvisible,\n    name: option.id,\n    label: option.customvalue,\n    value: answerNote,\n    onChange: handleChangeAnswerNote,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 17\n    }\n  }), option && option.hasfile && __jsx(HasFile, {\n    option: option,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 42\n    }\n  }), option && option.children && __jsx(OnePageSurvey, {\n    options: option.children,\n    index: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 43\n    }\n  }));\n}","map":{"version":3,"sources":["/Users/mata/app-cloudweb/components/survey/surveytree/options/Select.js"],"names":["React","useState","Select","FormControl","SURVEY_INPUT_VARIANT","useSurveyAction","useSelector","makeStyles","styles","OnePageSurvey","HasNote","HasFile","SurveyTooltip","useStyles","getOptionFromOptionValue","options","optionValue","length","data","map","k","id","SelectOption","props","optionTyp","index","classes","setSurveyAnswer","surveyTrans","state","survey","trans","surveyIsValid","isValid","oldAnswers","answers","parentid","oldAnswer","Object","keys","filter","j","typ","option","setOption","setOptionValue","answerNote","setAnswerNote","answernote","handleChangeOption","event","value","target","handleChangeAnswerNote","optionContainer","note","textField","name","className","textFieldInput","i","String","langwordtxt","description","hasnote","itemlabelvisible","customvalue","hasfile","children"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport { Select } from '@material-ui/core'\nimport FormControl from '@material-ui/core/FormControl'\nimport { SURVEY_INPUT_VARIANT } from '../../../../assets/const'\nimport useSurveyAction from '../../../../model/survey/useSurveyAction'\nimport { useSelector } from 'react-redux'\nimport { makeStyles } from '@material-ui/core/styles'\nimport styles from '../../style/SurveyOptions.style'\nimport OnePageSurvey from '../render-types/OnePageSurvey'\nimport HasNote from './sub-components/HasNote'\nimport HasFile from './sub-components/HasFile'\nimport SurveyTooltip from 'components/survey/helper/SurveyTooltip'\n\nconst useStyles = makeStyles(styles)\n\nfunction getOptionFromOptionValue(options, optionValue) {\n    if (options && options.length > 0) {\n        let data = []\n        options.map((k) => {\n            data = { ...data, [k.id]: k }\n        })\n\n        return data[optionValue]\n    } else {\n        return null\n    }\n}\n\nexport default function SelectOption(props) {\n    const { options, optionTyp, index } = props\n\n    //style\n    const classes = useStyles()\n\n    //redux\n    const { setSurveyAnswer } = useSurveyAction()\n    const surveyTrans = useSelector((state) => state.survey.trans)\n    const surveyIsValid = useSelector((state) => state.survey.isValid)\n    const oldAnswers = useSelector(\n        (state) => state.survey.answers[surveyTrans] && state.survey.answers[surveyTrans][options[0].parentid],\n    )\n    const oldAnswer =\n        oldAnswers &&\n        Object.keys(oldAnswers)\n            .map((k) => ({ ...oldAnswers[k], id: k }))\n            .filter((j) => {\n                return j.typ === optionTyp\n            })\n\n    //state\n    const [option, setOption] = useState(\n        getOptionFromOptionValue(options, oldAnswer && oldAnswer[0] ? oldAnswer[0].id : ''),\n    )\n    const [optionValue, setOptionValue] = useState(oldAnswer && oldAnswer[0] ? oldAnswer[0].id : '')\n    const [answerNote, setAnswerNote] = useState(oldAnswer && oldAnswer[0] ? oldAnswer[0].answernote || '' : '')\n\n    const handleChangeOption = (event) => {\n        const value = event.target.value\n        setOption(getOptionFromOptionValue(options, value))\n\n        //clear answerNote\n        setAnswerNote('')\n        setOptionValue(value)\n        if (value && value !== '' && value !== 0) {\n            setSurveyAnswer(surveyTrans, options[0].parentid, value, {\n                typ: optionTyp,\n                parentid: options[0].parentid,\n            })\n        }\n    }\n\n    const handleChangeAnswerNote = (event) => {\n        const value = event.target.value\n        setAnswerNote(value)\n\n        setSurveyAnswer(surveyTrans, options[0].parentid, optionValue, {\n            typ: optionTyp,\n            parentid: options[0].parentid,\n            answernote: value,\n        })\n    }\n\n    return (\n        <React.Fragment>\n            <div className={classes.optionContainer}>\n                <SurveyTooltip title={option && option.note || ''}>\n                    <FormControl variant={SURVEY_INPUT_VARIANT} fullWidth disabled={surveyIsValid}>\n                        <Select\n                            native\n                            value={optionValue}\n                            onChange={handleChangeOption}\n                            className={classes.textField}\n                            inputProps={{\n                                name: 'language-native-select',\n                                id: 'language-native-select',\n                                className: classes.textFieldInput,\n                            }}\n                        >\n                            <option aria-label=\"None\" value=\"\"/>\n                            {options.map((option, i) => {\n                                if (option.typ === optionTyp) {\n                                    return (\n                                        <option value={String(option.id)} key={i}>\n                                            {option.langwordtxt || option.description}\n                                        </option>\n                                    )\n                                }\n                            })}\n                        </Select>\n                    </FormControl>\n                </SurveyTooltip>\n            </div>\n            {option && option.hasnote && (\n                <HasNote\n                    labelvisible={option.itemlabelvisible}\n                    name={option.id}\n                    label={option.customvalue}\n                    value={answerNote}\n                    onChange={handleChangeAnswerNote}\n                />\n            )}\n            {option && option.hasfile && <HasFile option={option}/>}\n            {option && option.children && <OnePageSurvey options={option.children} index={index}/>}\n        </React.Fragment>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}
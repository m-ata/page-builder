{"ast":null,"code":"import _defineProperty from \"/Users/mata/app-cloudweb/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/components/page/sections/video/EditVideo.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useContext, useEffect, useState } from 'react';\nimport { Grid, Paper, Typography, Fab } from '@material-ui/core';\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { COLORS } from '../../../../constants';\nimport { DropzoneDialog } from 'material-ui-dropzone';\nimport { Upload } from '@webcms/orest';\nimport { isErrorMsg } from '../../../../../../../model/orest/constants';\nimport useTranslation from '../../../../../../../lib/translations/hooks/useTranslation';\nimport WebCmsGlobal from '../../../../../../webcms-global';\nimport { useRouter } from 'next/router';\nimport { useSelector } from 'react-redux';\nimport { toast } from 'react-toastify';\nimport ReactPlayer from 'react-player';\nimport LoadingSpinner from '../../../../../../LoadingSpinner';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    root: {\n      card: {\n        maxWidth: 345\n      },\n      media: {\n        height: 0,\n        paddingTop: '56.25%'\n      }\n    },\n    submit: {\n      marginRight: theme.spacing(1),\n      marginBottom: theme.spacing(1),\n      borderRadius: 20,\n      marginTop: theme.spacing(1),\n      \"float\": 'right'\n    },\n    fabBtn: {\n      marginBottom: theme.spacing(1),\n      marginLeft: theme.spacing(1)\n    },\n    disableEvent: {\n      pointerEvents: 'none',\n      opacity: 0.5\n    },\n    paperBlock: {\n      height: 245,\n      border: \"2px solid \".concat(COLORS === null || COLORS === void 0 ? void 0 : COLORS.secondary),\n      overflow: 'auto',\n      position: 'relative'\n    },\n    card: {\n      height: 245,\n      width: 392,\n      cursor: 'pointer'\n    },\n    heading: {\n      marginTop: theme.spacing(1),\n      marginLeft: theme.spacing(2),\n      fontWeight: 'bold',\n      fontSize: 15\n    },\n    textField: {\n      paddingRight: theme.spacing(1)\n    },\n    alignText: {\n      textAlign: 'right',\n      color: 'red'\n    },\n    emptyDiv: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      height: 245\n    },\n    defaultUploadBtn: {\n      \"float\": 'right',\n      marginBottom: 8\n    }\n  };\n});\n\nvar EditVideo = function EditVideo(props) {\n  _s();\n\n  var handleCmponent = props.handleCmponent,\n      videoComponent = props.videoComponent;\n\n  var _useState = useState({\n    videoFileUrl: null,\n    isOpenDialog: false,\n    isRequestSend: false,\n    fullVideoUrl: null\n  }),\n      localState = _useState[0],\n      setLocalState = _useState[1];\n\n  var videoFileUrl = localState.videoFileUrl,\n      isOpenDialog = localState.isOpenDialog,\n      isRequestSend = localState.isRequestSend;\n  var classes = useStyles(); //context\n\n  var _useTranslation = useTranslation(),\n      t = _useTranslation.t;\n\n  var _useContext = useContext(WebCmsGlobal),\n      GENERAL_SETTINGS = _useContext.GENERAL_SETTINGS,\n      token = _useContext.token;\n\n  var router = useRouter();\n  var companyId = router.query.companyID;\n  var authToken = token || router.query.authToken;\n  var state = useSelector(function (state) {\n    var _state$formReducer;\n\n    return state === null || state === void 0 ? void 0 : (_state$formReducer = state.formReducer) === null || _state$formReducer === void 0 ? void 0 : _state$formReducer.pageBuilder;\n  });\n  useEffect(function () {\n    videoComponent && setLocalState(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, {\n        videoFileUrl: videoComponent.url,\n        fullVideoUrl: GENERAL_SETTINGS.STATIC_URL + videoComponent.url\n      });\n    });\n  }, [videoComponent]);\n  useEffect(function () {\n    handleCmponent({\n      service: 'hcmitemvideo',\n      type: 'video',\n      url: videoFileUrl\n    });\n  }, [videoFileUrl]);\n\n  var handlevideoFileUrlUpload = function handlevideoFileUrlUpload(file) {\n    setLocalState(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, {\n        isOpenDialog: false,\n        isRequestSend: true\n      });\n    });\n    Upload({\n      apiUrl: GENERAL_SETTINGS.OREST_URL,\n      token: authToken,\n      params: {\n        masterid: state.hotelMid,\n        orsactive: true,\n        hotelrefno: Number(companyId),\n        quality: '0.1F'\n      },\n      files: file\n    }).then(function (r) {\n      if (r.status === 200) {\n        var url = r.data.data.url.replace('/var/otello', '').replace('/public', '');\n        setLocalState(function (prevState) {\n          return _objectSpread(_objectSpread({}, prevState), {}, {\n            videoFileUrl: url,\n            fullVideoUrl: GENERAL_SETTINGS.STATIC_URL + url,\n            isRequestSend: false\n          });\n        });\n        toast.success(t('str_haveBeenUploadedMsg'), {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      } else {\n        var error = isErrorMsg(r);\n        toast.error(t(error.errMsg), {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      }\n    });\n  };\n\n  if (isRequestSend) {\n    return __jsx(LoadingSpinner, {\n      size: 50,\n      style: {\n        color: COLORS.secondary\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 16\n      }\n    });\n  }\n\n  return __jsx(React.Fragment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 9\n    }\n  }, videoFileUrl && __jsx(Typography, {\n    component: 'div',\n    className: classes.defaultUploadBtn,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 17\n    }\n  }, __jsx(Fab, {\n    onClick: function onClick() {\n      return setLocalState(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, {\n          isOpenDialog: true\n        });\n      });\n    },\n    variant: \"extended\",\n    size: \"small\",\n    color: \"primary\",\n    \"aria-label\": \"add\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 21\n    }\n  }, __jsx(CloudUploadIcon, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 25\n    }\n  }), \"UPLOAD\")), __jsx(Grid, {\n    container: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 13\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 12,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 21\n    }\n  }, __jsx(Paper, {\n    className: classes.paperBlock,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 25\n    }\n  }, videoFileUrl ? __jsx(ReactPlayer, {\n    url: GENERAL_SETTINGS.STATIC_URL + videoFileUrl,\n    width: \"100%\",\n    height: \"100%\",\n    controls: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 33\n    }\n  }) : __jsx(Typography, {\n    component: 'div',\n    className: classes.emptyDiv,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 33\n    }\n  }, __jsx(Fab, {\n    onClick: function onClick() {\n      return setLocalState(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, {\n          isOpenDialog: true\n        });\n      });\n    },\n    variant: \"extended\",\n    size: \"small\",\n    color: \"primary\",\n    \"aria-label\": \"add\",\n    className: classes.fabBtn,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 37\n    }\n  }, __jsx(CloudUploadIcon, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 41\n    }\n  }), \"UPLOAD\"))))), __jsx(DropzoneDialog, {\n    open: isOpenDialog,\n    onSave: handlevideoFileUrlUpload,\n    acceptedFiles: ['video/mp4'],\n    showPreviews: true,\n    filesLimit: 3,\n    maxFileSize: 200000000,\n    onClose: function onClose() {\n      return setLocalState(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, {\n          isOpenDialog: false\n        });\n      });\n    },\n    submitButtonText: t('str_save'),\n    cancelButtonText: t('str_cancel'),\n    dialogTitle: t('str_uploadAFile'),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 13\n    }\n  }));\n};\n\n_s(EditVideo, \"VEzoyxu5TUCazc2mKyqtdm1v/fk=\", false, function () {\n  return [useStyles, useTranslation, useRouter, useSelector];\n});\n\n_c = EditVideo;\nexport default EditVideo;\n\nvar _c;\n\n$RefreshReg$(_c, \"EditVideo\");","map":{"version":3,"sources":["/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/components/page/sections/video/EditVideo.js"],"names":["React","useContext","useEffect","useState","Grid","Paper","Typography","Fab","CloudUploadIcon","makeStyles","COLORS","DropzoneDialog","Upload","isErrorMsg","useTranslation","WebCmsGlobal","useRouter","useSelector","toast","ReactPlayer","LoadingSpinner","useStyles","theme","root","card","maxWidth","media","height","paddingTop","submit","marginRight","spacing","marginBottom","borderRadius","marginTop","fabBtn","marginLeft","disableEvent","pointerEvents","opacity","paperBlock","border","secondary","overflow","position","width","cursor","heading","fontWeight","fontSize","textField","paddingRight","alignText","textAlign","color","emptyDiv","display","alignItems","justifyContent","defaultUploadBtn","EditVideo","props","handleCmponent","videoComponent","videoFileUrl","isOpenDialog","isRequestSend","fullVideoUrl","localState","setLocalState","classes","t","GENERAL_SETTINGS","token","router","companyId","query","companyID","authToken","state","formReducer","pageBuilder","prevState","url","STATIC_URL","service","type","handlevideoFileUrlUpload","file","apiUrl","OREST_URL","params","masterid","hotelMid","orsactive","hotelrefno","Number","quality","files","then","r","status","data","replace","success","POSITION","TOP_RIGHT","error","errMsg"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from 'react'\nimport { Grid, Paper, Typography, Fab } from '@material-ui/core'\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { COLORS } from '../../../../constants'\nimport { DropzoneDialog } from 'material-ui-dropzone'\nimport { Upload } from '@webcms/orest'\nimport { isErrorMsg } from '../../../../../../../model/orest/constants'\nimport useTranslation from '../../../../../../../lib/translations/hooks/useTranslation'\nimport WebCmsGlobal from '../../../../../../webcms-global'\nimport { useRouter } from 'next/router'\nimport { useSelector } from 'react-redux'\nimport { toast } from 'react-toastify'\nimport ReactPlayer from 'react-player'\nimport LoadingSpinner from '../../../../../../LoadingSpinner'\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        card: {\n            maxWidth: 345,\n        },\n        media: {\n            height: 0,\n            paddingTop: '56.25%',\n        },\n    },\n    submit: {\n        marginRight: theme.spacing(1),\n        marginBottom: theme.spacing(1),\n        borderRadius: 20,\n        marginTop: theme.spacing(1),\n        float: 'right',\n    },\n    fabBtn: {\n        marginBottom: theme.spacing(1),\n        marginLeft: theme.spacing(1),\n    },\n    disableEvent: {\n        pointerEvents: 'none',\n        opacity: 0.5,\n    },\n    paperBlock: {\n        height: 245,\n        border: `2px solid ${COLORS?.secondary}`,\n        overflow: 'auto',\n        position: 'relative',\n    },\n    card: {\n        height: 245,\n        width: 392,\n        cursor: 'pointer',\n    },\n    heading: {\n        marginTop: theme.spacing(1),\n        marginLeft: theme.spacing(2),\n        fontWeight: 'bold',\n        fontSize: 15,\n    },\n    textField: {\n        paddingRight: theme.spacing(1),\n    },\n    alignText: {\n        textAlign: 'right',\n        color: 'red',\n    },\n    emptyDiv: {\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        height: 245,\n    },\n    defaultUploadBtn: {\n        float: 'right',\n        marginBottom: 8\n    }\n}))\n\nconst EditVideo = (props) => {\n    const { handleCmponent, videoComponent } = props\n    const [localState, setLocalState] = useState({\n        videoFileUrl: null,\n        isOpenDialog: false,\n        isRequestSend: false,\n        fullVideoUrl: null\n    })\n\n    const { videoFileUrl, isOpenDialog, isRequestSend } = localState\n\n    const classes = useStyles()\n    //context\n    const { t } = useTranslation()\n    const { GENERAL_SETTINGS, token } = useContext(WebCmsGlobal)\n    const router = useRouter()\n    const companyId = router.query.companyID\n    const authToken = token || router.query.authToken\n    const state = useSelector((state) => state?.formReducer?.pageBuilder)\n\n    useEffect(() => {\n        videoComponent && setLocalState((prevState) => ({ ...prevState, videoFileUrl: videoComponent.url, fullVideoUrl: GENERAL_SETTINGS.STATIC_URL + videoComponent.url }))\n    }, [videoComponent]);\n\n    useEffect(() => {\n        handleCmponent({\n            service: 'hcmitemvideo',\n            type: 'video',\n            url: videoFileUrl,\n        })\n    }, [videoFileUrl])\n\n    const handlevideoFileUrlUpload = (file) => {\n        setLocalState((prevState) => ({ ...prevState, isOpenDialog: false, isRequestSend: true }))\n        Upload({\n            apiUrl: GENERAL_SETTINGS.OREST_URL,\n            token: authToken,\n            params: {\n                masterid: state.hotelMid,\n                orsactive: true,\n                hotelrefno: Number(companyId),\n                quality: '0.1F',\n            },\n            files: file,\n        }).then((r) => {\n            if (r.status === 200) {\n                let url = r.data.data.url.replace('/var/otello', '').replace('/public', '')\n                setLocalState((prevState) => ({ ...prevState, videoFileUrl: url, fullVideoUrl: GENERAL_SETTINGS.STATIC_URL + url, isRequestSend: false }))\n                toast.success(t('str_haveBeenUploadedMsg'), {\n                    position: toast.POSITION.TOP_RIGHT,\n                })\n            } else {\n                const error = isErrorMsg(r)\n                toast.error(t(error.errMsg), {\n                    position: toast.POSITION.TOP_RIGHT,\n                })\n            }\n        })\n    }\n\n    if (isRequestSend) {\n        return <LoadingSpinner size={50} style={{ color: COLORS.secondary }} />\n    }\n\n    return (\n        <React.Fragment>\n            {videoFileUrl && (\n                <Typography component={'div'} className={classes.defaultUploadBtn}>\n                    <Fab\n                        onClick={() => setLocalState((prevState) => ({ ...prevState, isOpenDialog: true }))}\n                        variant=\"extended\"\n                        size=\"small\"\n                        color=\"primary\"\n                        aria-label=\"add\"\n                    >\n                        <CloudUploadIcon />\n                        UPLOAD\n                    </Fab>\n                </Typography>\n            )}\n            <Grid container>\n                {\n                    <Grid item xs={12}>\n                        <Paper className={classes.paperBlock}>\n                            {videoFileUrl ? (\n                                <ReactPlayer\n                                    url={GENERAL_SETTINGS.STATIC_URL + videoFileUrl}\n                                    width=\"100%\"\n                                    height=\"100%\"\n                                    controls={true}\n                                />\n                            ) : (\n                                <Typography component={'div'} className={classes.emptyDiv}>\n                                    <Fab\n                                        onClick={() =>\n                                            setLocalState((prevState) => ({ ...prevState, isOpenDialog: true }))\n                                        }\n                                        variant=\"extended\"\n                                        size=\"small\"\n                                        color=\"primary\"\n                                        aria-label=\"add\"\n                                        className={classes.fabBtn}\n                                    >\n                                        <CloudUploadIcon />\n                                        UPLOAD\n                                    </Fab>\n                                </Typography>\n                            )}\n                        </Paper>\n                    </Grid>\n                }\n            </Grid>\n            <DropzoneDialog\n                open={isOpenDialog}\n                onSave={handlevideoFileUrlUpload}\n                acceptedFiles={['video/mp4']}\n                showPreviews={true}\n                filesLimit={3}\n                maxFileSize={200000000}\n                onClose={() => setLocalState((prevState) => ({ ...prevState, isOpenDialog: false }))}\n                submitButtonText={t('str_save')}\n                cancelButtonText={t('str_cancel')}\n                dialogTitle={t('str_uploadAFile')}\n            />\n        </React.Fragment>\n    )\n}\nexport default EditVideo\n"]},"metadata":{},"sourceType":"module"}
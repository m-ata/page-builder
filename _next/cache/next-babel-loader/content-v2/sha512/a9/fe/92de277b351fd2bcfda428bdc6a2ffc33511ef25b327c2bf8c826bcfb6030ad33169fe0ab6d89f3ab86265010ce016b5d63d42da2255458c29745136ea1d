{"ast":null,"code":"import _defineProperty from \"/Users/mata/app-cloudweb/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/components/page/sections/video/AddVideo.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useContext, useState } from 'react';\nimport { Grid, Paper, Typography, Fab } from '@material-ui/core';\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { COLORS } from '../../../../constants';\nimport { DropzoneDialog } from \"material-ui-dropzone\";\nimport { Upload } from \"@webcms/orest\";\nimport { isErrorMsg } from \"../../../../../../../model/orest/constants\";\nimport useTranslation from \"../../../../../../../lib/translations/hooks/useTranslation\";\nimport WebCmsGlobal from \"../../../../../../webcms-global\";\nimport { useRouter } from \"next/router\";\nimport { useSelector } from \"react-redux\";\nimport { toast } from \"react-toastify\";\nimport ReactPlayer from 'react-player';\nimport LoadingSpinner from '../../../../../../LoadingSpinner';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    root: {\n      card: {\n        maxWidth: 345\n      },\n      media: {\n        height: 0,\n        paddingTop: '56.25%'\n      }\n    },\n    submit: {\n      marginRight: theme.spacing(1),\n      marginBottom: theme.spacing(1),\n      borderRadius: 20,\n      marginTop: theme.spacing(1),\n      \"float\": 'right'\n    },\n    fabBtn: {\n      marginBottom: theme.spacing(1),\n      marginLeft: theme.spacing(1)\n    },\n    disableEvent: {\n      pointerEvents: 'none',\n      opacity: 0.5\n    },\n    paperBlock: {\n      height: 245,\n      border: \"2px solid \".concat(COLORS === null || COLORS === void 0 ? void 0 : COLORS.secondary),\n      overflow: 'auto',\n      position: 'relative'\n    },\n    card: {\n      height: 245,\n      width: 392,\n      cursor: 'pointer'\n    },\n    heading: {\n      marginTop: theme.spacing(1),\n      marginLeft: theme.spacing(2),\n      fontWeight: 'bold',\n      fontSize: 15\n    },\n    textField: {\n      paddingRight: theme.spacing(1)\n    },\n    alignText: {\n      textAlign: 'right',\n      color: 'red'\n    },\n    emptyDiv: {\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      height: 245\n    }\n  };\n});\n\nvar AddVideo = function AddVideo(props) {\n  _s();\n\n  var handleSectionComponent = props.handleSectionComponent;\n\n  var _useState = useState({\n    videoFile: null,\n    isOpenDialog: false,\n    isRequestSend: false\n  }),\n      localState = _useState[0],\n      setLocalState = _useState[1];\n\n  var videoFile = localState.videoFile,\n      isOpenDialog = localState.isOpenDialog,\n      isRequestSend = localState.isRequestSend;\n  var classes = useStyles(); //context\n\n  var _useTranslation = useTranslation(),\n      t = _useTranslation.t;\n\n  var _useContext = useContext(WebCmsGlobal),\n      GENERAL_SETTINGS = _useContext.GENERAL_SETTINGS,\n      token = _useContext.token;\n\n  var router = useRouter();\n  var companyId = router.query.companyID;\n  var authToken = token || router.query.authToken;\n  var state = useSelector(function (state) {\n    var _state$formReducer;\n\n    return state === null || state === void 0 ? void 0 : (_state$formReducer = state.formReducer) === null || _state$formReducer === void 0 ? void 0 : _state$formReducer.pageBuilder;\n  });\n\n  var handleVideoFileUpload = function handleVideoFileUpload(file) {\n    setLocalState(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, {\n        isOpenDialog: false,\n        isRequestSend: true\n      });\n    });\n    Upload({\n      apiUrl: GENERAL_SETTINGS.OREST_URL,\n      token: authToken,\n      params: {\n        masterid: state.hotelMid,\n        orsactive: true,\n        hotelrefno: Number(companyId),\n        quality: \"0.1F\"\n      },\n      files: file\n    }).then(function (r) {\n      if (r.status === 200) {\n        var url = r.data.data.url.replace('/var/otello', '').replace('/public', '');\n        setLocalState(function (prevState) {\n          return _objectSpread(_objectSpread({}, prevState), {}, {\n            videoFile: GENERAL_SETTINGS.STATIC_URL + url,\n            isRequestSend: false\n          });\n        });\n        handleSectionComponent({\n          service: \"hcmitemvideo\",\n          type: \"video\",\n          url: url\n        });\n        toast.success(t('str_haveBeenUploadedMsg'), {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      } else {\n        var error = isErrorMsg(r);\n        toast.error(t(error.errMsg), {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      }\n    });\n  };\n\n  if (isRequestSend) {\n    return __jsx(LoadingSpinner, {\n      size: 50,\n      style: {\n        color: COLORS.secondary\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 16\n      }\n    });\n  }\n\n  return __jsx(React.Fragment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 9\n    }\n  }, __jsx(Grid, {\n    container: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 13\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 12,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 21\n    }\n  }, __jsx(Paper, {\n    className: classes.paperBlock,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 21\n    }\n  }, videoFile ? __jsx(ReactPlayer, {\n    url: videoFile,\n    width: \"100%\",\n    height: \"100%\",\n    controls: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 29\n    }\n  }) : __jsx(Typography, {\n    component: 'div',\n    className: classes.emptyDiv,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 29\n    }\n  }, __jsx(Fab, {\n    onClick: function onClick() {\n      return setLocalState(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, {\n          isOpenDialog: true\n        });\n      });\n    },\n    variant: \"extended\",\n    size: \"small\",\n    color: \"primary\",\n    \"aria-label\": \"add\",\n    className: classes.fabBtn,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 33\n    }\n  }, __jsx(CloudUploadIcon, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 37\n    }\n  }), \"UPLOAD\"))))), __jsx(DropzoneDialog, {\n    open: isOpenDialog,\n    onSave: handleVideoFileUpload,\n    acceptedFiles: ['video/mp4'],\n    showPreviews: true,\n    filesLimit: 3,\n    maxFileSize: 200000000,\n    onClose: function onClose() {\n      return setLocalState(function (prevState) {\n        return _objectSpread(_objectSpread({}, prevState), {}, {\n          isOpenDialog: false\n        });\n      });\n    },\n    submitButtonText: t('str_save'),\n    cancelButtonText: t('str_cancel'),\n    dialogTitle: t('str_uploadAFile'),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 13\n    }\n  }));\n};\n\n_s(AddVideo, \"Z3bnUgyaHMx9SeFMoAEMMs+dtA8=\", false, function () {\n  return [useStyles, useTranslation, useRouter, useSelector];\n});\n\n_c = AddVideo;\nexport default AddVideo;\n\nvar _c;\n\n$RefreshReg$(_c, \"AddVideo\");","map":{"version":3,"sources":["/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/components/page/sections/video/AddVideo.js"],"names":["React","useContext","useState","Grid","Paper","Typography","Fab","CloudUploadIcon","makeStyles","COLORS","DropzoneDialog","Upload","isErrorMsg","useTranslation","WebCmsGlobal","useRouter","useSelector","toast","ReactPlayer","LoadingSpinner","useStyles","theme","root","card","maxWidth","media","height","paddingTop","submit","marginRight","spacing","marginBottom","borderRadius","marginTop","fabBtn","marginLeft","disableEvent","pointerEvents","opacity","paperBlock","border","secondary","overflow","position","width","cursor","heading","fontWeight","fontSize","textField","paddingRight","alignText","textAlign","color","emptyDiv","display","alignItems","justifyContent","AddVideo","props","handleSectionComponent","videoFile","isOpenDialog","isRequestSend","localState","setLocalState","classes","t","GENERAL_SETTINGS","token","router","companyId","query","companyID","authToken","state","formReducer","pageBuilder","handleVideoFileUpload","file","prevState","apiUrl","OREST_URL","params","masterid","hotelMid","orsactive","hotelrefno","Number","quality","files","then","r","status","url","data","replace","STATIC_URL","service","type","success","POSITION","TOP_RIGHT","error","errMsg"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from 'react'\nimport { Grid, Paper, Typography, Fab } from '@material-ui/core'\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload'\nimport { makeStyles } from '@material-ui/core/styles'\nimport {COLORS} from '../../../../constants'\nimport {DropzoneDialog} from \"material-ui-dropzone\";\nimport {Upload} from \"@webcms/orest\";\nimport {isErrorMsg} from \"../../../../../../../model/orest/constants\";\nimport useTranslation from \"../../../../../../../lib/translations/hooks/useTranslation\";\nimport WebCmsGlobal from \"../../../../../../webcms-global\";\nimport {useRouter} from \"next/router\";\nimport {useSelector} from \"react-redux\";\nimport {toast} from \"react-toastify\";\nimport ReactPlayer from 'react-player';\nimport LoadingSpinner from '../../../../../../LoadingSpinner'\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        card: {\n            maxWidth: 345,\n        },\n        media: {\n            height: 0,\n            paddingTop: '56.25%',\n        },\n    },\n    submit: {\n        marginRight: theme.spacing(1),\n        marginBottom: theme.spacing(1),\n        borderRadius: 20,\n        marginTop: theme.spacing(1),\n        float: 'right',\n    },\n    fabBtn: {\n        marginBottom: theme.spacing(1),\n        marginLeft: theme.spacing(1),\n    },\n    disableEvent: {\n        pointerEvents: 'none',\n        opacity: 0.5,\n    },\n    paperBlock: {\n        height: 245,\n        border: `2px solid ${COLORS?.secondary}`,\n        overflow: 'auto',\n        position: 'relative',\n    },\n    card: {\n        height: 245,\n        width: 392,\n        cursor: 'pointer',\n    },\n    heading: {\n        marginTop: theme.spacing(1),\n        marginLeft: theme.spacing(2),\n        fontWeight: 'bold',\n        fontSize: 15,\n    },\n    textField: {\n        paddingRight: theme.spacing(1),\n    },\n    alignText: {\n        textAlign: 'right',\n        color: 'red',\n    },\n    emptyDiv: {\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        height: 245\n    },\n}))\n\nconst AddVideo = (props) => {\n    const { handleSectionComponent } = props;\n    const [localState, setLocalState] = useState({\n        videoFile: null,\n        isOpenDialog: false,\n        isRequestSend: false\n    });\n\n    const { videoFile, isOpenDialog, isRequestSend } = localState\n\n    const classes = useStyles();\n    //context\n    const { t } = useTranslation();\n    const { GENERAL_SETTINGS, token } = useContext(WebCmsGlobal);\n    const router = useRouter();\n    const companyId = router.query.companyID;\n    const authToken = token || router.query.authToken;\n    const state = useSelector(state => state?.formReducer?.pageBuilder);\n\n    const handleVideoFileUpload = (file) => {\n        setLocalState(prevState => ({...prevState, isOpenDialog: false, isRequestSend: true}));\n        Upload({\n            apiUrl: GENERAL_SETTINGS.OREST_URL,\n            token: authToken,\n            params: {\n                masterid: state.hotelMid,\n                orsactive: true,\n                hotelrefno: Number(companyId),\n                quality:\"0.1F\"\n            },\n            files: file,\n        }).then((r) => {\n            if (r.status === 200) {\n                let url = r.data.data.url.replace('/var/otello', '').replace('/public', '');\n                setLocalState(prevState => ({...prevState, videoFile: GENERAL_SETTINGS.STATIC_URL + url, isRequestSend: false}));\n                handleSectionComponent({\n                    service: \"hcmitemvideo\",\n                    type: \"video\",\n                    url: url,\n                });\n                toast.success(t('str_haveBeenUploadedMsg'), {\n                    position: toast.POSITION.TOP_RIGHT\n                });\n            } else {\n                const error = isErrorMsg(r);\n                toast.error(t(error.errMsg), {\n                    position: toast.POSITION.TOP_RIGHT\n                });\n            }\n        })\n    }\n\n    if (isRequestSend) {\n        return <LoadingSpinner size={50} style={{color: COLORS.secondary}} />\n    }\n\n    return (\n        <React.Fragment>\n            <Grid container>\n                {\n                    <Grid item xs={12}>\n                    <Paper className={classes.paperBlock}>\n                        {videoFile ? (\n                            <ReactPlayer url={videoFile} width=\"100%\" height=\"100%\" controls={true} />\n                        ) : (\n                            <Typography component={'div'} className={classes.emptyDiv}>\n                                <Fab\n                                    onClick={() => setLocalState(prevState => ({...prevState, isOpenDialog: true}))}\n                                    variant=\"extended\"\n                                    size=\"small\"\n                                    color=\"primary\"\n                                    aria-label=\"add\"\n                                    className={classes.fabBtn}\n                                >\n                                    <CloudUploadIcon />\n                                    UPLOAD\n                                </Fab>\n                            </Typography>\n                        )}\n                    </Paper>\n                </Grid>\n                }\n            </Grid>\n            <DropzoneDialog\n                open={isOpenDialog}\n                onSave={handleVideoFileUpload}\n                acceptedFiles={[\n                    'video/mp4',\n                ]}\n                showPreviews={true}\n                filesLimit={3}\n                maxFileSize={200000000}\n                onClose={() => setLocalState(prevState => ({...prevState, isOpenDialog: false}))}\n                submitButtonText={t('str_save')}\n                cancelButtonText={t('str_cancel')}\n                dialogTitle={t('str_uploadAFile')}\n            />\n        </React.Fragment>\n    )\n}\nexport default AddVideo\n"]},"metadata":{},"sourceType":"module"}
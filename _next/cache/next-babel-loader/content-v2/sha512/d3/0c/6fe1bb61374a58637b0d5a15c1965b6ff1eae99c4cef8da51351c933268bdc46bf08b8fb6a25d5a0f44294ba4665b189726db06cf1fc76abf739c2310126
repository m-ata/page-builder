{"ast":null,"code":"var _jsxFileName = \"/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/components/website/pages/AddPage.js\";\nvar __jsx = React.createElement;\nimport React, { useContext, useEffect, useState } from 'react'; //material imports\n\nimport Paper from \"@material-ui/core/Paper\";\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from \"@material-ui/core/Typography\";\nimport Grid from \"@material-ui/core/Grid\"; //redux imports\n\nimport { connect } from 'react-redux';\nimport { setToState, updateState } from \"../../../../../../state/actions\"; //server related imports\n\nimport { ViewList } from \"@webcms/orest\";\nimport { OREST_ENDPOINT } from \"../../../../../../model/orest/constants\";\nimport WebCmsGlobal from \"../../../../../webcms-global\";\nimport { useRouter } from \"next/router\"; //custom imports\n\nimport { COLORS } from \"../../../constants\";\nimport PageItemList from \"./PageItemList\";\nconst useStyles = makeStyles(theme => ({\n  pageBlock: {\n    border: `2px solid ${COLORS === null || COLORS === void 0 ? void 0 : COLORS.secondary}`,\n    height: 200,\n    width: 200,\n    overflow: 'auto',\n    marginLeft: theme.spacing(1),\n    marginTop: theme.spacing(2),\n    cursor: \"pointer\"\n  },\n  pageContainer: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    height: 500,\n    overflow: 'auto'\n  },\n  codeText: {\n    marginTop: theme.spacing(1),\n    marginLeft: theme.spacing(2)\n  }\n}));\n\nconst AddPage = props => {\n  const {\n    onAddPage\n  } = props;\n  const classes = useStyles();\n  const {\n    0: pages,\n    1: setPages\n  } = useState([]);\n  const {\n    0: selectedIndexes,\n    1: setSelectedIndexes\n  } = useState([]);\n  const {\n    0: selectedPages,\n    1: setSelectedPages\n  } = useState([]);\n  const {\n    GENERAL_SETTINGS,\n    token\n  } = useContext(WebCmsGlobal);\n  const router = useRouter();\n  const companyId = router.query.companyID;\n  const authToken = token || router.query.authToken;\n  useEffect(() => {\n    //getting web page from rafile\n    ViewList({\n      apiUrl: GENERAL_SETTINGS.OREST_URL,\n      endpoint: OREST_ENDPOINT.RAFILE,\n      token: authToken,\n      params: {\n        hotelrefno: Number(companyId),\n        query: `filetype:WEBPAGE`\n      }\n    }).then(res => {\n      if (res.status === 200 && res.data && res.data.data) {\n        setPages(res.data.data);\n      }\n    });\n  }, []);\n  useEffect(() => {\n    onAddPage(selectedPages);\n  }, [selectedPages]);\n\n  const handleSelectedPage = (index, page) => {\n    const updatedIndexes = [...selectedIndexes];\n    const updatedPages = [...selectedPages];\n    const indexExist = selectedIndexes.find(x => x === index);\n\n    if (!indexExist && indexExist !== 0) {\n      updatedIndexes.push(index);\n      updatedPages.push({\n        gid: page === null || page === void 0 ? void 0 : page.gid,\n        code: [page === null || page === void 0 ? void 0 : page.code]\n      });\n    } else {\n      const i = selectedIndexes.indexOf(indexExist);\n      updatedIndexes.splice(i, 1);\n      updatedPages.splice(i, 1);\n    }\n\n    setSelectedIndexes(updatedIndexes);\n    setSelectedPages(updatedPages);\n  };\n\n  return __jsx(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 9\n    }\n  }, __jsx(Grid, {\n    container: true,\n    className: classes.pageContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }\n  }, pages.length > 0 && pages.map((page, index) => {\n    return __jsx(Grid, {\n      item: true,\n      key: index,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 29\n      }\n    }, __jsx(Paper, {\n      className: classes.pageBlock,\n      onClick: () => handleSelectedPage(index, page),\n      style: {\n        border: index === selectedIndexes.find(x => x === index) ? `2px solid red` : `2px solid ${COLORS === null || COLORS === void 0 ? void 0 : COLORS.secondary}`\n      },\n      key: `page-${index}`,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 33\n      }\n    }, __jsx(PageItemList, {\n      pageData: JSON.parse(Buffer.from(page.filedata, 'base64').toString('utf-8')),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 37\n      }\n    })), __jsx(Typography, {\n      component: 'div',\n      className: classes.codeText,\n      style: {\n        color: index === selectedIndexes.find(x => x === index) ? `red` : `${COLORS === null || COLORS === void 0 ? void 0 : COLORS.secondary}`\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 33\n      }\n    }, \" \", page.code, \" \"));\n  })));\n};\n\nconst mapStateToProps = state => {\n  return {\n    state: state.formReducer.pageBuilder\n  };\n};\n\nconst mapDispatchToProps = dispatch => ({\n  setToState: (stateType, stateName, value) => dispatch(setToState(stateType, stateName, value)),\n  updateState: (stateType, stateName, value) => dispatch(updateState(stateType, stateName, value))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AddPage);","map":{"version":3,"sources":["/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/components/website/pages/AddPage.js"],"names":["React","useContext","useEffect","useState","Paper","makeStyles","Typography","Grid","connect","setToState","updateState","ViewList","OREST_ENDPOINT","WebCmsGlobal","useRouter","COLORS","PageItemList","useStyles","theme","pageBlock","border","secondary","height","width","overflow","marginLeft","spacing","marginTop","cursor","pageContainer","display","flexWrap","codeText","AddPage","props","onAddPage","classes","pages","setPages","selectedIndexes","setSelectedIndexes","selectedPages","setSelectedPages","GENERAL_SETTINGS","token","router","companyId","query","companyID","authToken","apiUrl","OREST_URL","endpoint","RAFILE","params","hotelrefno","Number","then","res","status","data","handleSelectedPage","index","page","updatedIndexes","updatedPages","indexExist","find","x","push","gid","code","i","indexOf","splice","length","map","JSON","parse","Buffer","from","filedata","toString","color","mapStateToProps","state","formReducer","pageBuilder","mapDispatchToProps","dispatch","stateType","stateName","value"],"mappings":"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","sourcesContent":["import React, {useContext, useEffect, useState} from 'react';\n//material imports\nimport Paper from \"@material-ui/core/Paper\";\nimport { makeStyles } from '@material-ui/core/styles'\nimport Typography from \"@material-ui/core/Typography\";\nimport Grid from \"@material-ui/core/Grid\";\n//redux imports\nimport { connect } from 'react-redux';\nimport {setToState, updateState} from \"../../../../../../state/actions\";\n//server related imports\nimport { ViewList} from \"@webcms/orest\";\nimport {OREST_ENDPOINT} from \"../../../../../../model/orest/constants\";\nimport WebCmsGlobal from \"../../../../../webcms-global\";\nimport {useRouter} from \"next/router\";\n//custom imports\nimport {COLORS} from \"../../../constants\";\nimport PageItemList from \"./PageItemList\";\n\nconst useStyles = makeStyles(theme => ({\n\n    pageBlock: {\n        border: `2px solid ${COLORS?.secondary}`,\n        height: 200,\n        width: 200,\n        overflow: 'auto',\n        marginLeft: theme.spacing(1),\n        marginTop: theme.spacing(2),\n        cursor: \"pointer\",\n    },\n    pageContainer: {\n        display: 'flex',\n        flexWrap: 'wrap',\n        height: 500,\n        overflow: 'auto',\n    },\n    codeText: {\n        marginTop: theme.spacing(1),\n        marginLeft: theme.spacing(2),\n    }\n\n}));\n\nconst AddPage = (props) => {\n\n    const {\n        onAddPage,\n    } = props;\n\n    const classes = useStyles();\n\n    const [pages, setPages] = useState([]);\n    const [selectedIndexes, setSelectedIndexes] = useState([]);\n    const [selectedPages, setSelectedPages] = useState([]);\n\n    const {GENERAL_SETTINGS, token} = useContext(WebCmsGlobal);\n    const router = useRouter();\n    const companyId = router.query.companyID;\n    const authToken = token || router.query.authToken;\n\n    useEffect(() => {\n        //getting web page from rafile\n        ViewList({\n            apiUrl: GENERAL_SETTINGS.OREST_URL,\n            endpoint: OREST_ENDPOINT.RAFILE,\n            token: authToken,\n            params: {\n                hotelrefno: Number(companyId),\n                query: `filetype:WEBPAGE`,\n            }\n        }).then(res => {\n            if (res.status === 200 && res.data && res.data.data) {\n                setPages(res.data.data);\n            }\n        })\n    }, []);\n\n    useEffect(() => {\n        onAddPage(selectedPages);\n    }, [selectedPages]);\n\n    const handleSelectedPage = (index, page) => {\n        const updatedIndexes = [...selectedIndexes];\n        const updatedPages = [...selectedPages];\n        const indexExist = selectedIndexes.find(x => x=== index);\n        if (!indexExist && indexExist !==0) {\n            updatedIndexes.push(index);\n            updatedPages.push({\n                gid: page?.gid,\n                code: [page?.code]\n            });\n        } else {\n            const i = selectedIndexes.indexOf(indexExist);\n            updatedIndexes.splice(i, 1);\n            updatedPages.splice(i, 1);\n        }\n        setSelectedIndexes(updatedIndexes);\n        setSelectedPages(updatedPages);\n    }\n\n    return (\n        <React.Fragment>\n            <Grid container={true} className={classes.pageContainer}>\n                {\n                    pages.length > 0 && pages.map((page, index) => {\n                        return (\n                            <Grid item key={index}>\n                                <Paper\n                                    className={classes.pageBlock}\n                                    onClick={() => handleSelectedPage(index, page)}\n                                    style={{\n                                        border: index === selectedIndexes.find(x => x=== index) ? `2px solid red` :\n                                            `2px solid ${COLORS?.secondary}`\n                                    }}\n                                    key={`page-${index}`}\n                                >\n                                    <PageItemList\n                                        pageData={JSON.parse(Buffer.from(page.filedata, 'base64').toString('utf-8'))}\n                                    />\n                                </Paper>\n                                <Typography\n                                    component={'div'}\n                                    className={classes.codeText}\n                                    style={{\n                                        color: index === selectedIndexes.find(x => x=== index) ? `red` :\n                                            `${COLORS?.secondary}`\n                                    }}\n                                > {page.code} </Typography>\n                            </Grid>\n                        )\n                    })\n                }\n            </Grid>\n        </React.Fragment>\n    )\n}\n\nconst mapStateToProps = state => {\n    return {\n        state: state.formReducer.pageBuilder\n    }\n};\n\nconst mapDispatchToProps = dispatch => ({\n    setToState: (stateType, stateName, value) => dispatch(setToState(stateType, stateName, value)),\n    updateState: (stateType, stateName, value) => dispatch(updateState(stateType, stateName, value)),\n});\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(AddPage)\n"]},"metadata":{},"sourceType":"module"}
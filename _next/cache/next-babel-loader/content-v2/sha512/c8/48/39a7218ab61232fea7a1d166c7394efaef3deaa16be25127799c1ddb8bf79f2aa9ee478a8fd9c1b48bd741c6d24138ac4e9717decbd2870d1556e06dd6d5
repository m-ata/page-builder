{"ast":null,"code":"import _defineProperty from \"/Users/mata/app-cloudweb/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/components/page/sections/image/Image.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useContext, useEffect, useState } from 'react';\nimport { ViewList } from \"@webcms/orest\";\nimport WebCmsGlobal from \"components/webcms-global\";\nimport { useRouter } from \"next/router\";\nimport { OREST_ENDPOINT } from \"../../../../../../../model/orest/constants\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { connect, useSelector } from \"react-redux\";\nimport LoadingSpinner from \"../../../../../../LoadingSpinner\";\nimport ThumbnailSliderModal from \"../../../../../../website/pages/SliderModal\";\nimport clsx from 'clsx';\nimport { COLORS } from '../../../../constants';\nvar useStyles = makeStyles(function () {\n  return {\n    box: {\n      position: \"relative\",\n      textAlign: \"center\",\n      color: \"white\"\n    },\n    text: {\n      position: \"absolute\",\n      top: '50%',\n      left: '50%',\n      transform: 'translate(-50%, -50%)',\n      zIndex: 999,\n      height: '100%',\n      width: '100%'\n    },\n    textColor: {\n      color: function color(props) {\n        var _props$imageComponent;\n\n        return props !== null && props !== void 0 && (_props$imageComponent = props.imageComponent) !== null && _props$imageComponent !== void 0 && _props$imageComponent.textColor ? props.imageComponent.textColor : \"#000000\";\n      }\n    },\n    image: {\n      width: '100%',\n      backgroundSize: \"cover\",\n      borderRadius: 5,\n      height: function height(props) {\n        if (props.sectionType === 'threecol') return 200;\n        if (props.sectionType === 'twocol') return 250;\n        if (props.sectionType === 'fullcol') return 'auto';\n      }\n    },\n    cursorPointer: {\n      cursor: \"pointer\"\n    }\n  };\n});\n\nvar Image = function Image(props) {\n  _s();\n\n  var _clsx;\n\n  var imageComponent = props.imageComponent,\n      otherLangsImage = props.otherLangsImage,\n      state = props.state,\n      sectionType = props.sectionType,\n      sectionImages = props.sectionImages;\n\n  var _useContext = useContext(WebCmsGlobal),\n      GENERAL_SETTINGS = _useContext.GENERAL_SETTINGS,\n      token = _useContext.token;\n\n  var router = useRouter();\n  var clientToken = useSelector(function (state) {\n    return state.orest.currentUser !== null ? state.orest.currentUser.auth.access_token : router.query.authToken;\n  });\n  var companyId = router.query.companyID || GENERAL_SETTINGS.HOTELREFNO;\n  var classes = useStyles(props);\n  var authToken = token || clientToken || router.query.authToken;\n\n  var _useState = useState(false),\n      isOpenSlider = _useState[0],\n      setIsOpenSlider = _useState[1];\n\n  var _useState2 = useState({}),\n      image = _useState2[0],\n      setImage = _useState2[1];\n\n  var _useState3 = useState(''),\n      title = _useState3[0],\n      setTitle = _useState3[1];\n\n  var _useState4 = useState(''),\n      description = _useState4[0],\n      setDescription = _useState4[1];\n\n  var _useState5 = useState(''),\n      cta = _useState5[0],\n      setCta = _useState5[1];\n\n  var _useState6 = useState(false),\n      isRequestSend = _useState6[0],\n      setRequestSend = _useState6[1];\n\n  var _useState7 = useState(sectionImages),\n      sliderImages = _useState7[0],\n      setSliderImages = _useState7[1];\n\n  useEffect(function () {\n    if (imageComponent && imageComponent.gid) {\n      setRequestSend(true);\n      ViewList({\n        apiUrl: GENERAL_SETTINGS.OREST_URL,\n        endpoint: OREST_ENDPOINT.HCMITEMIMG,\n        token: authToken,\n        params: {\n          query: \"gid:\".concat(imageComponent.gid),\n          sort: 'orderno',\n          hotelrefno: Number(companyId)\n        }\n      }).then(function (res) {\n        var _res$data, _res$data$data;\n\n        setRequestSend(false);\n\n        if (res.status === 200 && (res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : (_res$data$data = _res$data.data) === null || _res$data$data === void 0 ? void 0 : _res$data$data.length) > 0) {\n          setImage(res.data.data[0]);\n\n          if (state.langCode !== state.defaultLang && otherLangsImage) {\n            var _res$data$data$;\n\n            setTitle(otherLangsImage === null || otherLangsImage === void 0 ? void 0 : otherLangsImage.title);\n            setDescription(otherLangsImage === null || otherLangsImage === void 0 ? void 0 : otherLangsImage.description);\n            setCta((_res$data$data$ = res.data.data[0]) === null || _res$data$data$ === void 0 ? void 0 : _res$data$data$.cta);\n          } else {\n            var _res$data$data$2, _res$data$data$3, _res$data$data$4;\n\n            setTitle((_res$data$data$2 = res.data.data[0]) === null || _res$data$data$2 === void 0 ? void 0 : _res$data$data$2.title);\n            setDescription((_res$data$data$3 = res.data.data[0]) === null || _res$data$data$3 === void 0 ? void 0 : _res$data$data$3.description);\n            setCta((_res$data$data$4 = res.data.data[0]) === null || _res$data$data$4 === void 0 ? void 0 : _res$data$data$4.cta);\n          }\n        } else {\n          console.log(res);\n        }\n      });\n    }\n  }, [imageComponent, otherLangsImage]);\n  useEffect(function () {\n    if (sectionImages !== null && sectionImages !== void 0 && sectionImages.length) {\n      var gid = sectionImages.map(function (s) {\n        return s.gid;\n      });\n      var updatedSliderImages = [];\n      gid.map(function (g) {\n        ViewList({\n          apiUrl: GENERAL_SETTINGS.OREST_URL,\n          endpoint: OREST_ENDPOINT.HCMITEMIMG,\n          token: authToken,\n          params: {\n            query: \"gid:\".concat(g),\n            sort: 'orderno',\n            hotelrefno: Number(companyId)\n          }\n        }).then(function (res) {\n          if (res.status === 200) {\n            var _res$data2, _res$data2$data;\n\n            if (res !== null && res !== void 0 && (_res$data2 = res.data) !== null && _res$data2 !== void 0 && (_res$data2$data = _res$data2.data) !== null && _res$data2$data !== void 0 && _res$data2$data.length) {\n              updatedSliderImages.push(res.data.data[0]);\n              setSliderImages(updatedSliderImages);\n            }\n          }\n        });\n      });\n    }\n  }, [sectionImages]);\n\n  if (isRequestSend) {\n    return __jsx(LoadingSpinner, {\n      size: 40,\n      style: {\n        color: COLORS.secondary\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 16\n      }\n    });\n  }\n\n  return __jsx(React.Fragment, null, image && __jsx(\"div\", {\n    onClick: function onClick() {\n      if (sliderImages !== null && sliderImages !== void 0 && sliderImages.length) {\n        setIsOpenSlider(true);\n      }\n    },\n    className: clsx((_clsx = {}, _defineProperty(_clsx, classes.box, true), _defineProperty(_clsx, classes.cursorPointer, sliderImages === null || sliderImages === void 0 ? void 0 : sliderImages.length), _clsx)),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 17\n    }\n  }, cta ? __jsx(\"a\", {\n    href: cta,\n    target: '_blank',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 31\n    }\n  }, __jsx(\"img\", {\n    alt: 'img',\n    className: classes.image,\n    src: GENERAL_SETTINGS.STATIC_URL + (image === null || image === void 0 ? void 0 : image.fileurl),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 29\n    }\n  })) : __jsx(\"img\", {\n    alt: 'img',\n    className: classes.image,\n    src: GENERAL_SETTINGS.STATIC_URL + (image === null || image === void 0 ? void 0 : image.fileurl),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 32\n    }\n  }), __jsx(\"div\", {\n    className: classes.text,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 21\n    }\n  }, title && __jsx(\"div\", {\n    className: classes.textColor,\n    dangerouslySetInnerHTML: {\n      __html: title\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 36\n    }\n  }), description && __jsx(\"div\", {\n    className: classes.textColor,\n    dangerouslySetInnerHTML: {\n      __html: description\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 42\n    }\n  }))), __jsx(ThumbnailSliderModal, {\n    open: isOpenSlider,\n    sliderTitle: (image === null || image === void 0 ? void 0 : image.title) || 'Image',\n    sliderDesc: image === null || image === void 0 ? void 0 : image.description,\n    onClose: function onClose(e) {\n      return setIsOpenSlider(e);\n    },\n    sliderImages: sliderImages,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 13\n    }\n  }));\n};\n\n_s(Image, \"UEFPxbnQjuGgl0jQPzRxFY5YJF0=\", false, function () {\n  return [useRouter, useSelector, useStyles];\n});\n\n_c = Image;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    state: state.formReducer.pageBuilder\n  };\n};\n\nexport default connect(mapStateToProps)(Image);\n\nvar _c;\n\n$RefreshReg$(_c, \"Image\");","map":{"version":3,"sources":["/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/components/page/sections/image/Image.js"],"names":["React","useContext","useEffect","useState","ViewList","WebCmsGlobal","useRouter","OREST_ENDPOINT","makeStyles","connect","useSelector","LoadingSpinner","ThumbnailSliderModal","clsx","COLORS","useStyles","box","position","textAlign","color","text","top","left","transform","zIndex","height","width","textColor","props","imageComponent","image","backgroundSize","borderRadius","sectionType","cursorPointer","cursor","Image","otherLangsImage","state","sectionImages","GENERAL_SETTINGS","token","router","clientToken","orest","currentUser","auth","access_token","query","authToken","companyId","companyID","HOTELREFNO","classes","isOpenSlider","setIsOpenSlider","setImage","title","setTitle","description","setDescription","cta","setCta","isRequestSend","setRequestSend","sliderImages","setSliderImages","gid","apiUrl","OREST_URL","endpoint","HCMITEMIMG","params","sort","hotelrefno","Number","then","res","status","data","length","langCode","defaultLang","console","log","map","s","updatedSliderImages","g","push","secondary","STATIC_URL","fileurl","__html","e","mapStateToProps","formReducer","pageBuilder"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAeC,UAAf,EAA2BC,SAA3B,EAAsCC,QAAtC,QAAqD,OAArD;AACA,SAAQC,QAAR,QAAuB,eAAvB;AACA,OAAOC,YAAP,MAAyB,0BAAzB;AACA,SAAQC,SAAR,QAAwB,aAAxB;AACA,SAAQC,cAAR,QAA6B,4CAA7B;AACA,SAAQC,UAAR,QAAyB,0BAAzB;AACA,SAAQC,OAAR,EAAiBC,WAAjB,QAAmC,aAAnC;AACA,OAAOC,cAAP,MAA2B,kCAA3B;AACA,OAAOC,oBAAP,MAAiC,6CAAjC;AACA,OAAOC,IAAP,MAAiB,MAAjB;AACA,SAASC,MAAT,QAAuB,uBAAvB;AAEA,IAAMC,SAAS,GAAGP,UAAU,CAAC;AAAA,SAAO;AAChCQ,IAAAA,GAAG,EAAE;AACDC,MAAAA,QAAQ,EAAE,UADT;AAEDC,MAAAA,SAAS,EAAE,QAFV;AAGDC,MAAAA,KAAK,EAAE;AAHN,KAD2B;AAMhCC,IAAAA,IAAI,EAAE;AACFH,MAAAA,QAAQ,EAAE,UADR;AAEFI,MAAAA,GAAG,EAAE,KAFH;AAGFC,MAAAA,IAAI,EAAE,KAHJ;AAIFC,MAAAA,SAAS,EAAE,uBAJT;AAKFC,MAAAA,MAAM,EAAE,GALN;AAMFC,MAAAA,MAAM,EAAE,MANN;AAOFC,MAAAA,KAAK,EAAE;AAPL,KAN0B;AAehCC,IAAAA,SAAS,EAAE;AACPR,MAAAA,KAAK,EAAE,eAAAS,KAAK;AAAA;;AAAA,eAAIA,KAAK,SAAL,IAAAA,KAAK,WAAL,6BAAAA,KAAK,CAAEC,cAAP,wEAAuBF,SAAvB,GAAmCC,KAAK,CAACC,cAAN,CAAqBF,SAAxD,GAAoE,SAAxE;AAAA;AADL,KAfqB;AAkBhCG,IAAAA,KAAK,EAAE;AACHJ,MAAAA,KAAK,EAAE,MADJ;AAEHK,MAAAA,cAAc,EAAE,OAFb;AAGHC,MAAAA,YAAY,EAAE,CAHX;AAIHP,MAAAA,MAAM,EAAE,gBAAAG,KAAK,EAAI;AACb,YAAIA,KAAK,CAACK,WAAN,KAAsB,UAA1B,EACI,OAAQ,GAAR;AACJ,YAAIL,KAAK,CAACK,WAAN,KAAsB,QAA1B,EACI,OAAO,GAAP;AACJ,YAAIL,KAAK,CAACK,WAAN,KAAsB,SAA1B,EACI,OAAO,MAAP;AACP;AAXE,KAlByB;AA+BhCC,IAAAA,aAAa,EAAE;AACXC,MAAAA,MAAM,EAAE;AADG;AA/BiB,GAAP;AAAA,CAAD,CAA5B;;AAoCA,IAAMC,KAAK,GAAG,SAARA,KAAQ,CAACR,KAAD,EAAW;AAAA;;AAAA;;AAAA,MAGjBC,cAHiB,GAQjBD,KARiB,CAGjBC,cAHiB;AAAA,MAIjBQ,eAJiB,GAQjBT,KARiB,CAIjBS,eAJiB;AAAA,MAKjBC,KALiB,GAQjBV,KARiB,CAKjBU,KALiB;AAAA,MAMjBL,WANiB,GAQjBL,KARiB,CAMjBK,WANiB;AAAA,MAOjBM,aAPiB,GAQjBX,KARiB,CAOjBW,aAPiB;;AAAA,oBAUatC,UAAU,CAACI,YAAD,CAVvB;AAAA,MAUdmC,gBAVc,eAUdA,gBAVc;AAAA,MAUIC,KAVJ,eAUIA,KAVJ;;AAWrB,MAAMC,MAAM,GAAGpC,SAAS,EAAxB;AACA,MAAMqC,WAAW,GAAGjC,WAAW,CAAC,UAAC4B,KAAD;AAAA,WAAWA,KAAK,CAACM,KAAN,CAAYC,WAAZ,KAA4B,IAA5B,GAAmCP,KAAK,CAACM,KAAN,CAAYC,WAAZ,CAAwBC,IAAxB,CAA6BC,YAAhE,GAA+EL,MAAM,CAACM,KAAP,CAAaC,SAAvG;AAAA,GAAD,CAA/B;AACA,MAAMC,SAAS,GAAGR,MAAM,CAACM,KAAP,CAAaG,SAAb,IAA0BX,gBAAgB,CAACY,UAA7D;AACA,MAAMC,OAAO,GAAGtC,SAAS,CAACa,KAAD,CAAzB;AACA,MAAMqB,SAAS,GAAGR,KAAK,IAAIE,WAAT,IAAwBD,MAAM,CAACM,KAAP,CAAaC,SAAvD;;AAfqB,kBAgBqB9C,QAAQ,CAAC,KAAD,CAhB7B;AAAA,MAgBbmD,YAhBa;AAAA,MAgBCC,eAhBD;;AAAA,mBAkBKpD,QAAQ,CAAC,EAAD,CAlBb;AAAA,MAkBd2B,KAlBc;AAAA,MAkBP0B,QAlBO;;AAAA,mBAmBKrD,QAAQ,CAAC,EAAD,CAnBb;AAAA,MAmBdsD,KAnBc;AAAA,MAmBPC,QAnBO;;AAAA,mBAoBiBvD,QAAQ,CAAC,EAAD,CApBzB;AAAA,MAoBdwD,WApBc;AAAA,MAoBDC,cApBC;;AAAA,mBAqBCzD,QAAQ,CAAC,EAAD,CArBT;AAAA,MAqBd0D,GArBc;AAAA,MAqBTC,MArBS;;AAAA,mBAsBmB3D,QAAQ,CAAC,KAAD,CAtB3B;AAAA,MAsBd4D,aAtBc;AAAA,MAsBCC,cAtBD;;AAAA,mBAuBmB7D,QAAQ,CAACoC,aAAD,CAvB3B;AAAA,MAuBd0B,YAvBc;AAAA,MAuBAC,eAvBA;;AAyBrBhE,EAAAA,SAAS,CAAC,YAAM;AACZ,QAAG2B,cAAc,IAAIA,cAAc,CAACsC,GAApC,EAAyC;AACrCH,MAAAA,cAAc,CAAC,IAAD,CAAd;AACA5D,MAAAA,QAAQ,CAAC;AACLgE,QAAAA,MAAM,EAAE5B,gBAAgB,CAAC6B,SADpB;AAELC,QAAAA,QAAQ,EAAE/D,cAAc,CAACgE,UAFpB;AAGL9B,QAAAA,KAAK,EAAEQ,SAHF;AAILuB,QAAAA,MAAM,EAAE;AACJxB,UAAAA,KAAK,gBAASnB,cAAc,CAACsC,GAAxB,CADD;AAEJM,UAAAA,IAAI,EAAE,SAFF;AAGJC,UAAAA,UAAU,EAAGC,MAAM,CAACzB,SAAD;AAHf;AAJH,OAAD,CAAR,CASG0B,IATH,CASQ,UAAAC,GAAG,EAAI;AAAA;;AACXb,QAAAA,cAAc,CAAC,KAAD,CAAd;;AACA,YAAIa,GAAG,CAACC,MAAJ,KAAe,GAAf,IAAsB,CAAAD,GAAG,SAAH,IAAAA,GAAG,WAAH,yBAAAA,GAAG,CAAEE,IAAL,0EAAWA,IAAX,kEAAiBC,MAAjB,IAA0B,CAApD,EAAuD;AACnDxB,UAAAA,QAAQ,CAACqB,GAAG,CAACE,IAAJ,CAASA,IAAT,CAAc,CAAd,CAAD,CAAR;;AACA,cAAIzC,KAAK,CAAC2C,QAAN,KAAmB3C,KAAK,CAAC4C,WAAzB,IAAwC7C,eAA5C,EAA6D;AAAA;;AACzDqB,YAAAA,QAAQ,CAACrB,eAAD,aAACA,eAAD,uBAACA,eAAe,CAAEoB,KAAlB,CAAR;AACAG,YAAAA,cAAc,CAACvB,eAAD,aAACA,eAAD,uBAACA,eAAe,CAAEsB,WAAlB,CAAd;AACAG,YAAAA,MAAM,oBAACe,GAAG,CAACE,IAAJ,CAASA,IAAT,CAAc,CAAd,CAAD,oDAAC,gBAAkBlB,GAAnB,CAAN;AACH,WAJD,MAIO;AAAA;;AACHH,YAAAA,QAAQ,qBAACmB,GAAG,CAACE,IAAJ,CAASA,IAAT,CAAc,CAAd,CAAD,qDAAC,iBAAkBtB,KAAnB,CAAR;AACAG,YAAAA,cAAc,qBAACiB,GAAG,CAACE,IAAJ,CAASA,IAAT,CAAc,CAAd,CAAD,qDAAC,iBAAkBpB,WAAnB,CAAd;AACAG,YAAAA,MAAM,qBAACe,GAAG,CAACE,IAAJ,CAASA,IAAT,CAAc,CAAd,CAAD,qDAAC,iBAAkBlB,GAAnB,CAAN;AACH;AACJ,SAXD,MAWO;AACHsB,UAAAA,OAAO,CAACC,GAAR,CAAYP,GAAZ;AACH;AACJ,OAzBD;AA0BH;AACJ,GA9BQ,EA8BN,CAAChD,cAAD,EAAiBQ,eAAjB,CA9BM,CAAT;AAgCAnC,EAAAA,SAAS,CAAC,YAAM;AACZ,QAAIqC,aAAJ,aAAIA,aAAJ,eAAIA,aAAa,CAAEyC,MAAnB,EAA2B;AACvB,UAAMb,GAAG,GAAG5B,aAAa,CAAC8C,GAAd,CAAkB,UAAAC,CAAC;AAAA,eAAIA,CAAC,CAACnB,GAAN;AAAA,OAAnB,CAAZ;AACA,UAAIoB,mBAAmB,GAAG,EAA1B;AACApB,MAAAA,GAAG,CAACkB,GAAJ,CAAQ,UAAAG,CAAC,EAAI;AACTpF,QAAAA,QAAQ,CAAC;AACLgE,UAAAA,MAAM,EAAE5B,gBAAgB,CAAC6B,SADpB;AAELC,UAAAA,QAAQ,EAAE/D,cAAc,CAACgE,UAFpB;AAGL9B,UAAAA,KAAK,EAAEQ,SAHF;AAILuB,UAAAA,MAAM,EAAE;AACJxB,YAAAA,KAAK,gBAASwC,CAAT,CADD;AAEJf,YAAAA,IAAI,EAAE,SAFF;AAGJC,YAAAA,UAAU,EAAGC,MAAM,CAACzB,SAAD;AAHf;AAJH,SAAD,CAAR,CASG0B,IATH,CASQ,UAAAC,GAAG,EAAI;AACX,cAAIA,GAAG,CAACC,MAAJ,KAAe,GAAnB,EAAwB;AAAA;;AACpB,gBAAID,GAAJ,aAAIA,GAAJ,6BAAIA,GAAG,CAAEE,IAAT,0DAAI,WAAWA,IAAf,4CAAI,gBAAiBC,MAArB,EAA6B;AACzBO,cAAAA,mBAAmB,CAACE,IAApB,CAAyBZ,GAAG,CAACE,IAAJ,CAASA,IAAT,CAAc,CAAd,CAAzB;AACAb,cAAAA,eAAe,CAACqB,mBAAD,CAAf;AACH;AACJ;AACJ,SAhBD;AAiBH,OAlBD;AAmBH;AACJ,GAxBQ,EAwBN,CAAChD,aAAD,CAxBM,CAAT;;AA0BA,MAAIwB,aAAJ,EAAmB;AACf,WAAO,MAAC,cAAD;AAAgB,MAAA,IAAI,EAAE,EAAtB;AAA0B,MAAA,KAAK,EAAE;AAAC5C,QAAAA,KAAK,EAAEL,MAAM,CAAC4E;AAAf,OAAjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAP;AACH;;AAED,SACI,4BAEQ5D,KAAK,IACL;AAAK,IAAA,OAAO,EAAE,mBAAK;AACf,UAAImC,YAAJ,aAAIA,YAAJ,eAAIA,YAAY,CAAEe,MAAlB,EAA0B;AACtBzB,QAAAA,eAAe,CAAC,IAAD,CAAf;AACH;AACJ,KAJD;AAIG,IAAA,SAAS,EAAE1C,IAAI,qCACbwC,OAAO,CAACrC,GADK,EACC,IADD,0BAEbqC,OAAO,CAACnB,aAFK,EAEW+B,YAFX,aAEWA,YAFX,uBAEWA,YAAY,CAAEe,MAFzB,UAJlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KASQnB,GAAG,GAAG;AAAG,IAAA,IAAI,EAAEA,GAAT;AAAc,IAAA,MAAM,EAAE,QAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACF;AAAK,IAAA,GAAG,EAAE,KAAV;AAAiB,IAAA,SAAS,EAAER,OAAO,CAACvB,KAApC;AAA2C,IAAA,GAAG,EAAEU,gBAAgB,CAACmD,UAAjB,IAA8B7D,KAA9B,aAA8BA,KAA9B,uBAA8BA,KAAK,CAAE8D,OAArC,CAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADE,CAAH,GAEI;AAAK,IAAA,GAAG,EAAE,KAAV;AAAiB,IAAA,SAAS,EAAEvC,OAAO,CAACvB,KAApC;AAA2C,IAAA,GAAG,EAAEU,gBAAgB,CAACmD,UAAjB,IAA8B7D,KAA9B,aAA8BA,KAA9B,uBAA8BA,KAAK,CAAE8D,OAArC,CAAhD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAXf,EAaI;AAAK,IAAA,SAAS,EAAEvC,OAAO,CAACjC,IAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACMqC,KAAK,IAAI;AAAK,IAAA,SAAS,EAAEJ,OAAO,CAAC1B,SAAxB;AAAmC,IAAA,uBAAuB,EAAE;AAACkE,MAAAA,MAAM,EAAEpC;AAAT,KAA5D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADf,EAEME,WAAW,IAAI;AAAK,IAAA,SAAS,EAAEN,OAAO,CAAC1B,SAAxB;AAAmC,IAAA,uBAAuB,EAAE;AAACkE,MAAAA,MAAM,EAAElC;AAAT,KAA5D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFrB,CAbJ,CAHR,EAsBI,MAAC,oBAAD;AAAsB,IAAA,IAAI,EAAEL,YAA5B;AAA0C,IAAA,WAAW,EAAE,CAAAxB,KAAK,SAAL,IAAAA,KAAK,WAAL,YAAAA,KAAK,CAAE2B,KAAP,KAAgB,OAAvE;AAAgF,IAAA,UAAU,EAAE3B,KAAF,aAAEA,KAAF,uBAAEA,KAAK,CAAE6B,WAAnG;AAAgH,IAAA,OAAO,EAAE,iBAACmC,CAAD;AAAA,aAAMvC,eAAe,CAACuC,CAAD,CAArB;AAAA,KAAzH;AAAmJ,IAAA,YAAY,EAAE7B,YAAjK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAtBJ,CADJ;AA0BH,CAjHD;;GAAM7B,K;UAWa9B,S,EACKI,W,EAEJK,S;;;KAddqB,K;;AAmHN,IAAM2D,eAAe,GAAG,SAAlBA,eAAkB,CAAAzD,KAAK,EAAI;AAC7B,SAAO;AACHA,IAAAA,KAAK,EAAEA,KAAK,CAAC0D,WAAN,CAAkBC;AADtB,GAAP;AAGH,CAJD;;AAMA,eAAexF,OAAO,CAClBsF,eADkB,CAAP,CAEb3D,KAFa,CAAf","sourcesContent":["import React, {useContext, useEffect, useState} from 'react';\nimport {ViewList} from \"@webcms/orest\";\nimport WebCmsGlobal from \"components/webcms-global\";\nimport {useRouter} from \"next/router\";\nimport {OREST_ENDPOINT} from \"../../../../../../../model/orest/constants\";\nimport {makeStyles} from \"@material-ui/core/styles\";\nimport {connect, useSelector} from \"react-redux\";\nimport LoadingSpinner from \"../../../../../../LoadingSpinner\";\nimport ThumbnailSliderModal from \"../../../../../../website/pages/SliderModal\";\nimport clsx from 'clsx'\nimport { COLORS } from '../../../../constants';\n\nconst useStyles = makeStyles(() => ({\n    box: {\n        position: \"relative\",\n        textAlign: \"center\",\n        color: \"white\",\n    },\n    text: {\n        position: \"absolute\",\n        top: '50%',\n        left: '50%',\n        transform: 'translate(-50%, -50%)',\n        zIndex: 999,\n        height: '100%',\n        width: '100%'\n    },\n    textColor: {\n        color: props => props?.imageComponent?.textColor ? props.imageComponent.textColor : \"#000000\"\n    },\n    image: {\n        width: '100%',\n        backgroundSize: \"cover\",\n        borderRadius: 5,\n        height: props => {\n            if (props.sectionType === 'threecol')\n                return  200\n            if (props.sectionType === 'twocol')\n                return 250\n            if (props.sectionType === 'fullcol')\n                return 'auto'\n        }\n    },\n    cursorPointer: {\n        cursor: \"pointer\"\n    }\n}))\n\nconst Image = (props) => {\n\n    const {\n        imageComponent,\n        otherLangsImage,\n        state,\n        sectionType,\n        sectionImages\n    } = props;\n\n    const {GENERAL_SETTINGS, token} = useContext(WebCmsGlobal);\n    const router = useRouter();\n    const clientToken = useSelector((state) => state.orest.currentUser !== null ? state.orest.currentUser.auth.access_token : router.query.authToken)\n    const companyId = router.query.companyID || GENERAL_SETTINGS.HOTELREFNO;\n    const classes = useStyles(props);\n    const authToken = token || clientToken || router.query.authToken;\n    const [ isOpenSlider, setIsOpenSlider ] = useState(false)\n\n    const [image, setImage] = useState({});\n    const [title, setTitle] = useState('');\n    const [description, setDescription] = useState('');\n    const [cta, setCta] = useState('');\n    const [isRequestSend, setRequestSend] = useState(false);\n    const [sliderImages, setSliderImages] = useState(sectionImages);\n\n    useEffect(() => {\n        if(imageComponent && imageComponent.gid) {\n            setRequestSend(true);\n            ViewList({\n                apiUrl: GENERAL_SETTINGS.OREST_URL,\n                endpoint: OREST_ENDPOINT.HCMITEMIMG,\n                token: authToken,\n                params: {\n                    query: `gid:${imageComponent.gid}`,\n                    sort: 'orderno',\n                    hotelrefno:  Number(companyId)\n                }\n            }).then(res => {\n                setRequestSend(false);\n                if (res.status === 200 && res?.data?.data?.length > 0) {\n                    setImage(res.data.data[0]);\n                    if (state.langCode !== state.defaultLang && otherLangsImage) {\n                        setTitle(otherLangsImage?.title);\n                        setDescription(otherLangsImage?.description);\n                        setCta(res.data.data[0]?.cta);\n                    } else {\n                        setTitle(res.data.data[0]?.title);\n                        setDescription(res.data.data[0]?.description);\n                        setCta(res.data.data[0]?.cta);\n                    }\n                } else {\n                    console.log(res);\n                }\n            });\n        }\n    }, [imageComponent, otherLangsImage]);\n\n    useEffect(() => {\n        if (sectionImages?.length) {\n            const gid = sectionImages.map(s => s.gid);\n            let updatedSliderImages = [];\n            gid.map(g => {\n                ViewList({\n                    apiUrl: GENERAL_SETTINGS.OREST_URL,\n                    endpoint: OREST_ENDPOINT.HCMITEMIMG,\n                    token: authToken,\n                    params: {\n                        query: `gid:${g}`,\n                        sort: 'orderno',\n                        hotelrefno:  Number(companyId)\n                    }\n                }).then(res => {\n                    if (res.status === 200) {\n                        if (res?.data?.data?.length) {\n                            updatedSliderImages.push(res.data.data[0]);\n                            setSliderImages(updatedSliderImages)\n                        }\n                    }\n                })\n            })\n        }\n    }, [sectionImages]);\n\n    if (isRequestSend) {\n        return <LoadingSpinner size={40} style={{color: COLORS.secondary}} />\n    }\n\n    return (\n        <>\n            {\n                image &&\n                <div onClick={()=> {\n                    if (sliderImages?.length) {\n                        setIsOpenSlider(true);\n                    }\n                }} className={clsx({\n                    [classes.box]: true,\n                    [classes.cursorPointer]: sliderImages?.length,\n                })}>\n                    {\n                        cta ? <a href={cta} target={'_blank'}>\n                            <img alt={'img'} className={classes.image} src={GENERAL_SETTINGS.STATIC_URL + image?.fileurl} />\n                        </a> : <img alt={'img'} className={classes.image} src={GENERAL_SETTINGS.STATIC_URL + image?.fileurl} />\n                    }\n                    <div className={classes.text}>\n                        { title && <div className={classes.textColor} dangerouslySetInnerHTML={{__html: title}}></div> }\n                        { description && <div className={classes.textColor} dangerouslySetInnerHTML={{__html: description}}></div> }\n                    </div>\n                </div>\n            }\n            <ThumbnailSliderModal open={isOpenSlider} sliderTitle={image?.title || 'Image'} sliderDesc={image?.description} onClose={(e)=> setIsOpenSlider(e)} sliderImages={sliderImages} />\n        </>\n    )\n};\n\nconst mapStateToProps = state => {\n    return {\n        state: state.formReducer.pageBuilder\n    }\n};\n\nexport default connect(\n    mapStateToProps,\n)(Image);\n"]},"metadata":{},"sourceType":"module"}
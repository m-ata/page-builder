{"ast":null,"code":"var _jsxFileName = \"/Users/mata/app-cloudweb/components/guest/public/components/events/WeeklyEvents.js\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect, useContext } from 'react';\nimport { connect, useSelector } from 'react-redux';\nimport axios from 'axios';\nimport { setToState, updateState } from 'state/actions';\nimport { Box, Container, Typography, Divider } from '@material-ui/core';\nimport useTranslation from 'lib/translations/hooks/useTranslation';\nimport CardSlider from '@webcms-ui/core/card-slider';\nimport WebCmsGlobal from 'components/webcms-global';\nimport LoadingSpinner from 'components/LoadingSpinner';\nimport { useRouter } from 'next/router';\nimport { isObjectEmpty, jsonGroupBy } from 'model/orest/constants';\nimport { FALSE, NULL } from 'model/globals';\nimport { defaultLocale } from 'lib/translations/config';\nimport BusinessIcon from '@material-ui/icons/Business';\nimport Button from '@material-ui/core/Button';\nimport { LocaleContext } from 'lib/translations/context/LocaleContext';\n\nconst NearbyEvents = props => {\n  const {\n    state,\n    setToState,\n    onlyRes\n  } = props;\n  const {\n    t\n  } = useTranslation();\n  const router = useRouter();\n  const {\n    GENERAL_SETTINGS\n  } = useContext(WebCmsGlobal);\n  const {\n    locale\n  } = useContext(LocaleContext);\n  const loginfo = useSelector(state => state.orest.currentUser && state.orest.currentUser.loginfo);\n  const changeHotelRefno = useSelector(state => state.formReducer.guest.changeHotelRefno && state.formReducer.guest.changeHotelRefno);\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(false);\n  let clientParams = {};\n  clientParams.hotelrefno = loginfo && loginfo.hotelrefno || GENERAL_SETTINGS.HOTELREFNO;\n  useEffect(() => {\n    let isChainHotelChange = false;\n\n    if (GENERAL_SETTINGS.ISCHAIN && changeHotelRefno !== false) {\n      clientParams.ischain = true;\n      clientParams.chainid = changeHotelRefno;\n      clientParams.hotelrefno = GENERAL_SETTINGS.HOTELREFNO;\n\n      if (clientParams.chainid !== state.weeklyList.chainid) {\n        isChainHotelChange = true;\n      }\n    } else if (GENERAL_SETTINGS.ISCHAIN && changeHotelRefno === false) {\n      return;\n    } else {\n      clientParams.ischain = false;\n    }\n\n    let isLangChange = false;\n\n    if (state.weeklyList.langcode !== locale) {\n      isLangChange = true;\n      setToState('guest', ['weeklyList', 'langcode'], locale);\n    }\n\n    clientParams.langcode = locale || defaultLocale;\n    let isRequest;\n\n    if (GENERAL_SETTINGS.ISCHAIN) {\n      isRequest = state.weeklyList.data === false && GENERAL_SETTINGS.ISCHAIN && changeHotelRefno !== false;\n    } else {\n      isRequest = state.weeklyList.data === false && GENERAL_SETTINGS.ISCHAIN === false;\n    }\n\n    if ((isRequest || isLangChange || isChainHotelChange) && isLoading === false) {\n      setIsLoading(true);\n      axios({\n        url: GENERAL_SETTINGS.BASE_URL + 'api/guestweb/event/weekly',\n        method: 'post',\n        params: clientParams\n      }).then(weeklyResponse => {\n        const weeklyData = weeklyResponse.data;\n\n        if (weeklyData.success && weeklyData.data.length > 0) {\n          let useData = weeklyData.data;\n\n          if (onlyRes) {\n            useData = useData.filter(item => item.lochasres === true);\n          }\n\n          setToState('guest', ['weeklyList', 'data'], useData.length > 0 ? jsonGroupBy(useData, 'eventypedesc') : null);\n          setToState('guest', ['weeklyList', 'langcode'], locale);\n          setToState('guest', ['weeklyList', 'chainid'], clientParams.chainid);\n          setIsLoading(false);\n        } else {\n          setToState('guest', ['weeklyList', 'data'], null);\n          setToState('guest', ['weeklyList', 'langcode'], locale);\n          setToState('guest', ['weeklyList', 'chainid'], clientParams.chainid);\n          setIsLoading(false);\n        }\n      });\n    }\n  }, [changeHotelRefno, locale]);\n\n  if (state.weeklyList.data === false || isLoading === true) {\n    return __jsx(Container, {\n      maxWidth: \"lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 13\n      }\n    }, __jsx(Box, {\n      p: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 17\n      }\n    }, __jsx(LoadingSpinner, {\n      size: 40,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 21\n      }\n    })));\n  }\n\n  if (state.weeklyList.data === null) {\n    return __jsx(Container, {\n      maxWidth: \"lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 13\n      }\n    }, __jsx(Box, {\n      p: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }\n    }, __jsx(Typography, {\n      variant: \"h6\",\n      align: \"center\",\n      gutterBottom: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 21\n      }\n    }, t('str_noWeeklyEvents')), GENERAL_SETTINGS.ISCHAIN && __jsx(Typography, {\n      variant: \"h6\",\n      align: \"center\",\n      gutterBottom: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 25\n      }\n    }, t('str_ifYouWishYouCanChangeTheHotelAndTryAgain'), __jsx(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 80\n      }\n    }), __jsx(Button, {\n      startIcon: __jsx(BusinessIcon, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 48\n        }\n      }),\n      onClick: () => setToState('guest', ['isHotelListOpen'], true),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 29\n      }\n    }, changeHotelRefno ? state.changeHotelName : t('str_chooseHotel')))));\n  }\n\n  return __jsx(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 9\n    }\n  }, __jsx(Container, {\n    maxWidth: \"lg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 13\n    }\n  }, state.weeklyList.data && Object.keys(state.weeklyList.data).map((groupName, index) => {\n    return __jsx(React.Fragment, {\n      key: index,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 25\n      }\n    }, __jsx(CardSlider, {\n      title: groupName,\n      openId: Number(router.query.eventlocid) || null,\n      slideData: state.weeklyList.data[groupName],\n      type: \"event\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 29\n      }\n    }), __jsx(Divider, {\n      style: {\n        marginBottom: 30\n      },\n      light: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 29\n      }\n    }));\n  })));\n};\n\nconst mapStateToProps = state => {\n  return {\n    state: state.formReducer.guest\n  };\n};\n\nconst mapDispatchToProps = dispatch => ({\n  updateState: (stateType, stateName, value) => dispatch(updateState(stateType, stateName, value)),\n  setToState: (stateType, stateName, value) => dispatch(setToState(stateType, stateName, value))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NearbyEvents);","map":{"version":3,"sources":["/Users/mata/app-cloudweb/components/guest/public/components/events/WeeklyEvents.js"],"names":["React","useState","useEffect","useContext","connect","useSelector","axios","setToState","updateState","Box","Container","Typography","Divider","useTranslation","CardSlider","WebCmsGlobal","LoadingSpinner","useRouter","isObjectEmpty","jsonGroupBy","FALSE","NULL","defaultLocale","BusinessIcon","Button","LocaleContext","NearbyEvents","props","state","onlyRes","t","router","GENERAL_SETTINGS","locale","loginfo","orest","currentUser","changeHotelRefno","formReducer","guest","isLoading","setIsLoading","clientParams","hotelrefno","HOTELREFNO","isChainHotelChange","ISCHAIN","ischain","chainid","weeklyList","isLangChange","langcode","isRequest","data","url","BASE_URL","method","params","then","weeklyResponse","weeklyData","success","length","useData","filter","item","lochasres","changeHotelName","Object","keys","map","groupName","index","Number","query","eventlocid","marginBottom","mapStateToProps","mapDispatchToProps","dispatch","stateType","stateName","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react'\nimport { connect, useSelector } from 'react-redux'\nimport axios from 'axios'\nimport { setToState, updateState } from 'state/actions'\nimport { Box, Container, Typography, Divider } from '@material-ui/core'\nimport useTranslation from 'lib/translations/hooks/useTranslation'\nimport CardSlider from '@webcms-ui/core/card-slider'\nimport WebCmsGlobal from 'components/webcms-global'\nimport LoadingSpinner from 'components/LoadingSpinner'\nimport { useRouter } from 'next/router'\nimport { isObjectEmpty, jsonGroupBy } from 'model/orest/constants'\nimport { FALSE, NULL } from 'model/globals'\nimport { defaultLocale } from 'lib/translations/config'\nimport BusinessIcon from '@material-ui/icons/Business'\nimport Button from  '@material-ui/core/Button'\nimport { LocaleContext } from 'lib/translations/context/LocaleContext'\n\nconst NearbyEvents = (props) => {\n    const { state, setToState, onlyRes } = props\n\n    const { t } = useTranslation()\n    const router = useRouter()\n    const { GENERAL_SETTINGS } = useContext(WebCmsGlobal)\n    const { locale } = useContext(LocaleContext)\n    const loginfo = useSelector((state) => state.orest.currentUser && state.orest.currentUser.loginfo)\n    const changeHotelRefno = useSelector((state) => state.formReducer.guest.changeHotelRefno && state.formReducer.guest.changeHotelRefno)\n    const [isLoading, setIsLoading] = useState(false)\n\n    let clientParams = {}\n    clientParams.hotelrefno = loginfo && loginfo.hotelrefno || GENERAL_SETTINGS.HOTELREFNO\n\n    useEffect(() => {\n\n        let isChainHotelChange = false\n        if(GENERAL_SETTINGS.ISCHAIN && changeHotelRefno !== false){\n            clientParams.ischain = true\n            clientParams.chainid = changeHotelRefno\n            clientParams.hotelrefno = GENERAL_SETTINGS.HOTELREFNO\n\n            if(clientParams.chainid !== state.weeklyList.chainid){\n                isChainHotelChange = true\n            }\n\n        } else if(GENERAL_SETTINGS.ISCHAIN && changeHotelRefno === false){\n            return;\n        }else{\n            clientParams.ischain = false\n        }\n\n        let isLangChange = false\n        if(state.weeklyList.langcode !== locale){\n            isLangChange = true\n            setToState('guest', ['weeklyList', 'langcode'], locale)\n        }\n\n        clientParams.langcode = locale || defaultLocale\n\n        let isRequest\n        if(GENERAL_SETTINGS.ISCHAIN){\n            isRequest = state.weeklyList.data === false && GENERAL_SETTINGS.ISCHAIN && changeHotelRefno !== false\n        }else {\n            isRequest = state.weeklyList.data === false && GENERAL_SETTINGS.ISCHAIN === false\n        }\n\n        if ((isRequest || isLangChange || isChainHotelChange) && isLoading === false) {\n            setIsLoading(true)\n            axios({\n                url: GENERAL_SETTINGS.BASE_URL + 'api/guestweb/event/weekly',\n                method: 'post',\n                params: clientParams\n            }).then((weeklyResponse) => {\n                    const weeklyData = weeklyResponse.data\n                    if (weeklyData.success && weeklyData.data.length > 0) {\n                        let useData = weeklyData.data\n                        if(onlyRes){\n                            useData = useData.filter(item => item.lochasres === true)\n                        }\n\n                        setToState('guest', ['weeklyList', 'data'], useData.length > 0 ? jsonGroupBy(useData, 'eventypedesc') : null)\n                        setToState('guest', ['weeklyList', 'langcode'], locale)\n                        setToState('guest', ['weeklyList', 'chainid'], clientParams.chainid)\n                        setIsLoading(false)\n                    } else {\n                        setToState('guest', ['weeklyList', 'data'], null)\n                        setToState('guest', ['weeklyList', 'langcode'], locale)\n                        setToState('guest', ['weeklyList', 'chainid'], clientParams.chainid)\n                        setIsLoading(false)\n                    }\n            })\n        }\n\n    },[changeHotelRefno,locale])\n\n    if (state.weeklyList.data === false || isLoading === true) {\n        return (\n            <Container maxWidth='lg'>\n                <Box p={4}>\n                    <LoadingSpinner size={40} />\n                </Box>\n            </Container>\n        )\n    }\n\n    if (state.weeklyList.data === null) {\n        return (\n            <Container maxWidth='lg'>\n                <Box p={4}>\n                    <Typography variant='h6' align='center' gutterBottom>\n                        {t('str_noWeeklyEvents')}\n                    </Typography>\n                    {GENERAL_SETTINGS.ISCHAIN && (\n                        <Typography variant='h6' align='center' gutterBottom>\n                            {t('str_ifYouWishYouCanChangeTheHotelAndTryAgain')}<br />\n                            <Button startIcon={<BusinessIcon />}\n                                    onClick={() => setToState('guest', ['isHotelListOpen'], true)}>\n                                {changeHotelRefno ? state.changeHotelName : t('str_chooseHotel')}\n                            </Button>\n                        </Typography>\n                    )}\n                </Box>\n            </Container>\n        )\n    }\n\n    return (\n        <React.Fragment>\n            <Container maxWidth='lg'>\n                {state.weeklyList.data &&\n                Object.keys(state.weeklyList.data).map((groupName, index) => {\n                    return (\n                        <React.Fragment key={index}>\n                            <CardSlider\n                                title={groupName}\n                                openId={Number(router.query.eventlocid) || null}\n                                slideData={state.weeklyList.data[groupName]}\n                                type='event'\n                            />\n                            <Divider style={{ marginBottom: 30 }} light />\n                        </React.Fragment>\n                    )\n                })}\n            </Container>\n        </React.Fragment>\n    )\n}\n\nconst mapStateToProps = (state) => {\n    return {\n        state: state.formReducer.guest,\n    }\n}\n\nconst mapDispatchToProps = (dispatch) => ({\n    updateState: (stateType, stateName, value) => dispatch(updateState(stateType, stateName, value)),\n    setToState: (stateType, stateName, value) => dispatch(setToState(stateType, stateName, value)),\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(NearbyEvents)\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _regeneratorRuntime from \"/Users/mata/app-cloudweb/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/mata/app-cloudweb/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _extends from \"/Users/mata/app-cloudweb/node_modules/next/node_modules/@babel/runtime/helpers/esm/extends\";\n\nvar _jsxFileName = \"/Users/mata/app-cloudweb/components/layout/components/AccountBanner.js\",\n    _s = $RefreshSig$(),\n    _this = this,\n    _s3 = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useContext, useEffect, useState, useRef } from 'react';\nimport { connect, useSelector } from 'react-redux';\nimport { updateState as _updateState } from 'state/actions';\nimport styles from './style/AccountBanner.style';\nimport Typography from '@material-ui/core/Typography';\nimport ListItem from '@material-ui/core/ListItem';\nimport List from '@material-ui/core/List';\nimport Grid from '@material-ui/core/Grid';\nimport Avatar from '@material-ui/core/Avatar';\nimport { DropzoneDialog } from 'material-ui-dropzone';\nimport { makeStyles } from '@material-ui/core/styles';\nimport MuiExpansionPanel from '@material-ui/core/Accordion';\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport { Delete, ViewList, UseOrest, Upload } from '@webcms/orest';\nimport { isErrorMsg, OREST_ENDPOINT, REQUEST_METHOD_CONST, useOrestQuery } from 'model/orest/constants';\nimport WebCmsGlobal from 'components/webcms-global';\nimport useNotifications from 'model/notification/useNotifications';\nimport NumberFormat from 'react-number-format';\nimport { useOrestAction } from 'model/orest';\nimport { withStyles } from '@material-ui/core/styles';\nimport useTranslation from 'lib/translations/hooks/useTranslation';\nimport * as global from '@webcms-globals';\nimport Container from '@material-ui/core/Container';\nimport MyLoyalty from 'components/guest/account/MyProfile/MyLoyalty';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Box from '@material-ui/core/Box';\nimport LoadingSpinner from 'components/LoadingSpinner';\nimport { useSnackbar } from 'notistack';\nvar useStyles = makeStyles(styles);\nvar Accordion = withStyles(function (theme) {\n  return {\n    root: {\n      background: \"transparent radial-gradient(closest-side at 50% 42%, \".concat(theme.palette.secondary.light, \" 0%, \").concat(theme.palette.secondary.light, \" 49%, \").concat(theme.palette.secondary.dark, \" 200%) 0% 0% no-repeat padding-box\"),\n      '&$expanded': {\n        margin: 0\n      }\n    },\n    expanded: {\n      margin: 0\n    }\n  };\n})(MuiExpansionPanel);\nvar useStylesAvatarCircularProgress = makeStyles(function (theme) {\n  return {\n    root: {\n      position: 'relative',\n      zIndex: 3,\n      marginTop: 5,\n      '&:hover': {\n        zIndex: 0\n      }\n    },\n    bottom: {\n      color: theme.palette.grey[theme.palette.type === 'light' ? 200 : 700]\n    },\n    top: {\n      color: '#1a90ff',\n      position: 'absolute',\n      left: 0,\n      animation: 'none'\n    },\n    circle: {\n      strokeLinecap: 'round'\n    }\n  };\n});\n\nfunction AvatarCircularProgress(props) {\n  _s();\n\n  var classes = useStylesAvatarCircularProgress();\n  return __jsx(\"div\", {\n    className: classes.root,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }\n  }, __jsx(CircularProgress, _extends({\n    variant: \"determinate\",\n    className: classes.bottom,\n    size: 160,\n    thickness: 4\n  }, props, {\n    value: 100,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 13\n    }\n  })), __jsx(CircularProgress, _extends({\n    variant: \"determinate\",\n    className: classes.top,\n    classes: {\n      circle: classes.circle\n    },\n    size: 160,\n    thickness: 4\n  }, props, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 13\n    }\n  })));\n}\n\n_s(AvatarCircularProgress, \"9sApqepDyyWsAR6HBbtjKpxOhVE=\", false, function () {\n  return [useStylesAvatarCircularProgress];\n});\n\n_c = AvatarCircularProgress;\n\nvar AccountBanner = function AccountBanner(props) {\n  _s3();\n\n  var _s2 = $RefreshSig$();\n\n  var classes = useStyles();\n  var updateState = props.updateState,\n      state = props.state,\n      isKiosk = props.isKiosk;\n\n  var _useContext = useContext(WebCmsGlobal),\n      GENERAL_SETTINGS = _useContext.GENERAL_SETTINGS;\n\n  var _useTranslation = useTranslation(),\n      t = _useTranslation.t;\n\n  var _useSnackbar = useSnackbar(),\n      enqueueSnackbar = _useSnackbar.enqueueSnackbar;\n\n  var txtFileCode = \"0000505\";\n  var useStyleAvatar = makeStyles(function (theme) {\n    return {\n      root: {\n        width: 160,\n        height: 160,\n        '&:hover': {\n          zIndex: 3\n        },\n        '&:hover:before': {\n          content: \"\\\"\".concat(t('str_clickToChange'), \"\\\"\"),\n          background: '#242424ab',\n          color: '#ffffff',\n          width: '100%',\n          height: '100%',\n          position: 'absolute',\n          fontSize: '12px',\n          textAlign: 'center',\n          paddingTop: '75px',\n          cursor: 'pointer'\n        }\n      },\n      img: {\n        padding: 12,\n        borderRadius: 85\n      }\n    };\n  });\n  var classesAvatar = useStyleAvatar(); //redux\n\n  var _useNotifications = useNotifications(),\n      showMessage = _useNotifications.showMessage,\n      showError = _useNotifications.showError;\n\n  var _useOrestAction = useOrestAction(),\n      setOrestState = _useOrestAction.setOrestState;\n\n  var token = useSelector(function (state) {\n    var _state$orest, _state$orest$currentU, _state$orest$currentU2;\n\n    return (state === null || state === void 0 ? void 0 : (_state$orest = state.orest) === null || _state$orest === void 0 ? void 0 : (_state$orest$currentU = _state$orest.currentUser) === null || _state$orest$currentU === void 0 ? void 0 : (_state$orest$currentU2 = _state$orest$currentU.auth) === null || _state$orest$currentU2 === void 0 ? void 0 : _state$orest$currentU2.access_token) || false;\n  });\n  var clientBase = useSelector(function (state) {\n    return state.orest.state && state.orest.state.client;\n  });\n  var infoLogin = useSelector(function (state) {\n    return state.orest.currentUser && state.orest.currentUser.loginfo;\n  }); //state\n\n  var _useState = useState(true),\n      isExpended = _useState[0],\n      setIsExpended = _useState[1];\n\n  var _useState2 = useState(false),\n      isUpdateLoyaltyPoints = _useState2[0],\n      setIsUpdateLoyaltyPoints = _useState2[1];\n\n  var _useState3 = useState(false),\n      bonusTransIsLoading = _useState3[0],\n      setBonusTransIsLoading = _useState3[1];\n\n  var _useState4 = useState(false),\n      memcardIsLoading = _useState4[0],\n      setMemcardTransIsLoading = _useState4[1];\n\n  var _useState5 = useState(false),\n      isClientLoyaltyCardLoading = _useState5[0],\n      setIsClientLoyaltyCardLoading = _useState5[1];\n\n  useEffect(function () {\n    var active = true;\n\n    var updateLoyaltyData = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(active) {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return beforeUpdateLoyaltyData(active);\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function updateLoyaltyData(_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    if (active) {\n      if (!clientBase && token && infoLogin !== null && infoLogin !== void 0 && infoLogin.accgid) {\n        UseOrest({\n          apiUrl: GENERAL_SETTINGS.OREST_URL,\n          endpoint: 'client/view/get',\n          token: token,\n          params: {\n            gid: infoLogin.accgid,\n            allhotels: true\n          }\n        }).then(function (clientGetResponse) {\n          var _clientGetResponse$da;\n\n          if (clientGetResponse.status === 200 && clientGetResponse !== null && clientGetResponse !== void 0 && (_clientGetResponse$da = clientGetResponse.data) !== null && _clientGetResponse$da !== void 0 && _clientGetResponse$da.data) {\n            var clientGetResponseData = clientGetResponse.data.data;\n            setOrestState(['client'], clientGetResponseData);\n          }\n        });\n      }\n\n      if (clientBase && clientBase !== null && clientBase !== void 0 && clientBase.id) {\n        updateState('guest', 'clientReservIsLoading', true);\n        UseOrest({\n          apiUrl: GENERAL_SETTINGS.OREST_URL,\n          endpoint: 'client/reservno',\n          token: token,\n          method: REQUEST_METHOD_CONST.GET,\n          params: {\n            clientid: clientBase.id,\n            isgapp: true\n          }\n        }).then(function (clientReservnoResponse) {\n          if (active) {\n            if (clientReservnoResponse.status === 200 && clientReservnoResponse.data.count > 0) {\n              updateState('guest', 'changeHotelRefno', clientReservnoResponse.data.data.hotelrefno);\n              updateState('guest', 'changeHotelName', clientReservnoResponse.data.data.hotelname);\n              updateState('guest', 'clientReservation', clientReservnoResponse.data.data);\n              updateState('guest', 'totalPax', clientReservnoResponse.data.data.totalpax || 1);\n              updateState('guest', 'totalChd', clientReservnoResponse.data.data.totalchd || 0);\n              updateState('guest', 'clientReservIsLoading', false);\n            } else {\n              updateState('guest', 'clientReservation', null);\n              updateState('guest', 'clientReservIsLoading', false);\n            }\n          } else {\n            updateState('guest', 'clientReservIsLoading', false);\n          }\n        })[\"catch\"](function () {\n          updateState('guest', 'clientReservation', null);\n          updateState('guest', 'clientReservIsLoading', false);\n        });\n\n        if (!state.isSelectGift && clientBase && clientBase !== null && clientBase !== void 0 && clientBase.id && !bonusTransIsLoading && !memcardIsLoading) {\n          updateLoyaltyData(active);\n        }\n      }\n    }\n\n    return function () {\n      setIsUpdateLoyaltyPoints(false);\n      setMemcardTransIsLoading(false);\n      setIsClientLoyaltyCardLoading(false);\n      active = false;\n    };\n  }, [clientBase]);\n  useEffect(function () {\n    var active = true;\n\n    if (active && !state.isSelectGift && !bonusTransIsLoading && !memcardIsLoading) {\n      var updateLoyaltyData = /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(active) {\n          return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n            while (1) {\n              switch (_context2.prev = _context2.next) {\n                case 0:\n                  _context2.next = 2;\n                  return beforeUpdateLoyaltyData(active);\n\n                case 2:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }\n          }, _callee2);\n        }));\n\n        return function updateLoyaltyData(_x2) {\n          return _ref2.apply(this, arguments);\n        };\n      }();\n\n      updateLoyaltyData(active);\n    }\n\n    return function () {\n      setIsUpdateLoyaltyPoints(false);\n      setMemcardTransIsLoading(false);\n      setIsClientLoyaltyCardLoading(false);\n      active = false;\n    };\n  }, [state.isSelectGift]);\n  var accountBannerRef = useRef(null);\n  useEffect(function () {\n    window.addEventListener('scroll', handleScroll, {\n      passive: true\n    });\n    return function () {\n      window.removeEventListener('scroll', handleScroll);\n    };\n  }, []);\n\n  var handleScroll = function handleScroll() {\n    var currentOffsetTop = accountBannerRef.current && accountBannerRef.current.getAttribute('lastOffsetTop') || accountBannerRef && accountBannerRef.current && accountBannerRef.current.offsetTop || false;\n\n    if (currentOffsetTop && window.pageYOffset > currentOffsetTop) {\n      if (accountBannerRef.current && !accountBannerRef.current.getAttribute('lastOffsetTop')) {\n        accountBannerRef.current.setAttribute('lastOffsetTop', accountBannerRef.current.offsetTop);\n      }\n\n      setIsExpended(false);\n      accountBannerRef.current.setAttribute('style', \"position: fixed; top: 60px; z-index:3; width: 100%;\");\n    } else {\n      if (accountBannerRef.current) {\n        accountBannerRef.current.removeAttribute('lastOffsetTop');\n        accountBannerRef.current.removeAttribute('style');\n      }\n    }\n  };\n\n  var beforeUpdateLoyaltyData = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(active) {\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              if (!(!isUpdateLoyaltyPoints && clientBase && clientBase !== null && clientBase !== void 0 && clientBase.id)) {\n                _context3.next = 10;\n                break;\n              }\n\n              setIsClientLoyaltyCardLoading(true);\n              setIsUpdateLoyaltyPoints(true);\n              setBonusTransIsLoading(true);\n              _context3.next = 6;\n              return UseOrest({\n                apiUrl: GENERAL_SETTINGS.OREST_URL,\n                endpoint: OREST_ENDPOINT.BONUSTRANS + '/' + OREST_ENDPOINT.STAT + '/' + OREST_ENDPOINT.ACC,\n                token: token,\n                method: REQUEST_METHOD_CONST.GET,\n                params: {\n                  limit: 1,\n                  accid: clientBase.id\n                }\n              }).then(function (r) {\n                if (active) {\n                  if (r.status === 200) {\n                    updateState('guest', 'bonusTransPoints', r.data.data[0]);\n                    setIsUpdateLoyaltyPoints(false);\n                    setBonusTransIsLoading(false);\n                  } else {\n                    var retErr = isErrorMsg(r);\n                    setIsUpdateLoyaltyPoints(false);\n                    enqueueSnackbar(t(retErr.errorMsg), {\n                      variant: 'error'\n                    });\n                    showError(retErr.errorMsg);\n                    setBonusTransIsLoading(false);\n                  }\n                }\n              });\n\n            case 6:\n              if (!(clientBase && clientBase !== null && clientBase !== void 0 && clientBase.id)) {\n                _context3.next = 10;\n                break;\n              }\n\n              setMemcardTransIsLoading(true);\n              _context3.next = 10;\n              return UseOrest({\n                apiUrl: GENERAL_SETTINGS.OREST_URL,\n                endpoint: OREST_ENDPOINT.MEMCARD + '/' + OREST_ENDPOINT.NEXT + '/' + OREST_ENDPOINT.LIST,\n                token: token,\n                method: REQUEST_METHOD_CONST.GET,\n                params: {\n                  accid: clientBase.id\n                }\n              }).then(function (r) {\n                if (active) {\n                  if (r.status === 200) {\n                    updateState('guest', 'memCardNext', r.data.data[0]);\n\n                    if (r.data.data[0] && state.clientLoyaltyCard === false) {\n                      UseOrest({\n                        apiUrl: GENERAL_SETTINGS.OREST_URL,\n                        endpoint: OREST_ENDPOINT.RAFILE + '/' + OREST_ENDPOINT.LIST,\n                        token: token,\n                        params: {\n                          query: \"code::\".concat(r.data.data[0].cardtypecode, \",filetype:\").concat(txtFileCode),\n                          limit: 1,\n                          allhotels: true\n                        }\n                      }).then(function (rafileResponse) {\n                        if (rafileResponse.status === 200 && rafileResponse.data.count > 0) {\n                          updateState('guest', 'clientLoyaltyCard', rafileResponse.data.data[0].filedata);\n                          setIsUpdateLoyaltyPoints(false);\n                          setMemcardTransIsLoading(false);\n                          setIsClientLoyaltyCardLoading(false);\n                        } else {\n                          setIsUpdateLoyaltyPoints(false);\n                          setMemcardTransIsLoading(false);\n                          setIsClientLoyaltyCardLoading(false);\n                        }\n                      })[\"catch\"](function () {\n                        setIsUpdateLoyaltyPoints(false);\n                        setMemcardTransIsLoading(false);\n                        setIsClientLoyaltyCardLoading(false);\n                      });\n                    } else {\n                      setIsUpdateLoyaltyPoints(false);\n                      setMemcardTransIsLoading(false);\n                      setIsClientLoyaltyCardLoading(false);\n                    }\n                  } else {\n                    var retErr = isErrorMsg(r);\n                    setIsUpdateLoyaltyPoints(false);\n                    setMemcardTransIsLoading(false);\n                    setIsClientLoyaltyCardLoading(false);\n                    enqueueSnackbar(t(retErr.errorMsg), {\n                      variant: 'error'\n                    });\n                  }\n                }\n              });\n\n            case 10:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function beforeUpdateLoyaltyData(_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var handleChange = function handleChange(event, isExpanded) {\n    setIsExpended(isExpanded);\n    window.scrollTo({\n      top: 0,\n      behavior: \"smooth\"\n    });\n  };\n\n  var useStyleLoyaltyCard = makeStyles(function () {\n    return {\n      root: {\n        background: '#e4e4e4',\n        borderRadius: 15,\n        backgroundSize: 'cover',\n        backgroundRepeat: 'no-repeat',\n        maxWidth: '374.66px',\n        margin: '0 auto'\n      },\n      image: {\n        backgroundSize: '100% 100%'\n      }\n    };\n  });\n  var classesLoyaltyCard = useStyleLoyaltyCard();\n\n  var _useState6 = useState(false),\n      profilePhotoUpload = _useState6[0],\n      setProfilePhotoUpload = _useState6[1];\n\n  var handleProfilePhotoUpload = function handleProfilePhotoUpload(file) {\n    _s2();\n\n    var uploadPhoto = function uploadPhoto() {\n      Upload({\n        apiUrl: GENERAL_SETTINGS.OREST_URL,\n        token: token,\n        params: {\n          masterid: clientBase.mid,\n          code: 'PHOTO',\n          hotelrefno: GENERAL_SETTINGS.HOTELREFNO\n        },\n        files: file\n      }).then(function (r) {\n        if (r.status === 200) {\n          var newFile = file[0];\n          var url = URL.createObjectURL(newFile);\n          updateState('guest', 'clientProfilePhoto', url);\n          setProfilePhotoUpload(false);\n          showMessage(t('str_updateIsSuccessfullyDone'));\n        } else {\n          showMessage(t('str_unexpectedProblem'));\n          setProfilePhotoUpload(false);\n        }\n      });\n    };\n\n    ViewList({\n      apiUrl: GENERAL_SETTINGS.OREST_URL,\n      endpoint: OREST_ENDPOINT.RAFILE,\n      token: token,\n      params: {\n        query: useOrestQuery({\n          masterid: clientBase.mid,\n          code: 'PHOTO'\n        }),\n        hotelrefno: GENERAL_SETTINGS.HOTELREFNO,\n        allhotels: true\n      }\n    }).then(function (r) {\n      if (r.status === 200 && r.data.count > 0) {\n        Delete({\n          apiUrl: GENERAL_SETTINGS.OREST_URL,\n          endpoint: OREST_ENDPOINT.RAFILE,\n          token: token,\n          gid: r.data.data[0].gid,\n          params: {\n            hotelrefno: GENERAL_SETTINGS.HOTELREFNO\n          }\n        }).then(function (res) {\n          if (res.status === 200) {\n            uploadPhoto();\n          } else {\n            enqueueSnackbar(t('str_unexpectedProblem'), {\n              variant: 'error'\n            });\n          }\n        });\n      } else {\n        uploadPhoto();\n      }\n    });\n  };\n\n  _s2(handleProfilePhotoUpload, \"BEKubBB6hIvp29hjeosZqlDemxA=\", false, function () {\n    return [useOrestQuery];\n  });\n\n  var cardPoints = state.memCardNext && Math.abs((state.memCardNext.nextbonustotal - state.memCardNext.totalbonus) / state.memCardNext.totalbonus * 100);\n\n  if (isKiosk) {\n    return null;\n  }\n\n  return __jsx(Accordion, {\n    expanded: isExpended,\n    onChange: handleChange,\n    ref: accountBannerRef,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 442,\n      columnNumber: 9\n    }\n  }, __jsx(AccordionSummary, {\n    expandIcon: __jsx(ExpandMoreIcon, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 443,\n        columnNumber: 43\n      }\n    }),\n    \"aria-controls\": \"panel1c-content\",\n    id: \"panel1c-header\",\n    classes: {\n      root: classes.rootCls,\n      content: classes.contentCls\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 443,\n      columnNumber: 13\n    }\n  }, !isExpended && __jsx(Grid, {\n    container: true,\n    justify: 'center',\n    alignItems: 'center',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 445,\n      columnNumber: 21\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 12,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 25\n    }\n  }, __jsx(Typography, {\n    display: 'block',\n    align: 'center',\n    className: classes.memberFullName,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 447,\n      columnNumber: 29\n    }\n  }, clientBase && global.helper.capitalizeWord(clientBase.firstname.toLowerCase()) + ' ' + clientBase.lastname.toUpperCase())))), __jsx(AccordionDetails, {\n    className: classes.details,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 454,\n      columnNumber: 13\n    }\n  }, __jsx(Container, {\n    maxWidth: \"lg\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 455,\n      columnNumber: 17\n    }\n  }, __jsx(Grid, {\n    container: true,\n    justify: 'center',\n    alignItems: 'center',\n    spacing: 3,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 456,\n      columnNumber: 21\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 12,\n    sm: 6,\n    md: 4,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 457,\n      columnNumber: 25\n    }\n  }, __jsx(Grid, {\n    container: true,\n    justify: 'center',\n    alignItems: 'center',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 458,\n      columnNumber: 29\n    }\n  }, __jsx(Grid, {\n    item: true,\n    sm: 6,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 459,\n      columnNumber: 33\n    }\n  }, __jsx(Box, {\n    position: \"relative\",\n    display: \"inline-flex\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 460,\n      columnNumber: 37\n    }\n  }, __jsx(AvatarCircularProgress, {\n    value: cardPoints,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 461,\n      columnNumber: 41\n    }\n  }), __jsx(Box, {\n    top: 0,\n    left: 0,\n    bottom: 0,\n    right: 0,\n    position: \"absolute\",\n    display: \"flex\",\n    alignItems: \"center\",\n    justify: \"center\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 462,\n      columnNumber: 41\n    }\n  }, __jsx(Avatar, {\n    src: state.clientProfilePhoto ? state.clientProfilePhoto : '',\n    classes: classesAvatar,\n    onClick: function onClick() {\n      return setProfilePhotoUpload(true);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 472,\n      columnNumber: 45\n    }\n  }))), __jsx(DropzoneDialog, {\n    open: profilePhotoUpload,\n    onSave: handleProfilePhotoUpload,\n    acceptedFiles: ['image/jpeg', 'image/png'],\n    showPreviews: true,\n    maxFileSize: 5000000,\n    filesLimit: 1,\n    onClose: function onClose() {\n      return setProfilePhotoUpload(false);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 479,\n      columnNumber: 37\n    }\n  })), __jsx(Grid, {\n    item: true,\n    xs: 12,\n    sm: 6,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 489,\n      columnNumber: 33\n    }\n  }, __jsx(List, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 490,\n      columnNumber: 37\n    }\n  }, clientBase && clientBase.cardtypecode && __jsx(ListItem, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 492,\n      columnNumber: 41\n    }\n  }, __jsx(Typography, {\n    className: classes.memberType,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 493,\n      columnNumber: 45\n    }\n  }, (clientBase.cardtypecode + ' ' + t('str_member')).toUpperCase())), __jsx(ListItem, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 498,\n      columnNumber: 41\n    }\n  }, __jsx(Typography, {\n    className: classes.memberFullName,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 499,\n      columnNumber: 45\n    }\n  }, clientBase && (clientBase === null || clientBase === void 0 ? void 0 : clientBase.firstname) && (clientBase === null || clientBase === void 0 ? void 0 : clientBase.lastname) && global.helper.capitalizeWord(clientBase.firstname.toLowerCase()) + ' ' + clientBase.lastname.toUpperCase())))))), __jsx(Grid, {\n    item: true,\n    xs: 12,\n    md: 4,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 507,\n      columnNumber: 25\n    }\n  }, __jsx(Grid, {\n    container: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 508,\n      columnNumber: 29\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 12,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 509,\n      columnNumber: 33\n    }\n  }, isClientLoyaltyCardLoading ? __jsx(LoadingSpinner, {\n    size: 30,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 511,\n      columnNumber: 41\n    }\n  }) : state !== null && state !== void 0 && state.clientLoyaltyCard ? clientBase !== null && clientBase !== void 0 && clientBase.id ? __jsx(\"div\", {\n    dangerouslySetInnerHTML: {\n      __html: state.clientLoyaltyCard && Buffer.from(state.clientLoyaltyCard, 'base64').toString('utf-8').replaceAll('{fullname}', clientBase && clientBase.firstname + ' ' + clientBase.lastname).replaceAll('{point}', new Intl.NumberFormat('en-IN', {\n        maximumSignificantDigits: 3\n      }).format(state.bonusTransPoints && state.bonusTransPoints.bonusleft || '0')).replaceAll('{pts}', 'pts').replaceAll('{cardno}', clientBase && clientBase.id).replaceAll('{email}', clientBase && clientBase.email).replaceAll('{str_bonusExpired}', t('str_bonusExpired')).replaceAll('{bonusexpired}', new Intl.NumberFormat('en-IN', {\n        maximumSignificantDigits: 3\n      }).format(state.bonusTransPoints && state.bonusTransPoints.bonusexpired || '0')).replaceAll('{str_bonusGained}', t('str_bonusGained')).replaceAll('{bonusgained}', new Intl.NumberFormat('en-IN', {\n        maximumSignificantDigits: 3\n      }).format(state.bonusTransPoints && state.bonusTransPoints.bonusgained || '0')).replaceAll('{str_bonusLeft}', t('str_bonusLeft')).replaceAll('{bonusleft}', new Intl.NumberFormat('en-IN', {\n        maximumSignificantDigits: 3\n      }).format(state.bonusTransPoints && state.bonusTransPoints.bonusleft || '0')).replaceAll('{str_bonusUsed}', t('str_bonusUsed')).replaceAll('{bonusused}', new Intl.NumberFormat('en-IN', {\n        maximumSignificantDigits: 3\n      }).format(state.bonusTransPoints && state.bonusTransPoints.bonusused || '0')).replaceAll('{str_bonusLeftHc}', t('str_bonusLeftHc')).replaceAll('{bonuslefthc}', new Intl.NumberFormat('en-IN', {\n        maximumSignificantDigits: 3\n      }).format(state.bonusTransPoints && state.bonusTransPoints.bonuslefthc || '0'))\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 514,\n      columnNumber: 45\n    }\n  }) : null : clientBase !== null && clientBase !== void 0 && clientBase.id ? __jsx(\"div\", {\n    className: classesLoyaltyCard.root,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 535,\n      columnNumber: 41\n    }\n  }, __jsx(Grid, {\n    container: true,\n    alignItems: 'center',\n    className: classes.cardContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 536,\n      columnNumber: 41\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 12,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 537,\n      columnNumber: 45\n    }\n  }, __jsx(Typography, {\n    className: classes.cardBonus,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 538,\n      columnNumber: 49\n    }\n  }, __jsx(NumberFormat, {\n    value: state.bonusTransPoints && state.bonusTransPoints.bonusexpired || '0',\n    displayType: 'text',\n    decimalScale: 2,\n    isNumericString: true,\n    thousandSeparator: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 539,\n      columnNumber: 53\n    }\n  }), __jsx(\"span\", {\n    className: classes.cardPts,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 546,\n      columnNumber: 53\n    }\n  }, 'pts'))), __jsx(Grid, {\n    item: true,\n    xs: 12,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 549,\n      columnNumber: 45\n    }\n  }, __jsx(Grid, {\n    container: true,\n    justify: 'space-between',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 550,\n      columnNumber: 49\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 6,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 551,\n      columnNumber: 53\n    }\n  }, __jsx(Typography, {\n    noWrap: true,\n    className: classes.cardClientName,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 552,\n      columnNumber: 57\n    }\n  }, clientBase && clientBase.firstname, \" \", clientBase && clientBase.lastname)), __jsx(Grid, {\n    item: true,\n    xs: 6,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 556,\n      columnNumber: 53\n    }\n  }, __jsx(Typography, {\n    noWrap: true,\n    className: classes.cardClientId,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 557,\n      columnNumber: 57\n    }\n  }, clientBase && clientBase.id)))))) : null))), __jsx(Grid, {\n    item: true,\n    xs: 12,\n    md: 4,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 568,\n      columnNumber: 25\n    }\n  }, __jsx(MyLoyalty, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 569,\n      columnNumber: 29\n    }\n  }))))));\n};\n\n_s3(AccountBanner, \"+qOVw5hes/e+hHmeYdQ5V5E4s/c=\", true, function () {\n  return [useStyles, useTranslation, useSnackbar, useNotifications, useOrestAction, useSelector, useSelector, useSelector];\n});\n\n_c2 = AccountBanner;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    state: state.formReducer.guest\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    updateState: function updateState(stateType, stateName, value) {\n      return dispatch(_updateState(stateType, stateName, value));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AccountBanner);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"AvatarCircularProgress\");\n$RefreshReg$(_c2, \"AccountBanner\");","map":{"version":3,"sources":["/Users/mata/app-cloudweb/components/layout/components/AccountBanner.js"],"names":["React","useContext","useEffect","useState","useRef","connect","useSelector","updateState","styles","Typography","ListItem","List","Grid","Avatar","DropzoneDialog","makeStyles","MuiExpansionPanel","AccordionSummary","AccordionDetails","ExpandMoreIcon","Delete","ViewList","UseOrest","Upload","isErrorMsg","OREST_ENDPOINT","REQUEST_METHOD_CONST","useOrestQuery","WebCmsGlobal","useNotifications","NumberFormat","useOrestAction","withStyles","useTranslation","global","Container","MyLoyalty","CircularProgress","Box","LoadingSpinner","useSnackbar","useStyles","Accordion","theme","root","background","palette","secondary","light","dark","margin","expanded","useStylesAvatarCircularProgress","position","zIndex","marginTop","bottom","color","grey","type","top","left","animation","circle","strokeLinecap","AvatarCircularProgress","props","classes","AccountBanner","state","isKiosk","GENERAL_SETTINGS","t","enqueueSnackbar","txtFileCode","useStyleAvatar","width","height","content","fontSize","textAlign","paddingTop","cursor","img","padding","borderRadius","classesAvatar","showMessage","showError","setOrestState","token","orest","currentUser","auth","access_token","clientBase","client","infoLogin","loginfo","isExpended","setIsExpended","isUpdateLoyaltyPoints","setIsUpdateLoyaltyPoints","bonusTransIsLoading","setBonusTransIsLoading","memcardIsLoading","setMemcardTransIsLoading","isClientLoyaltyCardLoading","setIsClientLoyaltyCardLoading","active","updateLoyaltyData","beforeUpdateLoyaltyData","accgid","apiUrl","OREST_URL","endpoint","params","gid","allhotels","then","clientGetResponse","status","data","clientGetResponseData","id","method","GET","clientid","isgapp","clientReservnoResponse","count","hotelrefno","hotelname","totalpax","totalchd","isSelectGift","accountBannerRef","window","addEventListener","handleScroll","passive","removeEventListener","currentOffsetTop","current","getAttribute","offsetTop","pageYOffset","setAttribute","removeAttribute","BONUSTRANS","STAT","ACC","limit","accid","r","retErr","errorMsg","variant","MEMCARD","NEXT","LIST","clientLoyaltyCard","RAFILE","query","cardtypecode","rafileResponse","filedata","handleChange","event","isExpanded","scrollTo","behavior","useStyleLoyaltyCard","backgroundSize","backgroundRepeat","maxWidth","image","classesLoyaltyCard","profilePhotoUpload","setProfilePhotoUpload","handleProfilePhotoUpload","file","uploadPhoto","masterid","mid","code","HOTELREFNO","files","newFile","url","URL","createObjectURL","res","cardPoints","memCardNext","Math","abs","nextbonustotal","totalbonus","rootCls","contentCls","memberFullName","helper","capitalizeWord","firstname","toLowerCase","lastname","toUpperCase","details","clientProfilePhoto","memberType","__html","Buffer","from","toString","replaceAll","Intl","maximumSignificantDigits","format","bonusTransPoints","bonusleft","email","bonusexpired","bonusgained","bonusused","bonuslefthc","cardContainer","cardBonus","cardPts","cardClientName","cardClientId","mapStateToProps","formReducer","guest","mapDispatchToProps","dispatch","stateType","stateName","value"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState, useRef } from 'react'\nimport { connect, useSelector } from 'react-redux'\nimport { updateState } from 'state/actions'\nimport styles from './style/AccountBanner.style'\nimport Typography from '@material-ui/core/Typography'\nimport ListItem from '@material-ui/core/ListItem'\nimport List from '@material-ui/core/List'\nimport Grid from '@material-ui/core/Grid'\nimport Avatar from '@material-ui/core/Avatar'\nimport { DropzoneDialog } from 'material-ui-dropzone'\nimport { makeStyles } from '@material-ui/core/styles'\nimport MuiExpansionPanel from '@material-ui/core/Accordion'\nimport AccordionSummary from '@material-ui/core/AccordionSummary'\nimport AccordionDetails from '@material-ui/core/AccordionDetails'\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore'\nimport { Delete, ViewList, UseOrest, Upload } from '@webcms/orest'\nimport {\n    isErrorMsg,\n    OREST_ENDPOINT,\n    REQUEST_METHOD_CONST,\n    useOrestQuery,\n} from 'model/orest/constants'\nimport WebCmsGlobal from 'components/webcms-global'\nimport useNotifications from 'model/notification/useNotifications'\nimport NumberFormat from 'react-number-format'\nimport { useOrestAction } from 'model/orest'\nimport { withStyles } from '@material-ui/core/styles'\nimport useTranslation from 'lib/translations/hooks/useTranslation'\nimport * as global from '@webcms-globals'\nimport Container from '@material-ui/core/Container'\nimport MyLoyalty from 'components/guest/account/MyProfile/MyLoyalty'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport Box from '@material-ui/core/Box'\nimport LoadingSpinner from 'components/LoadingSpinner'\nimport { useSnackbar } from 'notistack'\n\nconst useStyles = makeStyles(styles)\n\nconst Accordion = withStyles((theme) => ({\n    root: {\n        background: `transparent radial-gradient(closest-side at 50% 42%, ${theme.palette.secondary.light} 0%, ${theme.palette.secondary.light} 49%, ${theme.palette.secondary.dark} 200%) 0% 0% no-repeat padding-box`,\n        '&$expanded': {\n            margin: 0,\n        },\n    },\n    expanded: {\n        margin: 0,\n    },\n}))(MuiExpansionPanel)\n\nconst useStylesAvatarCircularProgress = makeStyles((theme) => ({\n    root: {\n        position: 'relative',\n        zIndex: 3,\n        marginTop: 5,\n        '&:hover': {\n            zIndex: 0,\n        },\n    },\n    bottom: {\n        color: theme.palette.grey[theme.palette.type === 'light' ? 200 : 700],\n    },\n    top: {\n        color: '#1a90ff',\n        position: 'absolute',\n        left: 0,\n        animation: 'none',\n    },\n    circle: {\n        strokeLinecap: 'round',\n    },\n}))\n\nfunction AvatarCircularProgress(props) {\n    const classes = useStylesAvatarCircularProgress()\n\n    return (\n        <div className={classes.root}>\n            <CircularProgress\n                variant=\"determinate\"\n                className={classes.bottom}\n                size={160}\n                thickness={4}\n                {...props}\n                value={100}\n            />\n            <CircularProgress\n                variant=\"determinate\"\n                className={classes.top}\n                classes={{\n                    circle: classes.circle,\n                }}\n                size={160}\n                thickness={4}\n                {...props}\n            />\n        </div>\n    )\n}\n\nconst AccountBanner = (props) => {\n    const classes = useStyles()\n    const { updateState, state, isKiosk } = props\n    const { GENERAL_SETTINGS } = useContext(WebCmsGlobal)\n    const { t } = useTranslation()\n    const { enqueueSnackbar } = useSnackbar()\n    const txtFileCode = \"0000505\"\n\n    const useStyleAvatar = makeStyles((theme) => ({\n        root: {\n            width: 160,\n            height: 160,\n            '&:hover': {\n                zIndex: 3,\n            },\n            '&:hover:before': {\n                content: `\"${t('str_clickToChange')}\"`,\n                background: '#242424ab',\n                color: '#ffffff',\n                width: '100%',\n                height: '100%',\n                position: 'absolute',\n                fontSize: '12px',\n                textAlign: 'center',\n                paddingTop: '75px',\n                cursor: 'pointer',\n            },\n        },\n        img: {\n            padding: 12,\n            borderRadius: 85,\n        },\n    }))\n\n    const classesAvatar = useStyleAvatar()\n\n    //redux\n    const { showMessage, showError } = useNotifications()\n    const { setOrestState } = useOrestAction()\n    const token = useSelector((state) => state?.orest?.currentUser?.auth?.access_token || false)\n    const clientBase = useSelector((state) => state.orest.state && state.orest.state.client)\n    const infoLogin = useSelector((state) => state.orest.currentUser && state.orest.currentUser.loginfo)\n\n    //state\n    const [isExpended, setIsExpended] = useState(true)\n    const [isUpdateLoyaltyPoints, setIsUpdateLoyaltyPoints] = useState(false)\n    const [bonusTransIsLoading, setBonusTransIsLoading] = useState(false)\n    const [memcardIsLoading, setMemcardTransIsLoading] = useState(false)\n    const [isClientLoyaltyCardLoading, setIsClientLoyaltyCardLoading] = useState(false)\n\n    useEffect(() => {\n        let active = true\n\n        const updateLoyaltyData = async (active) => {\n            await beforeUpdateLoyaltyData(active)\n        }\n\n        if (active) {\n            if(!clientBase && token && infoLogin?.accgid){\n                UseOrest({\n                    apiUrl: GENERAL_SETTINGS.OREST_URL,\n                    endpoint: 'client/view/get',\n                    token,\n                    params: {\n                        gid: infoLogin.accgid,\n                        allhotels: true\n                    }\n                }).then((clientGetResponse) => {\n                    if (clientGetResponse.status === 200 && clientGetResponse?.data?.data) {\n                        const clientGetResponseData = clientGetResponse.data.data\n                        setOrestState(['client'], clientGetResponseData)\n                    }\n                })\n            }\n\n            if (clientBase && clientBase?.id) {\n                updateState('guest', 'clientReservIsLoading', true)\n                UseOrest({\n                    apiUrl: GENERAL_SETTINGS.OREST_URL,\n                    endpoint: 'client/reservno',\n                    token,\n                    method: REQUEST_METHOD_CONST.GET,\n                    params: {\n                        clientid: clientBase.id,\n                        isgapp: true,\n                    },\n                }).then((clientReservnoResponse) => {\n                    if (active) {\n                        if (clientReservnoResponse.status === 200 && clientReservnoResponse.data.count > 0) {\n                            updateState('guest', 'changeHotelRefno', clientReservnoResponse.data.data.hotelrefno)\n                            updateState('guest', 'changeHotelName', clientReservnoResponse.data.data.hotelname)\n                            updateState('guest', 'clientReservation', clientReservnoResponse.data.data)\n                            updateState('guest', 'totalPax', clientReservnoResponse.data.data.totalpax || 1)\n                            updateState('guest', 'totalChd', clientReservnoResponse.data.data.totalchd || 0)\n                            updateState('guest', 'clientReservIsLoading', false)\n                        } else {\n                            updateState('guest', 'clientReservation', null)\n                            updateState('guest', 'clientReservIsLoading', false)\n                        }\n                    } else {\n                        updateState('guest', 'clientReservIsLoading', false)\n                    }\n                }).catch(()=> {\n                    updateState('guest', 'clientReservation', null)\n                    updateState('guest', 'clientReservIsLoading', false)\n                })\n\n                if(!state.isSelectGift && clientBase && clientBase?.id && !bonusTransIsLoading && !memcardIsLoading){\n                    updateLoyaltyData(active)\n                }\n            }\n        }\n\n        return () => {\n            setIsUpdateLoyaltyPoints(false)\n            setMemcardTransIsLoading(false)\n            setIsClientLoyaltyCardLoading(false)\n            active = false\n        }\n\n    }, [clientBase])\n\n    useEffect(() => {\n        let active = true\n        if (active && !state.isSelectGift && !bonusTransIsLoading && !memcardIsLoading) {\n            const updateLoyaltyData = async (active) => {\n                await beforeUpdateLoyaltyData(active)\n            }\n\n            updateLoyaltyData(active)\n        }\n        return () => {\n            setIsUpdateLoyaltyPoints(false)\n            setMemcardTransIsLoading(false)\n            setIsClientLoyaltyCardLoading(false)\n            active = false\n        }\n    }, [state.isSelectGift])\n\n    const accountBannerRef = useRef(null)\n\n    useEffect(() => {\n        window.addEventListener('scroll', handleScroll, { passive: true })\n        return () => {\n            window.removeEventListener('scroll', handleScroll)\n        }\n    }, [])\n\n    const handleScroll = () => {\n        const currentOffsetTop = accountBannerRef.current && accountBannerRef.current.getAttribute('lastOffsetTop') || accountBannerRef && accountBannerRef.current && accountBannerRef.current.offsetTop || false\n        if (currentOffsetTop && window.pageYOffset > currentOffsetTop) {\n            if (accountBannerRef.current && !accountBannerRef.current.getAttribute('lastOffsetTop')) {\n                accountBannerRef.current.setAttribute('lastOffsetTop', accountBannerRef.current.offsetTop)\n            }\n            setIsExpended(false)\n            accountBannerRef.current.setAttribute('style', `position: fixed; top: 60px; z-index:3; width: 100%;`)\n        }else {\n            if(accountBannerRef.current){\n                accountBannerRef.current.removeAttribute('lastOffsetTop')\n                accountBannerRef.current.removeAttribute('style')\n            }\n        }\n    }\n\n    const beforeUpdateLoyaltyData = async (active) => {\n        if(!isUpdateLoyaltyPoints && clientBase && clientBase?.id){\n            setIsClientLoyaltyCardLoading(true)\n            setIsUpdateLoyaltyPoints(true)\n            setBonusTransIsLoading(true)\n            await UseOrest({\n                apiUrl: GENERAL_SETTINGS.OREST_URL,\n                endpoint: OREST_ENDPOINT.BONUSTRANS + '/' + OREST_ENDPOINT.STAT + '/' + OREST_ENDPOINT.ACC,\n                token,\n                method: REQUEST_METHOD_CONST.GET,\n                params: {\n                    limit: 1,\n                    accid: clientBase.id,\n                },\n            }).then((r) => {\n                if (active) {\n                    if (r.status === 200) {\n                        updateState('guest', 'bonusTransPoints', r.data.data[0])\n                        setIsUpdateLoyaltyPoints(false)\n                        setBonusTransIsLoading(false)\n                    } else {\n                        const retErr = isErrorMsg(r)\n                        setIsUpdateLoyaltyPoints(false)\n                        enqueueSnackbar(t(retErr.errorMsg), { variant: 'error' })\n                        showError(retErr.errorMsg)\n                        setBonusTransIsLoading(false)\n                    }\n                }\n            })\n\n            if(clientBase && clientBase?.id){\n                setMemcardTransIsLoading(true)\n                await UseOrest({\n                    apiUrl: GENERAL_SETTINGS.OREST_URL,\n                    endpoint: OREST_ENDPOINT.MEMCARD + '/' + OREST_ENDPOINT.NEXT + '/' + OREST_ENDPOINT.LIST,\n                    token,\n                    method: REQUEST_METHOD_CONST.GET,\n                    params: {\n                        accid: clientBase.id,\n                    },\n                }).then((r) => {\n                    if (active) {\n                        if (r.status === 200) {\n                            updateState('guest', 'memCardNext', r.data.data[0])\n                            if (r.data.data[0] && state.clientLoyaltyCard === false) {\n                                UseOrest({\n                                    apiUrl: GENERAL_SETTINGS.OREST_URL,\n                                    endpoint: OREST_ENDPOINT.RAFILE + '/' + OREST_ENDPOINT.LIST,\n                                    token,\n                                    params: {\n                                        query: `code::${r.data.data[0].cardtypecode},filetype:${txtFileCode}`,\n                                        limit: 1,\n                                        allhotels: true,\n                                    },\n                                }).then((rafileResponse) => {\n                                    if (rafileResponse.status === 200 && rafileResponse.data.count > 0) {\n                                        updateState('guest', 'clientLoyaltyCard', rafileResponse.data.data[0].filedata)\n                                        setIsUpdateLoyaltyPoints(false)\n                                        setMemcardTransIsLoading(false)\n                                        setIsClientLoyaltyCardLoading(false)\n                                    } else {\n                                        setIsUpdateLoyaltyPoints(false)\n                                        setMemcardTransIsLoading(false)\n                                        setIsClientLoyaltyCardLoading(false)\n                                    }\n                                }).catch(() => {\n                                    setIsUpdateLoyaltyPoints(false)\n                                    setMemcardTransIsLoading(false)\n                                    setIsClientLoyaltyCardLoading(false)\n                                })\n                            } else {\n                                setIsUpdateLoyaltyPoints(false)\n                                setMemcardTransIsLoading(false)\n                                setIsClientLoyaltyCardLoading(false)\n                            }\n\n                        } else {\n                            const retErr = isErrorMsg(r)\n                            setIsUpdateLoyaltyPoints(false)\n                            setMemcardTransIsLoading(false)\n                            setIsClientLoyaltyCardLoading(false)\n                            enqueueSnackbar(t(retErr.errorMsg), { variant: 'error' })\n                        }\n                    }\n                })\n            }\n        }\n    }\n\n    const handleChange = (event, isExpanded) => {\n        setIsExpended(isExpanded)\n        window.scrollTo({ top: 0, behavior: \"smooth\" })\n    }\n\n    const useStyleLoyaltyCard = makeStyles(() => ({\n        root: {\n            background: '#e4e4e4',\n            borderRadius: 15,\n            backgroundSize: 'cover',\n            backgroundRepeat: 'no-repeat',\n            maxWidth: '374.66px',\n            margin: '0 auto',\n        },\n        image: {\n            backgroundSize: '100% 100%',\n        },\n    }))\n    const classesLoyaltyCard = useStyleLoyaltyCard()\n\n    const [profilePhotoUpload, setProfilePhotoUpload] = useState(false)\n    const handleProfilePhotoUpload = (file) => {\n        const uploadPhoto = () => {\n            Upload({\n                apiUrl: GENERAL_SETTINGS.OREST_URL,\n                token,\n                params: {\n                    masterid: clientBase.mid,\n                    code: 'PHOTO',\n                    hotelrefno: GENERAL_SETTINGS.HOTELREFNO,\n                },\n                files: file,\n            }).then((r) => {\n                if (r.status === 200) {\n                    let newFile = file[0]\n                    let url = URL.createObjectURL(newFile)\n                    updateState('guest', 'clientProfilePhoto', url)\n                    setProfilePhotoUpload(false)\n                    showMessage(t('str_updateIsSuccessfullyDone'))\n                } else {\n                    showMessage(t('str_unexpectedProblem'))\n                    setProfilePhotoUpload(false)\n                }\n            })\n        }\n\n        ViewList({\n            apiUrl: GENERAL_SETTINGS.OREST_URL,\n            endpoint: OREST_ENDPOINT.RAFILE,\n            token: token,\n            params: {\n                query: useOrestQuery({\n                    masterid: clientBase.mid,\n                    code: 'PHOTO'\n                }),\n                hotelrefno: GENERAL_SETTINGS.HOTELREFNO,\n                allhotels: true\n            },\n        }).then((r) => {\n            if (r.status === 200 && r.data.count > 0) {\n                Delete({\n                    apiUrl: GENERAL_SETTINGS.OREST_URL,\n                    endpoint: OREST_ENDPOINT.RAFILE,\n                    token,\n                    gid: r.data.data[0].gid,\n                    params: {\n                        hotelrefno: GENERAL_SETTINGS.HOTELREFNO,\n                    },\n                }).then((res) => {\n                    if (res.status === 200) {\n                        uploadPhoto()\n                    } else {\n                        enqueueSnackbar(t('str_unexpectedProblem'), { variant: 'error' })\n                    }\n                })\n            } else {\n                uploadPhoto()\n            }\n        })\n    }\n\n    const cardPoints = state.memCardNext && Math.abs(((state.memCardNext.nextbonustotal - state.memCardNext.totalbonus) / state.memCardNext.totalbonus) * 100)\n\n    if(isKiosk){\n        return null\n    }\n\n    return (\n        <Accordion expanded={isExpended} onChange={handleChange} ref={accountBannerRef}>\n            <AccordionSummary expandIcon={<ExpandMoreIcon/>} aria-controls=\"panel1c-content\" id=\"panel1c-header\" classes={{ root: classes.rootCls, content: classes.contentCls }}>\n                {!isExpended && (\n                    <Grid container justify={'center'} alignItems={'center'}>\n                        <Grid item xs={12}>\n                            <Typography display={'block'} align={'center'} className={classes.memberFullName}>\n                                {clientBase && (global.helper.capitalizeWord((clientBase.firstname).toLowerCase()) + ' ' + (clientBase.lastname).toUpperCase())}\n                            </Typography>\n                        </Grid>\n                    </Grid>\n                )}\n            </AccordionSummary>\n            <AccordionDetails className={classes.details}>\n                <Container maxWidth=\"lg\">\n                    <Grid container justify={'center'} alignItems={'center'} spacing={3}>\n                        <Grid item xs={12} sm={6} md={4}>\n                            <Grid container justify={'center'} alignItems={'center'}>\n                                <Grid item sm={6}>\n                                    <Box position=\"relative\" display=\"inline-flex\">\n                                        <AvatarCircularProgress value={cardPoints}/>\n                                        <Box\n                                            top={0}\n                                            left={0}\n                                            bottom={0}\n                                            right={0}\n                                            position=\"absolute\"\n                                            display=\"flex\"\n                                            alignItems=\"center\"\n                                            justify=\"center\"\n                                        >\n                                            <Avatar\n                                                src={state.clientProfilePhoto ? state.clientProfilePhoto : ''}\n                                                classes={classesAvatar}\n                                                onClick={() => setProfilePhotoUpload(true)}\n                                            />\n                                        </Box>\n                                    </Box>\n                                    <DropzoneDialog\n                                        open={profilePhotoUpload}\n                                        onSave={handleProfilePhotoUpload}\n                                        acceptedFiles={['image/jpeg', 'image/png']}\n                                        showPreviews={true}\n                                        maxFileSize={5000000}\n                                        filesLimit={1}\n                                        onClose={() => setProfilePhotoUpload(false)}\n                                    />\n                                </Grid>\n                                <Grid item xs={12} sm={6}>\n                                    <List>\n                                        {clientBase && clientBase.cardtypecode &&\n                                        <ListItem>\n                                            <Typography className={classes.memberType}>\n                                                {(clientBase.cardtypecode + ' ' + t('str_member')).toUpperCase()}\n                                            </Typography>\n                                        </ListItem>\n                                        }\n                                        <ListItem>\n                                            <Typography className={classes.memberFullName}>\n                                                {clientBase && clientBase?.firstname && clientBase?.lastname && (global.helper.capitalizeWord((clientBase.firstname).toLowerCase()) + ' ' + (clientBase.lastname).toUpperCase())}\n                                            </Typography>\n                                        </ListItem>\n                                    </List>\n                                </Grid>\n                            </Grid>\n                        </Grid>\n                        <Grid item xs={12} md={4}>\n                            <Grid container>\n                                <Grid item xs={12}>\n                                    {isClientLoyaltyCardLoading ? (\n                                        <LoadingSpinner size={30}/>\n                                    ) : state?.clientLoyaltyCard ? (\n                                        (clientBase?.id ?\n                                            <div\n                                                dangerouslySetInnerHTML={{\n                                                    __html: state.clientLoyaltyCard && Buffer.from(state.clientLoyaltyCard, 'base64').toString('utf-8')\n                                                        .replaceAll('{fullname}', clientBase && clientBase.firstname + ' ' + clientBase.lastname)\n                                                        .replaceAll('{point}', new Intl.NumberFormat('en-IN', { maximumSignificantDigits: 3 }).format((state.bonusTransPoints && state.bonusTransPoints.bonusleft) || '0'))\n                                                        .replaceAll('{pts}', 'pts')\n                                                        .replaceAll('{cardno}', clientBase && clientBase.id)\n                                                        .replaceAll('{email}', clientBase && clientBase.email)\n                                                        .replaceAll('{str_bonusExpired}', t('str_bonusExpired'))\n                                                        .replaceAll('{bonusexpired}', new Intl.NumberFormat('en-IN', { maximumSignificantDigits: 3 }).format((state.bonusTransPoints && state.bonusTransPoints.bonusexpired) || '0'))\n                                                        .replaceAll('{str_bonusGained}', t('str_bonusGained'))\n                                                        .replaceAll('{bonusgained}', new Intl.NumberFormat('en-IN', { maximumSignificantDigits: 3 }).format((state.bonusTransPoints && state.bonusTransPoints.bonusgained) || '0'))\n                                                        .replaceAll('{str_bonusLeft}', t('str_bonusLeft'))\n                                                        .replaceAll('{bonusleft}', new Intl.NumberFormat('en-IN', { maximumSignificantDigits: 3 }).format((state.bonusTransPoints && state.bonusTransPoints.bonusleft) || '0'))\n                                                        .replaceAll('{str_bonusUsed}', t('str_bonusUsed'))\n                                                        .replaceAll('{bonusused}', new Intl.NumberFormat('en-IN', { maximumSignificantDigits: 3 }).format((state.bonusTransPoints && state.bonusTransPoints.bonusused) || '0'))\n                                                        .replaceAll('{str_bonusLeftHc}', t('str_bonusLeftHc'))\n                                                        .replaceAll('{bonuslefthc}', new Intl.NumberFormat('en-IN', { maximumSignificantDigits: 3 }).format((state.bonusTransPoints && state.bonusTransPoints.bonuslefthc) || '0'))\n                                                }}\n                                            /> : null)\n                                    ) : (clientBase?.id ?\n                                        <div className={classesLoyaltyCard.root}>\n                                        <Grid container alignItems={'center'} className={classes.cardContainer}>\n                                            <Grid item xs={12}>\n                                                <Typography className={classes.cardBonus}>\n                                                    <NumberFormat\n                                                        value={(state.bonusTransPoints && state.bonusTransPoints.bonusexpired) || '0'}\n                                                        displayType={'text'}\n                                                        decimalScale={2}\n                                                        isNumericString={true}\n                                                        thousandSeparator={true}\n                                                    />\n                                                    <span className={classes.cardPts}>{'pts'}</span>\n                                                </Typography>\n                                            </Grid>\n                                            <Grid item xs={12}>\n                                                <Grid container justify={'space-between'}>\n                                                    <Grid item xs={6}>\n                                                        <Typography noWrap className={classes.cardClientName}>\n                                                            {clientBase && clientBase.firstname} {clientBase && clientBase.lastname}\n                                                        </Typography>\n                                                    </Grid>\n                                                    <Grid item xs={6}>\n                                                        <Typography noWrap className={classes.cardClientId}>\n                                                            {clientBase && clientBase.id}\n                                                        </Typography>\n                                                    </Grid>\n                                                </Grid>\n                                            </Grid>\n                                        </Grid>\n                                    </div>: null)}\n                                </Grid>\n                            </Grid>\n                        </Grid>\n                        <Grid item xs={12} md={4}>\n                            <MyLoyalty/>\n                        </Grid>\n                    </Grid>\n                </Container>\n            </AccordionDetails>\n        </Accordion>\n    )\n}\n\nconst mapStateToProps = (state) => {\n    return {\n        state: state.formReducer.guest,\n    }\n}\n\nconst mapDispatchToProps = (dispatch) => ({\n    updateState: (stateType, stateName, value) => dispatch(updateState(stateType, stateName, value)),\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AccountBanner)\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _defineProperty from \"/Users/mata/app-cloudweb/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"/Users/mata/app-cloudweb/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"/Users/mata/app-cloudweb/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/mata/app-cloudweb/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/components/page/sections/image/EditImage.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect, useContext } from 'react'; //imports from material ui\n\nimport Grid from '@material-ui/core/Grid';\nimport Card from '@material-ui/core/Card';\nimport Fab from '@material-ui/core/Fab';\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\nimport IconButton from '@material-ui/core/IconButton';\nimport CancelIcon from '@material-ui/icons/Cancel';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Divider from '@material-ui/core/Divider'; //dropzone related imports\n\nimport 'regenerator-runtime/runtime';\nimport { DropzoneDialog } from 'material-ui-dropzone'; //import toaster\n\nimport { ToastContainer, toast } from 'react-toastify';\nimport { useRouter } from 'next/router';\nimport WebCmsGlobal from '../../../../../../webcms-global';\nimport { Delete, Insert, Patch, ViewList } from '@webcms/orest';\nimport { FIELDTYPE, isErrorMsg, OREST_ENDPOINT, OREST_UPLOAD } from '../../../../../../../model/orest/constants';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\nimport { COLORS, UPLOAD_SUCCESS, DELETE_SUCCESS, SAVED_SUCCESS, PERCENTAGE_VALUES } from '../../../../constants';\nimport LoadingSpinner from '../../../../../../LoadingSpinner';\nimport validator from 'validator';\nimport { PercentageSlider } from '../../../../../../../model/slider';\nimport { FormControlLabel } from '@material-ui/core';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport InputColor from 'react-input-color';\nimport TextEditor from '../text-editor';\nimport BorderColorSharpIcon from '@material-ui/icons/BorderColorSharp';\nimport { toSelfName } from './../../../../../../../lib/helpers/useFunction';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    root: {\n      '& > .fa': {\n        margin: theme.spacing(2)\n      },\n      card: {\n        maxWidth: 345\n      },\n      media: {\n        height: 0,\n        paddingTop: '56.25%' // 16:9\n\n      }\n    },\n    buttonStyle: {\n      marginTop: theme.spacing(1),\n      marginLeft: theme.spacing(1)\n    },\n    submit: {\n      marginRight: theme.spacing(1),\n      marginBottom: theme.spacing(1),\n      borderRadius: 20,\n      marginTop: theme.spacing(1),\n      \"float\": 'right'\n    },\n    paperBlock: {\n      height: 250,\n      border: \"2px solid \".concat(COLORS === null || COLORS === void 0 ? void 0 : COLORS.secondary),\n      overflow: 'auto',\n      position: 'relative'\n    },\n    card: {\n      height: 245,\n      width: 415,\n      cursor: 'pointer'\n    },\n    disableEvent: {\n      pointerEvents: 'none',\n      opacity: 0.5\n    },\n    heading: {\n      marginTop: theme.spacing(3),\n      marginLeft: theme.spacing(2),\n      fontWeight: 'bold',\n      fontSize: 15\n    },\n    textField: {\n      paddingRight: theme.spacing(1),\n      marginTop: theme.spacing(2)\n    },\n    alignText: {\n      textAlign: 'right',\n      color: 'red'\n    }\n  };\n});\n\nvar EditImage = function EditImage(props) {\n  _s();\n\n  var _state$assets, _state$assets$meta;\n\n  var imageComponent = props.imageComponent,\n      handleCmponent = props.handleCmponent,\n      state = props.state,\n      otherLangImage = props.otherLangImage,\n      handleDisable = props.handleDisable;\n\n  var _useState = useState([]),\n      images = _useState[0],\n      setImages = _useState[1];\n\n  var _useState2 = useState(false),\n      isDialogOpen = _useState2[0],\n      setDialogOpen = _useState2[1];\n\n  var _useState3 = useState(''),\n      imageTitle = _useState3[0],\n      setImageTitle = _useState3[1];\n\n  var _useState4 = useState(''),\n      imageDescription = _useState4[0],\n      setImageDescription = _useState4[1];\n\n  var _useState5 = useState(1),\n      itemCount = _useState5[0],\n      setItemCount = _useState5[1];\n\n  var _useState6 = useState(false),\n      showDeleteBtn = _useState6[0],\n      setShowDeleteBtn = _useState6[1];\n\n  var _useState7 = useState(false),\n      isDeleting = _useState7[0],\n      setIsDeleting = _useState7[1];\n\n  var _useState8 = useState(false),\n      isSaving = _useState8[0],\n      setIsSaving = _useState8[1];\n\n  var _useState9 = useState(''),\n      cta = _useState9[0],\n      setCta = _useState9[1];\n\n  var _useState10 = useState(false),\n      isOptimizeImage = _useState10[0],\n      setOptimizeImage = _useState10[1];\n\n  var _useState11 = useState(state !== null && state !== void 0 && (_state$assets = state.assets) !== null && _state$assets !== void 0 && (_state$assets$meta = _state$assets.meta) !== null && _state$assets$meta !== void 0 && _state$assets$meta.imageQuality ? state.assets.meta.imageQuality * 100 : 50),\n      quality = _useState11[0],\n      setQuality = _useState11[1];\n\n  var _useState12 = useState(imageComponent !== null && imageComponent !== void 0 && imageComponent.textColor ? imageComponent.textColor : '#000000'),\n      textColor = _useState12[0],\n      setTextColor = _useState12[1];\n\n  var imageID = '';\n\n  var _useState13 = useState({\n    isTextEditorDialogOpen: false,\n    editorValue: '',\n    dialogType: ''\n  }),\n      localState = _useState13[0],\n      setLocalState = _useState13[1];\n\n  var dialogType = localState.dialogType,\n      editorValue = localState.editorValue,\n      isTextEditorDialogOpen = localState.isTextEditorDialogOpen;\n  var router = useRouter();\n  var companyId = router.query.companyID;\n\n  var _useContext = useContext(WebCmsGlobal),\n      GENERAL_SETTINGS = _useContext.GENERAL_SETTINGS,\n      token = _useContext.token;\n\n  var authToken = token || router.query.authToken;\n  var classes = useStyles();\n  useEffect(function () {\n    if (images.length > 0) {\n      handleDisable(false);\n\n      if (state.langCode === state.defaultLang) {\n        handleCmponent({\n          service: 'hcmitemimg',\n          type: 'image',\n          gid: images[0].gid,\n          width: imageComponent.width,\n          id: imageComponent.id,\n          textColor: textColor\n        });\n      } else {\n        handleCmponent({\n          image: {\n            title: imageTitle,\n            description: imageDescription\n          }\n        });\n      }\n    } else {\n      handleDisable(true);\n    }\n  }, [images, imageTitle, imageDescription, textColor]);\n  useEffect(function () {\n    if (imageComponent && imageComponent.gid) {\n      setIsSaving(true);\n      ViewList({\n        apiUrl: GENERAL_SETTINGS.OREST_URL,\n        endpoint: OREST_ENDPOINT.HCMITEMIMG,\n        token: authToken,\n        params: {\n          query: \"gid:\".concat(imageComponent.gid),\n          sort: 'orderno',\n          hotelrefno: Number(companyId)\n        }\n      }).then(function (res) {\n        var _res$data, _res$data$data;\n\n        setIsSaving(false);\n\n        if (res.status === 200 && (res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : (_res$data$data = _res$data.data) === null || _res$data$data === void 0 ? void 0 : _res$data$data.length) > 0) {\n          var _updatedImages$5;\n\n          var updatedImages = [];\n          res.data.data.map( /*#__PURE__*/function () {\n            var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(data) {\n              return _regeneratorRuntime.wrap(function _callee$(_context) {\n                while (1) {\n                  switch (_context.prev = _context.next) {\n                    case 0:\n                      updatedImages.push(data);\n\n                    case 1:\n                    case \"end\":\n                      return _context.stop();\n                  }\n                }\n              }, _callee);\n            }));\n\n            return function (_x) {\n              return _ref.apply(this, arguments);\n            };\n          }());\n          setImages(updatedImages);\n          setQuality(res.data.data[0].imgquality * 100);\n\n          if (state.langCode === state.defaultLang) {\n            if (updatedImages.length > 0) {\n              var _updatedImages$, _updatedImages$2, _updatedImages$3, _updatedImages$4;\n\n              ((_updatedImages$ = updatedImages[0]) === null || _updatedImages$ === void 0 ? void 0 : _updatedImages$.title) && setImageTitle((_updatedImages$2 = updatedImages[0]) === null || _updatedImages$2 === void 0 ? void 0 : _updatedImages$2.title);\n              ((_updatedImages$3 = updatedImages[0]) === null || _updatedImages$3 === void 0 ? void 0 : _updatedImages$3.description) && setImageDescription((_updatedImages$4 = updatedImages[0]) === null || _updatedImages$4 === void 0 ? void 0 : _updatedImages$4.description);\n            }\n          } else {\n            setImageTitle(otherLangImage.image.title);\n            setImageDescription(otherLangImage.image.description);\n          }\n\n          setCta((_updatedImages$5 = updatedImages[0]) === null || _updatedImages$5 === void 0 ? void 0 : _updatedImages$5.cta);\n        } else {\n          var retErr = isErrorMsg(res);\n          toast.error(retErr.errorMsg, {\n            position: toast.POSITION.TOP_RIGHT\n          });\n        }\n      });\n    }\n  }, [imageComponent.gid]);\n\n  var openDialog = function openDialog() {\n    //it opens dialog for image upload\n    setDialogOpen(true);\n  };\n\n  var closeDialog = function closeDialog() {\n    ////it closes dialog for image upload\n    setDialogOpen(false);\n  };\n\n  var ImageUpload = function ImageUpload(apiUrl, endPoint, token, masterID, file) {\n    var url = apiUrl + '/' + endPoint + OREST_UPLOAD;\n    var binaryData = [];\n    binaryData.push(file);\n    var formData = new FormData();\n    formData.append('file', new Blob(binaryData, {\n      type: file.type\n    }), toSelfName(file.name));\n    var options = {\n      url: url,\n      method: 'post',\n      headers: {\n        Authorization: \"Bearer \".concat(token),\n        'Content-Type': 'multipart/form-data'\n      },\n      params: {\n        orsactive: true,\n        masterid: masterID,\n        quality: quality / 100,\n        scale: quality / 100,\n        hotelrefno: companyId\n      },\n      data: formData\n    };\n    return axios(options).then(function (response) {\n      return response;\n    })[\"catch\"](function (error) {\n      return error.response || {\n        status: 0\n      };\n    });\n  };\n\n  function asyncUpload(file, itemTreated, callback) {\n    if (state.hcmItemId) {\n      setTimeout(function () {\n        Insert({\n          apiUrl: GENERAL_SETTINGS.OREST_URL,\n          endpoint: OREST_ENDPOINT.HCMITEMIMG,\n          token: authToken,\n          data: {\n            itemid: state.hcmItemId,\n            imgtype: FIELDTYPE.IMG,\n            orderno: itemTreated,\n            imgquality: quality / 100,\n            imgscale: quality / 100,\n            hotelrefno: Number(companyId)\n          }\n        }).then(function (r1) {\n          if (r1.status === 200) {\n            imageID = r1.data.data.id;\n            ImageUpload(GENERAL_SETTINGS.OREST_URL, OREST_ENDPOINT.RAFILE, authToken, r1.data.data.mid, file).then(function (r) {\n              if (r.status === 200) {\n                callback();\n              } else {\n                callback();\n              }\n            });\n          } else {\n            callback();\n          }\n        });\n      }, 100);\n    }\n  }\n\n  var saveImage = function saveImage(files) {\n    setIsSaving(true);\n    var req = files.map(function (file) {\n      return new Promise(function (resolve) {\n        asyncUpload(file, itemCount, resolve);\n        setItemCount(function (itemCount) {\n          return itemCount + 1;\n        });\n      });\n    });\n    Promise.all(req).then(function () {\n      ViewList({\n        apiUrl: GENERAL_SETTINGS.OREST_URL,\n        endpoint: OREST_ENDPOINT.HCMITEMIMG,\n        token: authToken,\n        params: {\n          query: \"id:\".concat(imageID),\n          sort: 'orderno',\n          hotelrefno: Number(companyId)\n        }\n      }).then(function (res) {\n        setIsSaving(false);\n\n        if (res.status === 200) {\n          var updatedImages = _toConsumableArray(images);\n\n          res.data.data.map(function (data) {\n            updatedImages.push(data);\n          });\n          setImages(updatedImages);\n\n          if (updatedImages.length > 0) {\n            setImageTitle(updatedImages[0].title);\n            setImageDescription(updatedImages[0].description);\n          }\n\n          toast.success(UPLOAD_SUCCESS, {\n            position: toast.POSITION.TOP_RIGHT\n          });\n          closeDialog();\n        } else {\n          var retErr = isErrorMsg(res);\n          toast.error(retErr.errorMsg, {\n            position: toast.POSITION.TOP_RIGHT\n          });\n        }\n      });\n    });\n  };\n\n  var deleteImage = function deleteImage() {\n    setIsDeleting(true);\n    Delete({\n      apiUrl: GENERAL_SETTINGS.OREST_URL,\n      endpoint: OREST_ENDPOINT.HCMITEMIMG,\n      token: authToken,\n      gid: images[0].gid,\n      params: {\n        hotelrefno: Number(companyId)\n      }\n    }).then(function (res) {\n      if (res.status === 200) {\n        setIsDeleting(false);\n        setImages([]);\n        setImageTitle('');\n        setImageDescription('');\n        toast.success(DELETE_SUCCESS, {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      } else {\n        var retErr = isErrorMsg(res);\n        toast.error(retErr.errorMsg, {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      }\n    });\n  };\n\n  var handleUpdateTitleDescription = function handleUpdateTitleDescription() {\n    setIsSaving(true);\n\n    if (state.langCode === state.defaultLang) {\n      Patch({\n        // update title and description\n        apiUrl: GENERAL_SETTINGS.OREST_URL,\n        endpoint: OREST_ENDPOINT.HCMITEMIMG,\n        token: authToken,\n        gid: images[0].gid,\n        params: {\n          hotelrefno: Number(companyId)\n        },\n        data: {\n          title: imageTitle,\n          description: imageDescription,\n          cta: cta\n        }\n      }).then(function (res) {\n        setIsSaving(false);\n\n        if (res.status === 200) {\n          toast.success(SAVED_SUCCESS, {\n            position: toast.POSITION.TOP_RIGHT\n          });\n        } else {\n          var retErr = isErrorMsg(res);\n          toast.error(retErr.errorMsg, {\n            position: toast.POSITION.TOP_RIGHT\n          });\n        }\n      });\n    } else {\n      setTimeout(function () {\n        setIsSaving(false);\n        toast.success(SAVED_SUCCESS, {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      }, 1000);\n    }\n  };\n\n  var handleImageQualityChange = function handleImageQualityChange(value) {\n    if (value >= 10 && value <= 90 && value % 10 === 0) {\n      if (images !== null && images !== void 0 && images.length) {\n        Patch({\n          // update image\n          apiUrl: GENERAL_SETTINGS.OREST_URL,\n          endpoint: OREST_ENDPOINT.HCMITEMIMG,\n          token: authToken,\n          gid: images[0].gid,\n          params: {\n            hotelrefno: Number(companyId)\n          },\n          data: {\n            imgquality: value / 100,\n            imgscale: value / 100\n          }\n        }).then(function (res1) {\n          var _res1$data;\n\n          if ((res1 === null || res1 === void 0 ? void 0 : res1.status) === 200 && res1 !== null && res1 !== void 0 && (_res1$data = res1.data) !== null && _res1$data !== void 0 && _res1$data.data) {\n            setQuality(value);\n          } else {\n            var retErr = isErrorMsg(res);\n            toast.error(retErr.errorMsg, {\n              position: toast.POSITION.TOP_RIGHT\n            });\n          }\n        });\n      } else {\n        setQuality(value);\n      }\n    }\n  };\n\n  var handleDialogOpen = function handleDialogOpen(type) {\n    if (type === 'title') {\n      setLocalState(function (prev) {\n        return _objectSpread(_objectSpread({}, prev), {}, {\n          isTextEditorDialogOpen: true,\n          dialogType: type,\n          editorValue: imageTitle\n        });\n      });\n    }\n\n    if (type === 'description') {\n      setLocalState(function (prev) {\n        return _objectSpread(_objectSpread({}, prev), {}, {\n          isTextEditorDialogOpen: true,\n          dialogType: type,\n          editorValue: imageDescription\n        });\n      });\n    }\n  };\n\n  var handleTextEditorValue = function handleTextEditorValue(value) {\n    if (dialogType === 'title') {\n      setImageTitle(value);\n    }\n\n    if (dialogType === 'description') {\n      setImageDescription(value);\n    }\n\n    setLocalState(function (prev) {\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        isTextEditorDialogOpen: false,\n        dialogType: '',\n        editorValue: ''\n      });\n    });\n  };\n\n  var handleCancelEditor = function handleCancelEditor() {\n    setLocalState(function (prev) {\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        isTextEditorDialogOpen: false,\n        dialogType: '',\n        editorValue: ''\n      });\n    });\n  };\n\n  if (isSaving) {\n    return __jsx(LoadingSpinner, {\n      style: {\n        color: COLORS.secondary\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 452,\n        columnNumber: 16\n      }\n    });\n  }\n\n  return __jsx(React.Fragment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 456,\n      columnNumber: 9\n    }\n  }, __jsx(React.Fragment, null, __jsx(Grid, {\n    container: true,\n    justify: 'flex-start',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 458,\n      columnNumber: 17\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 6,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 459,\n      columnNumber: 21\n    }\n  }, __jsx(FormControlLabel, {\n    className: classes.labelFont,\n    control: __jsx(Checkbox, {\n      size: 'small',\n      checked: isOptimizeImage,\n      onChange: function onChange() {\n        return setOptimizeImage(!isOptimizeImage);\n      },\n      color: \"primary\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 463,\n        columnNumber: 33\n      }\n    }),\n    label: \"Optimize Images\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 460,\n      columnNumber: 25\n    }\n  })), __jsx(Grid, {\n    item: true,\n    xs: 6,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 473,\n      columnNumber: 21\n    }\n  }, __jsx(Grid, {\n    container: true,\n    justify: 'flex-end',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 474,\n      columnNumber: 25\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 1,\n    style: {\n      marginTop: 8\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 475,\n      columnNumber: 29\n    }\n  }, __jsx(Typography, {\n    component: 'span',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 476,\n      columnNumber: 33\n    }\n  }, \"Text\")), __jsx(Grid, {\n    item: true,\n    xs: 2,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 478,\n      columnNumber: 29\n    }\n  }, __jsx(InputColor, {\n    onChange: function onChange(color) {\n      return setTextColor(color.hex);\n    },\n    placement: \"right\",\n    initialValue: textColor,\n    style: {\n      marginTop: 8\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 479,\n      columnNumber: 33\n    }\n  }))))), __jsx(Grid, {\n    container: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 489,\n      columnNumber: 17\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 12,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 490,\n      columnNumber: 21\n    }\n  }, isOptimizeImage && __jsx(PercentageSlider, {\n    marks: PERCENTAGE_VALUES,\n    value: quality,\n    onChange: function onChange(e, value) {\n      return handleImageQualityChange(value);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 492,\n      columnNumber: 29\n    }\n  }))), __jsx(Grid, {\n    container: true,\n    justify: 'flex-start',\n    spacing: 3,\n    className: isDeleting ? classes.disableEvent : '',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 500,\n      columnNumber: 17\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 6,\n    className: state.langCode !== state.defaultLang ? classes.disableEvent : '',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 506,\n      columnNumber: 21\n    }\n  }, __jsx(Paper, {\n    className: classes.paperBlock,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 511,\n      columnNumber: 25\n    }\n  }, images.map(function (value, index) {\n    return __jsx(Grid, {\n      container: true,\n      key: index,\n      justify: 'center',\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 514,\n        columnNumber: 37\n      }\n    }, __jsx(Grid, {\n      key: index,\n      item: true,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 515,\n        columnNumber: 41\n      }\n    }, __jsx(Card, {\n      className: classes.card,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 516,\n        columnNumber: 45\n      }\n    }, __jsx(\"div\", {\n      style: {\n        backgroundImage: \"url(\".concat(GENERAL_SETTINGS.STATIC_URL + value.fileurl, \")\"),\n        height: '100%',\n        width: '100%',\n        backgroundSize: 'cover'\n      },\n      onMouseEnter: function onMouseEnter() {\n        return setShowDeleteBtn(true);\n      },\n      onMouseLeave: function onMouseLeave() {\n        return setShowDeleteBtn(false);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 517,\n        columnNumber: 49\n      }\n    }, showDeleteBtn && __jsx(IconButton, {\n      onClick: deleteImage,\n      className: state.langCode !== state.defaultLang ? classes.disableEvent : '',\n      \"aria-label\": \"upload picture\",\n      component: \"span\",\n      style: {\n        \"float\": 'right'\n      },\n      color: 'primary',\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 530,\n        columnNumber: 57\n      }\n    }, __jsx(CancelIcon, {\n      style: {\n        width: 30,\n        height: 30\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 542,\n        columnNumber: 61\n      }\n    }))))));\n  }), images.length === 0 && __jsx(Typography, {\n    component: 'div',\n    style: {\n      height: 250,\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 552,\n      columnNumber: 33\n    }\n  }, __jsx(Fab, {\n    onClick: openDialog,\n    variant: \"extended\",\n    size: \"small\",\n    color: \"primary\",\n    \"aria-label\": \"add\",\n    className: classes.fabBtn,\n    disabled: images.length > 0,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 561,\n      columnNumber: 37\n    }\n  }, __jsx(CloudUploadIcon, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 570,\n      columnNumber: 41\n    }\n  }), \"UPLOAD\")), __jsx(DropzoneDialog, {\n    open: isDialogOpen,\n    onSave: saveImage,\n    acceptedFiles: ['image/jpeg', 'image/png', 'image/bmp'],\n    showPreviews: true,\n    maxFileSize: 5000000,\n    onClose: closeDialog,\n    filesLimit: 10,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 575,\n      columnNumber: 29\n    }\n  }))), __jsx(Grid, {\n    item: true,\n    xs: 6,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 586,\n      columnNumber: 21\n    }\n  }, __jsx(Paper, {\n    className: classes.paperBlock,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 587,\n      columnNumber: 25\n    }\n  }, __jsx(Grid, {\n    container: true,\n    justify: 'flex-start',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 588,\n      columnNumber: 29\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 3,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 589,\n      columnNumber: 33\n    }\n  }, __jsx(Typography, {\n    component: 'h6',\n    variant: 'h6',\n    className: classes.heading,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 590,\n      columnNumber: 37\n    }\n  }, \"Title\")), __jsx(Grid, {\n    item: true,\n    xs: 9,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 594,\n      columnNumber: 33\n    }\n  }, __jsx(IconButton, {\n    \"aria-label\": \"Edit Title\",\n    color: \"primary\",\n    onClick: function onClick() {\n      return handleDialogOpen('title');\n    },\n    style: {\n      \"float\": 'right'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 595,\n      columnNumber: 37\n    }\n  }, __jsx(BorderColorSharpIcon, {\n    color: \"primary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 601,\n      columnNumber: 41\n    }\n  })))), __jsx(Grid, {\n    container: true,\n    justify: 'flex-start',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 605,\n      columnNumber: 29\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 3,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 606,\n      columnNumber: 33\n    }\n  }, __jsx(Typography, {\n    component: 'h6',\n    variant: 'h6',\n    className: classes.heading,\n    size: 'small',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 607,\n      columnNumber: 37\n    }\n  }, \"Description\")), __jsx(Grid, {\n    item: true,\n    xs: 9,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 616,\n      columnNumber: 33\n    }\n  }, __jsx(IconButton, {\n    \"aria-label\": \"Edit Title\",\n    color: \"primary\",\n    onClick: function onClick() {\n      return handleDialogOpen('description');\n    },\n    style: {\n      \"float\": 'right'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 617,\n      columnNumber: 37\n    }\n  }, __jsx(BorderColorSharpIcon, {\n    color: \"primary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 623,\n      columnNumber: 41\n    }\n  })))), (state.type === 'email' || state.type === 'emailOnly') && __jsx(Grid, {\n    container: true,\n    justify: 'flex-start',\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 628,\n      columnNumber: 33\n    }\n  }, __jsx(Grid, {\n    item: true,\n    xs: 3,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 629,\n      columnNumber: 37\n    }\n  }, __jsx(Typography, {\n    component: 'h6',\n    variant: 'h6',\n    className: classes.heading,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 630,\n      columnNumber: 41\n    }\n  }, \"Link\")), __jsx(Grid, {\n    item: true,\n    xs: 9,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 634,\n      columnNumber: 37\n    }\n  }, __jsx(TextField, {\n    id: \"image-description\",\n    variant: 'outlined',\n    fullWidth: true,\n    placeholder: 'Please Link here',\n    onChange: function onChange(e) {\n      return setCta(e.target.value);\n    },\n    size: 'small',\n    className: classes.textField,\n    error: cta && !validator.isURL(cta),\n    value: cta,\n    disabled: state.langCode !== state.defaultLang,\n    helperText: cta && __jsx(Typography, {\n      variant: \"caption\",\n      className: classes.alignText,\n      display: \"block\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 648,\n        columnNumber: 53\n      }\n    }, \"\".concat(cta === null || cta === void 0 ? void 0 : cta.length, \" < 100\")),\n    inputProps: {\n      maxLength: 99\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 635,\n      columnNumber: 41\n    }\n  }))), __jsx(Divider, {\n    style: {\n      marginTop: 8\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 662,\n      columnNumber: 29\n    }\n  }), __jsx(Button, {\n    onClick: handleUpdateTitleDescription,\n    variant: \"contained\",\n    size: \"small\",\n    color: \"primary\",\n    \"aria-label\": \"submit\",\n    className: classes.submit,\n    disabled: !imageTitle && !imageDescription,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 663,\n      columnNumber: 29\n    }\n  }, \"SUBMIT\"))))), isTextEditorDialogOpen && __jsx(TextEditor, {\n    handleSaveTextEditor: handleTextEditorValue,\n    handleCancelTextEditor: handleCancelEditor,\n    data: editorValue,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 679,\n      columnNumber: 17\n    }\n  }));\n};\n\n_s(EditImage, \"2HW4zZaluAMlh6Jbir8tPUdHtdI=\", false, function () {\n  return [useRouter, useStyles];\n});\n\n_c = EditImage;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    state: state.formReducer.pageBuilder\n  };\n};\n\nexport default connect(mapStateToProps)(EditImage);\n\nvar _c;\n\n$RefreshReg$(_c, \"EditImage\");","map":{"version":3,"sources":["/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/components/page/sections/image/EditImage.js"],"names":["React","useState","useEffect","useContext","Grid","Card","Fab","CloudUploadIcon","TextField","Button","Paper","Typography","IconButton","CancelIcon","makeStyles","Divider","DropzoneDialog","ToastContainer","toast","useRouter","WebCmsGlobal","Delete","Insert","Patch","ViewList","FIELDTYPE","isErrorMsg","OREST_ENDPOINT","OREST_UPLOAD","axios","connect","COLORS","UPLOAD_SUCCESS","DELETE_SUCCESS","SAVED_SUCCESS","PERCENTAGE_VALUES","LoadingSpinner","validator","PercentageSlider","FormControlLabel","Checkbox","InputColor","TextEditor","BorderColorSharpIcon","toSelfName","useStyles","theme","root","margin","spacing","card","maxWidth","media","height","paddingTop","buttonStyle","marginTop","marginLeft","submit","marginRight","marginBottom","borderRadius","paperBlock","border","secondary","overflow","position","width","cursor","disableEvent","pointerEvents","opacity","heading","fontWeight","fontSize","textField","paddingRight","alignText","textAlign","color","EditImage","props","imageComponent","handleCmponent","state","otherLangImage","handleDisable","images","setImages","isDialogOpen","setDialogOpen","imageTitle","setImageTitle","imageDescription","setImageDescription","itemCount","setItemCount","showDeleteBtn","setShowDeleteBtn","isDeleting","setIsDeleting","isSaving","setIsSaving","cta","setCta","isOptimizeImage","setOptimizeImage","assets","meta","imageQuality","quality","setQuality","textColor","setTextColor","imageID","isTextEditorDialogOpen","editorValue","dialogType","localState","setLocalState","router","companyId","query","companyID","GENERAL_SETTINGS","token","authToken","classes","length","langCode","defaultLang","service","type","gid","id","image","title","description","apiUrl","OREST_URL","endpoint","HCMITEMIMG","params","sort","hotelrefno","Number","then","res","status","data","updatedImages","map","push","imgquality","retErr","error","errorMsg","POSITION","TOP_RIGHT","openDialog","closeDialog","ImageUpload","endPoint","masterID","file","url","binaryData","formData","FormData","append","Blob","name","options","method","headers","Authorization","orsactive","masterid","scale","response","asyncUpload","itemTreated","callback","hcmItemId","setTimeout","itemid","imgtype","IMG","orderno","imgscale","r1","RAFILE","mid","r","saveImage","files","req","Promise","resolve","all","success","deleteImage","handleUpdateTitleDescription","handleImageQualityChange","value","res1","handleDialogOpen","prev","handleTextEditorValue","handleCancelEditor","labelFont","hex","e","index","backgroundImage","STATIC_URL","fileurl","backgroundSize","display","alignItems","justifyContent","fabBtn","target","isURL","maxLength","mapStateToProps","formReducer","pageBuilder"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react'\n//imports from material ui\nimport Grid from '@material-ui/core/Grid'\nimport Card from '@material-ui/core/Card'\nimport Fab from '@material-ui/core/Fab'\nimport CloudUploadIcon from '@material-ui/icons/CloudUpload'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport { makeStyles } from '@material-ui/core/styles'\nimport Divider from '@material-ui/core/Divider'\n//dropzone related imports\nimport 'regenerator-runtime/runtime'\nimport { DropzoneDialog } from 'material-ui-dropzone'\n//import toaster\nimport { ToastContainer, toast } from 'react-toastify'\n\nimport { useRouter } from 'next/router'\nimport WebCmsGlobal from '../../../../../../webcms-global'\nimport { Delete, Insert, Patch, ViewList } from '@webcms/orest'\nimport { FIELDTYPE, isErrorMsg, OREST_ENDPOINT, OREST_UPLOAD } from '../../../../../../../model/orest/constants'\n\nimport axios from 'axios'\nimport { connect } from 'react-redux'\nimport { COLORS, UPLOAD_SUCCESS, DELETE_SUCCESS, SAVED_SUCCESS, PERCENTAGE_VALUES } from '../../../../constants'\nimport LoadingSpinner from '../../../../../../LoadingSpinner'\nimport validator from 'validator'\nimport { PercentageSlider } from '../../../../../../../model/slider'\nimport { FormControlLabel } from '@material-ui/core'\nimport Checkbox from '@material-ui/core/Checkbox'\nimport InputColor from 'react-input-color'\nimport TextEditor from '../text-editor'\nimport BorderColorSharpIcon from '@material-ui/icons/BorderColorSharp';\nimport { toSelfName } from './../../../../../../../lib/helpers/useFunction';\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        '& > .fa': {\n            margin: theme.spacing(2),\n        },\n        card: {\n            maxWidth: 345,\n        },\n        media: {\n            height: 0,\n            paddingTop: '56.25%', // 16:9\n        },\n    },\n    buttonStyle: {\n        marginTop: theme.spacing(1),\n        marginLeft: theme.spacing(1),\n    },\n    submit: {\n        marginRight: theme.spacing(1),\n        marginBottom: theme.spacing(1),\n        borderRadius: 20,\n        marginTop: theme.spacing(1),\n        float: 'right',\n    },\n    paperBlock: {\n        height: 250,\n        border: `2px solid ${COLORS?.secondary}`,\n        overflow: 'auto',\n        position: 'relative',\n    },\n    card: {\n        height: 245,\n        width: 415,\n        cursor: 'pointer',\n    },\n    disableEvent: {\n        pointerEvents: 'none',\n        opacity: 0.5,\n    },\n    heading: {\n        marginTop: theme.spacing(3),\n        marginLeft: theme.spacing(2),\n        fontWeight: 'bold',\n        fontSize: 15,\n    },\n    textField: {\n        paddingRight: theme.spacing(1),\n        marginTop: theme.spacing(2),\n    },\n    alignText: {\n        textAlign: 'right',\n        color: 'red',\n    },\n}))\n\nconst EditImage = (props) => {\n    const { imageComponent, handleCmponent, state, otherLangImage, handleDisable } = props\n    const [images, setImages] = useState([])\n    const [isDialogOpen, setDialogOpen] = useState(false)\n    const [imageTitle, setImageTitle] = useState('')\n    const [imageDescription, setImageDescription] = useState('')\n    const [itemCount, setItemCount] = useState(1)\n    const [showDeleteBtn, setShowDeleteBtn] = useState(false)\n    const [isDeleting, setIsDeleting] = useState(false)\n    const [isSaving, setIsSaving] = useState(false)\n    const [cta, setCta] = useState('')\n    const [isOptimizeImage, setOptimizeImage] = useState(false)\n    const [quality, setQuality] = useState(\n        state?.assets?.meta?.imageQuality ? state.assets.meta.imageQuality * 100 : 50\n    )\n    const [textColor, setTextColor] = useState(imageComponent?.textColor ? imageComponent.textColor : '#000000')\n    let imageID = ''\n    const [localState, setLocalState] = useState({\n        isTextEditorDialogOpen: false,\n        editorValue: '',\n        dialogType: '',\n    })\n\n    const { dialogType, editorValue, isTextEditorDialogOpen } = localState\n\n    const router = useRouter()\n    const companyId = router.query.companyID\n    const { GENERAL_SETTINGS, token } = useContext(WebCmsGlobal)\n    const authToken = token || router.query.authToken\n\n    const classes = useStyles()\n\n    useEffect(() => {\n        if (images.length > 0) {\n            handleDisable(false)\n            if (state.langCode === state.defaultLang) {\n                handleCmponent({\n                    service: 'hcmitemimg',\n                    type: 'image',\n                    gid: images[0].gid,\n                    width: imageComponent.width,\n                    id: imageComponent.id,\n                    textColor: textColor,\n                })\n            } else {\n                handleCmponent({\n                    image: {\n                        title: imageTitle,\n                        description: imageDescription,\n                    },\n                })\n            }\n        } else {\n            handleDisable(true)\n        }\n    }, [images, imageTitle, imageDescription, textColor])\n\n    useEffect(() => {\n        if (imageComponent && imageComponent.gid) {\n            setIsSaving(true)\n            ViewList({\n                apiUrl: GENERAL_SETTINGS.OREST_URL,\n                endpoint: OREST_ENDPOINT.HCMITEMIMG,\n                token: authToken,\n                params: {\n                    query: `gid:${imageComponent.gid}`,\n                    sort: 'orderno',\n                    hotelrefno: Number(companyId),\n                },\n            }).then((res) => {\n                setIsSaving(false)\n                if (res.status === 200 && res?.data?.data?.length > 0) {\n                    let updatedImages = []\n                    res.data.data.map(async (data) => {\n                        updatedImages.push(data)\n                    })\n                    setImages(updatedImages)\n                    setQuality(res.data.data[0].imgquality * 100)\n                    if (state.langCode === state.defaultLang) {\n                        if (updatedImages.length > 0) {\n                            updatedImages[0]?.title && setImageTitle(updatedImages[0]?.title)\n                            updatedImages[0]?.description && setImageDescription(updatedImages[0]?.description)\n                        }\n                    } else {\n                        setImageTitle(otherLangImage.image.title)\n                        setImageDescription(otherLangImage.image.description)\n                    }\n                    setCta(updatedImages[0]?.cta)\n                } else {\n                    const retErr = isErrorMsg(res)\n                    toast.error(retErr.errorMsg, {\n                        position: toast.POSITION.TOP_RIGHT,\n                    })\n                }\n            })\n        }\n    }, [imageComponent.gid])\n\n    const openDialog = () => {\n        //it opens dialog for image upload\n        setDialogOpen(true)\n    }\n\n    const closeDialog = () => {\n        ////it closes dialog for image upload\n        setDialogOpen(false)\n    }\n\n    const ImageUpload = (apiUrl, endPoint, token, masterID, file) => {\n        const url = apiUrl + '/' + endPoint + OREST_UPLOAD\n        let binaryData = []\n        binaryData.push(file)\n        let formData = new FormData()\n        formData.append('file', new Blob(binaryData, { type: file.type }), toSelfName(file.name))\n\n        const options = {\n            url: url,\n            method: 'post',\n            headers: {\n                Authorization: `Bearer ${token}`,\n                'Content-Type': 'multipart/form-data',\n            },\n            params: {\n                orsactive: true,\n                masterid: masterID,\n                quality: quality / 100,\n                scale: quality / 100,\n                hotelrefno: companyId,\n            },\n            data: formData,\n        }\n\n        return axios(options)\n            .then((response) => {\n                return response\n            })\n            .catch((error) => {\n                return error.response || { status: 0 }\n            })\n    }\n\n    function asyncUpload(file, itemTreated, callback) {\n        if (state.hcmItemId) {\n            setTimeout(() => {\n                Insert({\n                    apiUrl: GENERAL_SETTINGS.OREST_URL,\n                    endpoint: OREST_ENDPOINT.HCMITEMIMG,\n                    token: authToken,\n                    data: {\n                        itemid: state.hcmItemId,\n                        imgtype: FIELDTYPE.IMG,\n                        orderno: itemTreated,\n                        imgquality: quality / 100,\n                        imgscale: quality / 100,\n                        hotelrefno: Number(companyId),\n                    },\n                }).then((r1) => {\n                    if (r1.status === 200) {\n                        imageID = r1.data.data.id\n                        ImageUpload(\n                            GENERAL_SETTINGS.OREST_URL,\n                            OREST_ENDPOINT.RAFILE,\n                            authToken,\n                            r1.data.data.mid,\n                            file\n                        ).then((r) => {\n                            if (r.status === 200) {\n                                callback()\n                            } else {\n                                callback()\n                            }\n                        })\n                    } else {\n                        callback()\n                    }\n                })\n            }, 100)\n        }\n    }\n\n    const saveImage = (files) => {\n        setIsSaving(true)\n        let req = files.map((file) => {\n            return new Promise((resolve) => {\n                asyncUpload(file, itemCount, resolve)\n                setItemCount((itemCount) => itemCount + 1)\n            })\n        })\n        Promise.all(req).then(() => {\n            ViewList({\n                apiUrl: GENERAL_SETTINGS.OREST_URL,\n                endpoint: OREST_ENDPOINT.HCMITEMIMG,\n                token: authToken,\n                params: {\n                    query: `id:${imageID}`,\n                    sort: 'orderno',\n                    hotelrefno: Number(companyId),\n                },\n            }).then((res) => {\n                setIsSaving(false)\n                if (res.status === 200) {\n                    let updatedImages = [...images]\n                    res.data.data.map((data) => {\n                        updatedImages.push(data)\n                    })\n                    setImages(updatedImages)\n                    if (updatedImages.length > 0) {\n                        setImageTitle(updatedImages[0].title)\n                        setImageDescription(updatedImages[0].description)\n                    }\n                    toast.success(UPLOAD_SUCCESS, {\n                        position: toast.POSITION.TOP_RIGHT,\n                    })\n                    closeDialog()\n                } else {\n                    const retErr = isErrorMsg(res)\n                    toast.error(retErr.errorMsg, {\n                        position: toast.POSITION.TOP_RIGHT,\n                    })\n                }\n            })\n        })\n    }\n\n    const deleteImage = () => {\n        setIsDeleting(true)\n        Delete({\n            apiUrl: GENERAL_SETTINGS.OREST_URL,\n            endpoint: OREST_ENDPOINT.HCMITEMIMG,\n            token: authToken,\n            gid: images[0].gid,\n            params: {\n                hotelrefno: Number(companyId),\n            },\n        }).then((res) => {\n            if (res.status === 200) {\n                setIsDeleting(false)\n                setImages([])\n                setImageTitle('')\n                setImageDescription('')\n                toast.success(DELETE_SUCCESS, {\n                    position: toast.POSITION.TOP_RIGHT,\n                })\n            } else {\n                const retErr = isErrorMsg(res)\n                toast.error(retErr.errorMsg, {\n                    position: toast.POSITION.TOP_RIGHT,\n                })\n            }\n        })\n    }\n\n    const handleUpdateTitleDescription = () => {\n        setIsSaving(true)\n        if (state.langCode === state.defaultLang) {\n            Patch({\n                // update title and description\n                apiUrl: GENERAL_SETTINGS.OREST_URL,\n                endpoint: OREST_ENDPOINT.HCMITEMIMG,\n                token: authToken,\n                gid: images[0].gid,\n                params: {\n                    hotelrefno: Number(companyId),\n                },\n                data: {\n                    title: imageTitle,\n                    description: imageDescription,\n                    cta: cta,\n                },\n            }).then((res) => {\n                setIsSaving(false)\n                if (res.status === 200) {\n                    toast.success(SAVED_SUCCESS, {\n                        position: toast.POSITION.TOP_RIGHT,\n                    })\n                } else {\n                    const retErr = isErrorMsg(res)\n                    toast.error(retErr.errorMsg, {\n                        position: toast.POSITION.TOP_RIGHT,\n                    })\n                }\n            })\n        } else {\n            setTimeout(() => {\n                setIsSaving(false)\n                toast.success(SAVED_SUCCESS, {\n                    position: toast.POSITION.TOP_RIGHT,\n                })\n            }, 1000)\n        }\n    }\n\n    const handleImageQualityChange = (value) => {\n        if (value >= 10 && value <= 90 && value % 10 === 0) {\n            if (images?.length) {\n                Patch({\n                    // update image\n                    apiUrl: GENERAL_SETTINGS.OREST_URL,\n                    endpoint: OREST_ENDPOINT.HCMITEMIMG,\n                    token: authToken,\n                    gid: images[0].gid,\n                    params: {\n                        hotelrefno: Number(companyId),\n                    },\n                    data: {\n                        imgquality: value / 100,\n                        imgscale: value / 100,\n                    },\n                }).then((res1) => {\n                    if (res1?.status === 200 && res1?.data?.data) {\n                        setQuality(value)\n                    } else {\n                        const retErr = isErrorMsg(res)\n                        toast.error(retErr.errorMsg, {\n                            position: toast.POSITION.TOP_RIGHT,\n                        })\n                    }\n                })\n            } else {\n                setQuality(value)\n            }\n        }\n    }\n\n    const handleDialogOpen = (type) => {\n        if (type === 'title') {\n            setLocalState((prev) => ({\n                ...prev,\n                isTextEditorDialogOpen: true,\n                dialogType: type,\n                editorValue: imageTitle,\n            }))\n        }\n        if (type === 'description') {\n            setLocalState((prev) => ({\n                ...prev,\n                isTextEditorDialogOpen: true,\n                dialogType: type,\n                editorValue: imageDescription,\n            }))\n        }\n    }\n\n    const handleTextEditorValue = (value) => {\n        if (dialogType === 'title') {\n            setImageTitle(value)\n        }\n        if (dialogType === 'description') {\n            setImageDescription(value)\n        }\n        setLocalState((prev) => ({ ...prev, isTextEditorDialogOpen: false, dialogType: '', editorValue: '' }))\n    }\n\n    const handleCancelEditor = () => {\n        setLocalState((prev) => ({ ...prev, isTextEditorDialogOpen: false, dialogType: '', editorValue: '' }))\n    }\n\n    if (isSaving) {\n        return <LoadingSpinner style={{ color: COLORS.secondary }} />\n    }\n\n    return (\n        <React.Fragment>\n            <>\n                <Grid container={true} justify={'flex-start'}>\n                    <Grid item xs={6}>\n                        <FormControlLabel\n                            className={classes.labelFont}\n                            control={\n                                <Checkbox\n                                    size={'small'}\n                                    checked={isOptimizeImage}\n                                    onChange={() => setOptimizeImage(!isOptimizeImage)}\n                                    color=\"primary\"\n                                />\n                            }\n                            label=\"Optimize Images\"\n                        />\n                    </Grid>\n                    <Grid item xs={6}>\n                        <Grid container={true} justify={'flex-end'}>\n                            <Grid item xs={1} style={{ marginTop: 8 }}>\n                                <Typography component={'span'}>Text</Typography>\n                            </Grid>\n                            <Grid item xs={2}>\n                                <InputColor\n                                    onChange={(color) => setTextColor(color.hex)}\n                                    placement=\"right\"\n                                    initialValue={textColor}\n                                    style={{ marginTop: 8 }}\n                                />\n                            </Grid>\n                        </Grid>\n                    </Grid>\n                </Grid>\n                <Grid container>\n                    <Grid item xs={12}>\n                        {isOptimizeImage && (\n                            <PercentageSlider\n                                marks={PERCENTAGE_VALUES}\n                                value={quality}\n                                onChange={(e, value) => handleImageQualityChange(value)}\n                            />\n                        )}\n                    </Grid>\n                </Grid>\n                <Grid\n                    container={true}\n                    justify={'flex-start'}\n                    spacing={3}\n                    className={isDeleting ? classes.disableEvent : ''}\n                >\n                    <Grid\n                        item={true}\n                        xs={6}\n                        className={state.langCode !== state.defaultLang ? classes.disableEvent : ''}\n                    >\n                        <Paper className={classes.paperBlock}>\n                            {images.map((value, index) => {\n                                return (\n                                    <Grid container={true} key={index} justify={'center'}>\n                                        <Grid key={index} item>\n                                            <Card className={classes.card}>\n                                                <div\n                                                    style={{\n                                                        backgroundImage: `url(${\n                                                            GENERAL_SETTINGS.STATIC_URL + value.fileurl\n                                                        })`,\n                                                        height: '100%',\n                                                        width: '100%',\n                                                        backgroundSize: 'cover',\n                                                    }}\n                                                    onMouseEnter={() => setShowDeleteBtn(true)}\n                                                    onMouseLeave={() => setShowDeleteBtn(false)}\n                                                >\n                                                    {showDeleteBtn && (\n                                                        <IconButton\n                                                            onClick={deleteImage}\n                                                            className={\n                                                                state.langCode !== state.defaultLang\n                                                                    ? classes.disableEvent\n                                                                    : ''\n                                                            }\n                                                            aria-label=\"upload picture\"\n                                                            component=\"span\"\n                                                            style={{ float: 'right' }}\n                                                            color={'primary'}\n                                                        >\n                                                            <CancelIcon style={{ width: 30, height: 30 }} />\n                                                        </IconButton>\n                                                    )}\n                                                </div>\n                                            </Card>\n                                        </Grid>\n                                    </Grid>\n                                )\n                            })}\n                            {images.length === 0 && (\n                                <Typography\n                                    component={'div'}\n                                    style={{\n                                        height: 250,\n                                        display: 'flex',\n                                        alignItems: 'center',\n                                        justifyContent: 'center',\n                                    }}\n                                >\n                                    <Fab\n                                        onClick={openDialog}\n                                        variant=\"extended\"\n                                        size=\"small\"\n                                        color=\"primary\"\n                                        aria-label=\"add\"\n                                        className={classes.fabBtn}\n                                        disabled={images.length > 0}\n                                    >\n                                        <CloudUploadIcon />\n                                        UPLOAD\n                                    </Fab>\n                                </Typography>\n                            )}\n                            <DropzoneDialog\n                                open={isDialogOpen}\n                                onSave={saveImage}\n                                acceptedFiles={['image/jpeg', 'image/png', 'image/bmp']}\n                                showPreviews={true}\n                                maxFileSize={5000000}\n                                onClose={closeDialog}\n                                filesLimit={10}\n                            />\n                        </Paper>\n                    </Grid>\n                    <Grid item={true} xs={6}>\n                        <Paper className={classes.paperBlock}>\n                            <Grid container justify={'flex-start'}>\n                                <Grid item xs={3}>\n                                    <Typography component={'h6'} variant={'h6'} className={classes.heading}>\n                                        Title\n                                    </Typography>\n                                </Grid>\n                                <Grid item xs={9}>\n                                    <IconButton\n                                        aria-label=\"Edit Title\"\n                                        color=\"primary\"\n                                        onClick={() => handleDialogOpen('title')}\n                                        style={{ float: 'right' }}\n                                    >\n                                        <BorderColorSharpIcon color=\"primary\" />\n                                    </IconButton>\n                                </Grid>\n                            </Grid>\n                            <Grid container justify={'flex-start'}>\n                                <Grid item xs={3}>\n                                    <Typography\n                                        component={'h6'}\n                                        variant={'h6'}\n                                        className={classes.heading}\n                                        size={'small'}\n                                    >\n                                        Description\n                                    </Typography>\n                                </Grid>\n                                <Grid item xs={9}>\n                                    <IconButton\n                                        aria-label=\"Edit Title\"\n                                        color=\"primary\"\n                                        onClick={() => handleDialogOpen('description')}\n                                        style={{ float: 'right' }}\n                                    >\n                                        <BorderColorSharpIcon color=\"primary\" />\n                                    </IconButton>\n                                </Grid>\n                            </Grid>\n                            {(state.type === 'email' || state.type === 'emailOnly') && (\n                                <Grid container justify={'flex-start'}>\n                                    <Grid item xs={3}>\n                                        <Typography component={'h6'} variant={'h6'} className={classes.heading}>\n                                            Link\n                                        </Typography>\n                                    </Grid>\n                                    <Grid item xs={9}>\n                                        <TextField\n                                            id=\"image-description\"\n                                            variant={'outlined'}\n                                            fullWidth\n                                            placeholder={'Please Link here'}\n                                            onChange={(e) => setCta(e.target.value)}\n                                            size={'small'}\n                                            className={classes.textField}\n                                            error={cta && !validator.isURL(cta)}\n                                            value={cta}\n                                            disabled={state.langCode !== state.defaultLang}\n                                            helperText={\n                                                cta && (\n                                                    <Typography\n                                                        variant=\"caption\"\n                                                        className={classes.alignText}\n                                                        display=\"block\"\n                                                    >\n                                                        {`${cta?.length} < 100`}\n                                                    </Typography>\n                                                )\n                                            }\n                                            inputProps={{ maxLength: 99 }}\n                                        />\n                                    </Grid>\n                                </Grid>\n                            )}\n                            <Divider style={{ marginTop: 8 }} />\n                            <Button\n                                onClick={handleUpdateTitleDescription}\n                                variant=\"contained\"\n                                size=\"small\"\n                                color=\"primary\"\n                                aria-label=\"submit\"\n                                className={classes.submit}\n                                disabled={!imageTitle && !imageDescription}\n                            >\n                                SUBMIT\n                            </Button>\n                        </Paper>\n                    </Grid>\n                </Grid>\n            </>\n            {isTextEditorDialogOpen && (\n                <TextEditor\n                    handleSaveTextEditor={handleTextEditorValue}\n                    handleCancelTextEditor={handleCancelEditor}\n                    data={editorValue}\n                />\n            )}\n        </React.Fragment>\n    )\n}\n\nconst mapStateToProps = (state) => {\n    return {\n        state: state.formReducer.pageBuilder,\n    }\n}\n\nexport default connect(mapStateToProps)(EditImage)\n"]},"metadata":{},"sourceType":"module"}
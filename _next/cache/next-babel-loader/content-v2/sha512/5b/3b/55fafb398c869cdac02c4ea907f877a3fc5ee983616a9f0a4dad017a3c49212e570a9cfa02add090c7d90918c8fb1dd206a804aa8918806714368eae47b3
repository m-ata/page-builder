{"ast":null,"code":"var helpers = {\n  microName: function microName(mircoName) {\n    return '/api/' + mircoName;\n  },\n  getUrl: function getUrl(res, endPoint, gid) {\n    if (gid) {\n      return res.GENERAL_SETTINGS.OREST_URL + endPoint + '/' + gid;\n    }\n\n    return res.GENERAL_SETTINGS.OREST_URL + endPoint;\n  },\n  getHeaders: function getHeaders(req, res) {\n    var token = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    var isClientToken = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n\n    if (token) {\n      if (isClientToken) {\n        return {\n          Authorization: \"Bearer \".concat(token),\n          'Content-Type': 'application/json',\n          'User-Agent': \"WebCMS/\".concat(req.currentVersion || '', \" (WebCMS MS)\")\n        };\n      } else {\n        return {\n          Authorization: \"Bearer \".concat(token || res.OREST_CACHE_TOKEN),\n          ReqType: 'Company',\n          'Content-Type': 'application/json',\n          'User-Agent': \"WebCMS/\".concat(req.currentVersion || '', \" (WebCMS MS)\")\n        };\n      }\n    } else {\n      return {\n        Authorization: \"Bearer \".concat(req.query.hoteltoken && req.query.hoteltoken || token || res.OREST_CACHE_TOKEN),\n        ReqType: 'Company',\n        'Content-Type': 'application/json',\n        'User-Agent': \"WebCMS/\".concat(req.currentVersion || '', \" (WebCMS MS)\")\n      };\n    }\n  },\n  getSettings: function getSettings(req, res, key) {\n    return req.query.hotelrefno || res.GENERAL_SETTINGS[key.toUpperCase()];\n  },\n  isHotech: function isHotech(res) {\n    return res && res.GENERAL_SETTINGS && res.GENERAL_SETTINGS.isHotech || false;\n  },\n  isEmpty: function isEmpty(val) {\n    return val === '' || val === null;\n  },\n  strIsJson: function strIsJson(str) {\n    try {\n      JSON.parse(str);\n    } catch (e) {\n      return false;\n    }\n\n    return true;\n  },\n  creditCardMask: function creditCardMask(num) {\n    return \"\".concat('*'.repeat(num.length - 4)).concat(num.substr(num.length - 4));\n  },\n  generatePassword: function generatePassword() {\n    var length = 8,\n        charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789',\n        retVal = '';\n\n    for (var i = 0, n = charset.length; i < length; ++i) {\n      retVal += charset.charAt(Math.floor(Math.random() * n));\n    }\n\n    return retVal.toLowerCase();\n  },\n  formatMoney: function formatMoney(amount) {\n    var decimalCount = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 2;\n    var decimal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '.';\n    var thousands = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : ',';\n\n    try {\n      decimalCount = Math.abs(decimalCount);\n      decimalCount = isNaN(decimalCount) ? 2 : decimalCount;\n      var negativeSign = amount < 0 ? '-' : '';\n      var i = parseInt(amount = Math.abs(Number(amount) || 0).toFixed(decimalCount)).toString();\n      var j = i.length > 3 ? i.length % 3 : 0;\n      return negativeSign + (j ? i.substr(0, j) + thousands : '') + i.substr(j).replace(/(\\d{3})(?=\\d)/g, '$1' + thousands) + (decimalCount ? decimal + Math.abs(amount - i).toFixed(decimalCount).slice(2) : '');\n    } catch (e) {\n      console.log(e);\n    }\n  },\n  mobileTelNoFormat: function mobileTelNoFormat(telno) {\n    String.prototype.replaceAll = function (search, replacement) {\n      var target = this;\n      return target.split(search).join(replacement);\n    };\n\n    return (telno === null || telno === void 0 ? void 0 : telno.replaceAll(' ', '').replaceAll('-', '').replaceAll('(', '').replaceAll(')', '').replaceAll('+', '00')) || '';\n  },\n  bin2hex: function bin2hex(s) {\n    var i = 0,\n        l = s.length,\n        chr,\n        hex = '';\n\n    for (i; i < l; ++i) {\n      chr = s.charCodeAt(i).toString(16);\n      hex += chr.length < 2 ? '0' + chr : chr;\n    }\n\n    return hex;\n  },\n  encode_utf8: function encode_utf8(s) {\n    return unescape(encodeURIComponent(s));\n  },\n  urlencode: function urlencode(str) {\n    var newStr = '';\n    var len = str.length;\n\n    for (var i = 0; i < len; i++) {\n      var c = str.charAt(i);\n      var code = str.charCodeAt(i); // Spaces\n\n      if (c === ' ') {\n        newStr += '+';\n      } // Non-alphanumeric characters except \"-\", \"_\", and \".\"\n      else if (code < 48 && code !== 45 && code !== 46 || code < 65 && code > 57 || code > 90 && code < 97 && code !== 95 || code > 122) {\n          newStr += '%' + code.toString(16).toUpperCase();\n        } // Alphanumeric characters\n        else {\n            newStr += c;\n          }\n    }\n\n    return newStr;\n  },\n  encodeDataToURL: function encodeDataToURL(data) {\n    return Object.keys(data).map(function (value) {\n      return \"\".concat(value, \"=\").concat(typeof data[value] === 'string' ? helpers.urlencode(helpers.encode_utf8(data[value])) : data[value]);\n    }).join('&');\n  }\n};\nmodule.exports = helpers;","map":{"version":3,"sources":["/Users/mata/app-cloudweb/@api/core/helpers.js"],"names":["helpers","microName","mircoName","getUrl","res","endPoint","gid","GENERAL_SETTINGS","OREST_URL","getHeaders","req","token","isClientToken","Authorization","currentVersion","OREST_CACHE_TOKEN","ReqType","query","hoteltoken","getSettings","key","hotelrefno","toUpperCase","isHotech","isEmpty","val","strIsJson","str","JSON","parse","e","creditCardMask","num","repeat","length","substr","generatePassword","charset","retVal","i","n","charAt","Math","floor","random","toLowerCase","formatMoney","amount","decimalCount","decimal","thousands","abs","isNaN","negativeSign","parseInt","Number","toFixed","toString","j","replace","slice","console","log","mobileTelNoFormat","telno","String","prototype","replaceAll","search","replacement","target","split","join","bin2hex","s","l","chr","hex","charCodeAt","encode_utf8","unescape","encodeURIComponent","urlencode","newStr","len","c","code","encodeDataToURL","data","Object","keys","map","value","module","exports"],"mappings":"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","sourcesContent":["const helpers = {\n    microName: (mircoName) => {\n        return '/api/' + mircoName\n    },\n    getUrl: (res, endPoint, gid) => {\n        if (gid) {\n            return res.GENERAL_SETTINGS.OREST_URL + endPoint + '/' + gid\n        }\n\n        return res.GENERAL_SETTINGS.OREST_URL + endPoint\n    },\n    getHeaders: (req, res, token = false, isClientToken = false) => {\n        if (token) {\n            if (isClientToken) {\n                return {\n                    Authorization: `Bearer ${token}`,\n                    'Content-Type': 'application/json',\n                    'User-Agent': `WebCMS/${req.currentVersion || ''} (WebCMS MS)`,\n                }\n            } else {\n                return {\n                    Authorization: `Bearer ${token || res.OREST_CACHE_TOKEN}`,\n                    ReqType: 'Company',\n                    'Content-Type': 'application/json',\n                    'User-Agent': `WebCMS/${req.currentVersion || ''} (WebCMS MS)`,\n                }\n            }\n        } else {\n            return {\n                Authorization: `Bearer ${req.query.hoteltoken && req.query.hoteltoken || token || res.OREST_CACHE_TOKEN}`,\n                ReqType: 'Company',\n                'Content-Type': 'application/json',\n                'User-Agent': `WebCMS/${req.currentVersion || ''} (WebCMS MS)`,\n            }\n        }\n    },\n    getSettings: (req, res, key) => {\n        return req.query.hotelrefno || res.GENERAL_SETTINGS[key.toUpperCase()]\n    },\n    isHotech: (res) => {\n        return res && res.GENERAL_SETTINGS && res.GENERAL_SETTINGS.isHotech || false\n    },\n    isEmpty: (val) => {\n        return val === '' || val === null\n    },\n    strIsJson: (str) => {\n        try {\n            JSON.parse(str)\n        } catch (e) {\n            return false\n        }\n        return true\n    },\n    creditCardMask: (num) => {\n        return `${'*'.repeat(num.length - 4)}${num.substr(num.length - 4)}`\n    },\n    generatePassword: () => {\n        let length = 8,\n            charset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789',\n            retVal = ''\n        for (let i = 0, n = charset.length; i < length; ++i) {\n            retVal += charset.charAt(Math.floor(Math.random() * n))\n        }\n        return retVal.toLowerCase()\n    },\n    formatMoney: (amount, decimalCount = 2, decimal = '.', thousands = ',') => {\n        try {\n            decimalCount = Math.abs(decimalCount)\n            decimalCount = isNaN(decimalCount) ? 2 : decimalCount\n\n            const negativeSign = amount < 0 ? '-' : ''\n\n            let i = parseInt((amount = Math.abs(Number(amount) || 0).toFixed(decimalCount))).toString()\n            let j = i.length > 3 ? i.length % 3 : 0\n\n            return (\n                negativeSign +\n                (j ? i.substr(0, j) + thousands : '') +\n                i.substr(j).replace(/(\\d{3})(?=\\d)/g, '$1' + thousands) +\n                (decimalCount\n                    ? decimal +\n                    Math.abs(amount - i)\n                        .toFixed(decimalCount)\n                        .slice(2)\n                    : '')\n            )\n        } catch (e) {\n            console.log(e)\n        }\n    },\n    mobileTelNoFormat: (telno) => {\n        String.prototype.replaceAll = function(search, replacement) {\n            var target = this\n            return target.split(search).join(replacement)\n        }\n\n        return telno?.replaceAll(' ', '').replaceAll('-', '').replaceAll('(', '').replaceAll(')', '').replaceAll('+', '00') || ''\n    },\n    bin2hex: (s) => {\n        let i = 0, l = s.length, chr, hex = ''\n        for (i; i < l; ++i) {\n            chr = s.charCodeAt(i).toString(16)\n            hex += chr.length < 2 ? '0' + chr : chr\n        }\n        return hex\n    },\n    encode_utf8: (s) => {\n        return unescape(encodeURIComponent(s))\n    },\n    urlencode: (str) => {\n        let newStr = ''\n        const len = str.length\n\n        for (let i = 0; i < len; i++) {\n            let c = str.charAt(i)\n            let code = str.charCodeAt(i)\n\n            // Spaces\n            if (c === ' ') {\n                newStr += '+'\n            }\n            // Non-alphanumeric characters except \"-\", \"_\", and \".\"\n            else if ((code < 48 && code !== 45 && code !== 46) ||\n                (code < 65 && code > 57) ||\n                (code > 90 && code < 97 && code !== 95) ||\n                (code > 122)) {\n                newStr += '%' + code.toString(16).toUpperCase()\n            }\n            // Alphanumeric characters\n            else {\n                newStr += c\n            }\n        }\n\n        return newStr\n    },\n    encodeDataToURL: (data) => {\n        return Object\n            .keys(data)\n            .map(value => `${value}=${typeof data[value] === 'string' ? helpers.urlencode(helpers.encode_utf8(data[value])) : data[value]}`)\n            .join('&')\n    },\n}\n\nmodule.exports = helpers"]},"metadata":{},"sourceType":"script"}
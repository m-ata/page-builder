{"ast":null,"code":"var _jsxFileName = \"/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/steps/website/Final.js\";\nvar __jsx = React.createElement;\nimport React, { useState, useContext, useEffect } from 'react'; //material imports\n\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Checkbox, FormControlLabel } from \"@material-ui/core\"; //redux imports\n\nimport { connect } from 'react-redux';\nimport { setToState, updateState } from \"../../../../../state/actions\"; // imports for toaster\n\nimport { ToastContainer, toast } from 'react-toastify'; //imports configs\n\nimport WebCmsGlobal from \"components/webcms-global\";\nimport { isErrorMsg, OREST_ENDPOINT } from \"../../../../../model/orest/constants\"; //router import\n\nimport { useRouter } from \"next/router\";\nimport { Insert, Patch, ViewList } from \"@webcms/orest\";\nimport { COLORS, SAVED_SUCCESS, UPDATE_SUCCESS } from \"../../constants\";\nimport LoadingSpinner from \"../../../../LoadingSpinner\";\nconst useStyles = makeStyles(theme => ({\n  actionButton: {\n    marginLeft: theme.spacing(1),\n    borderRadius: 20\n  }\n}));\n\nconst WebsiteFinal = props => {\n  const {\n    state,\n    dialogTitle,\n    resetFinal,\n    updateState,\n    isWebsiteSelected\n  } = props;\n  const {\n    0: isOpen,\n    1: setOpen\n  } = useState(true);\n  const {\n    0: code,\n    1: setCode\n  } = useState('');\n  const {\n    0: description,\n    1: setDescription\n  } = useState('');\n  const {\n    0: langFileGID,\n    1: setLangFileGID\n  } = useState('');\n  const {\n    0: isTemplate,\n    1: setIsTemplate\n  } = useState(false);\n  const {\n    0: websiteData,\n    1: setWebsiteData\n  } = useState(null);\n  const emptyWebsite = {\n    header: {},\n    pages: [],\n    footer: {}\n  };\n  const {\n    0: isLoaded,\n    1: setIsLoaded\n  } = useState(true);\n  const classes = useStyles();\n  const {\n    GENERAL_SETTINGS,\n    token\n  } = useContext(WebCmsGlobal);\n  const router = useRouter();\n  const companyId = router.query.companyID;\n  const authToken = token || router.query.authToken;\n  useEffect(() => {\n    if (isWebsiteSelected) {\n      setIsLoaded(false);\n      ViewList({\n        apiUrl: GENERAL_SETTINGS.OREST_URL,\n        endpoint: OREST_ENDPOINT.RAFILE,\n        token: authToken,\n        params: {\n          query: `code:${state.code},filetype::WEBSITE`,\n          hotelrefno: Number(companyId)\n        }\n      }).then(res => {\n        var _res$data, _res$data$data;\n\n        if (res.status === 200 && (res === null || res === void 0 ? void 0 : (_res$data = res.data) === null || _res$data === void 0 ? void 0 : (_res$data$data = _res$data.data) === null || _res$data$data === void 0 ? void 0 : _res$data$data.length) > 0) {\n          setIsLoaded(true);\n          setWebsiteData(res.data.data[0]);\n\n          if (!res.data.data[0].istemplate) {\n            setIsTemplate(res.data.data[0].istemplate);\n            setCode(res.data.data[0].code);\n            setDescription(res.data.data[0].description);\n          }\n\n          ViewList({\n            apiUrl: GENERAL_SETTINGS.OREST_URL,\n            endpoint: OREST_ENDPOINT.RAFILE,\n            token: authToken,\n            params: {\n              query: `code:${state.code},filetype::LANG.WEBSITE,masterid::${res.data.data[0].mid}`,\n              hotelrefno: Number(companyId)\n            }\n          }).then(res1 => {\n            if (res1.status === 200 && res1.data && res1.data.data.length > 0) {\n              setLangFileGID(res1.data.data[0].gid);\n            }\n          });\n        } else {\n          setIsLoaded(true);\n        }\n      });\n    }\n  }, [isWebsiteSelected]);\n\n  const handleSave = () => {\n    //saving website into rafile\n    if (isWebsiteSelected) {\n      if (websiteData && websiteData.istemplate) {\n        insertRafile();\n      } else {\n        patchRafile();\n      }\n    } else {\n      insertRafile();\n    }\n  };\n\n  const insertRafile = () => {\n    setIsLoaded(false);\n    Insert({\n      // insert website to rafile\n      apiUrl: GENERAL_SETTINGS.OREST_URL,\n      endpoint: OREST_ENDPOINT.RAFILE,\n      token: authToken,\n      data: {\n        code: code,\n        description: description,\n        filetype: 'WEBSITE',\n        filedata: Buffer.from(JSON.stringify(state.website)).toString(\"base64\"),\n        istemplate: isTemplate,\n        hotelrefno: Number(companyId)\n      }\n    }).then(res => {\n      var _res$data2;\n\n      if (res.status === 200 && res !== null && res !== void 0 && (_res$data2 = res.data) !== null && _res$data2 !== void 0 && _res$data2.data) {\n        Insert({\n          // insert language file for web page into rafile\n          apiUrl: GENERAL_SETTINGS.OREST_URL,\n          endpoint: OREST_ENDPOINT.RAFILE,\n          token: authToken,\n          data: {\n            code: code,\n            description: description,\n            contentype: '0000530',\n            filetype: 'LANG.WEBSITE',\n            filedata: Buffer.from(JSON.stringify(state.langsFile)).toString('base64'),\n            masterid: res.data.data.mid,\n            hotelrefno: Number(companyId)\n          }\n        }).then(res1 => {\n          var _res1$data;\n\n          if (res1.status === 200 && res1 !== null && res1 !== void 0 && (_res1$data = res1.data) !== null && _res1$data !== void 0 && _res1$data.data) {\n            setIsLoaded(true);\n            updateState('pageBuilder', 'pageStep', 0);\n            updateState('pageBuilder', 'isTemplate', false);\n            updateState('pageBuilder', 'previousStep', 0);\n            updateState('pageBuilder', 'website', emptyWebsite);\n            updateState('pageBuilder', 'langsFile', {});\n            handleReset();\n            toast.success(SAVED_SUCCESS, {\n              position: toast.POSITION.TOP_RIGHT\n            });\n          } else {\n            setIsLoaded(true);\n            const retErr = isErrorMsg(res);\n            toast.error(retErr.errorMsg, {\n              position: toast.POSITION.TOP_RIGHT\n            });\n          }\n        });\n      } else {\n        setIsLoaded(true);\n\n        if (res.data.message) {\n          toast.error(res.data.message, {\n            position: toast.POSITION.TOP_RIGHT\n          });\n        }\n      }\n    });\n  };\n\n  const patchRafile = () => {\n    setIsLoaded(false);\n    Patch({\n      // update website into rafile\n      apiUrl: GENERAL_SETTINGS.OREST_URL,\n      endpoint: OREST_ENDPOINT.RAFILE,\n      token: authToken,\n      gid: websiteData.gid,\n      params: {\n        hotelrefno: Number(companyId)\n      },\n      data: {\n        code: code,\n        description: description,\n        filetype: 'WEBSITE',\n        filedata: Buffer.from(JSON.stringify(state.website)).toString(\"base64\"),\n        istemplate: isTemplate,\n        hotelrefno: Number(companyId)\n      }\n    }).then(res1 => {\n      var _res1$data2;\n\n      if (res1.status === 200 && res1 !== null && res1 !== void 0 && (_res1$data2 = res1.data) !== null && _res1$data2 !== void 0 && _res1$data2.data) {\n        Patch({\n          // update lang file for web page to rafile\n          apiUrl: GENERAL_SETTINGS.OREST_URL,\n          endpoint: OREST_ENDPOINT.RAFILE,\n          token: authToken,\n          gid: langFileGID,\n          params: {\n            hotelrefno: Number(companyId)\n          },\n          data: {\n            code: code,\n            description: description,\n            contentype: '0000530',\n            filetype: 'LANG.WEBSITE',\n            filedata: Buffer.from(JSON.stringify(state.langsFile)).toString('base64'),\n            masterid: res1.data.data.mid,\n            hotelrefno: Number(companyId)\n          }\n        }).then(res2 => {\n          var _res2$data;\n\n          if (res2.status === 200 && res2 !== null && res2 !== void 0 && (_res2$data = res2.data) !== null && _res2$data !== void 0 && _res2$data.data) {\n            setIsLoaded(true);\n            updateState('pageBuilder', 'pageStep', 0);\n            updateState('pageBuilder', 'isTemplate', false);\n            updateState('pageBuilder', 'previousStep', 0);\n            updateState('pageBuilder', 'website', emptyWebsite);\n            updateState('pageBuilder', 'langsFile', {});\n            toast.success(UPDATE_SUCCESS, {\n              position: toast.POSITION.TOP_RIGHT\n            });\n            handleReset();\n          } else {\n            setIsLoaded(true);\n            const retErr = isErrorMsg(res1);\n            toast.error(retErr.errorMsg, {\n              position: toast.POSITION.TOP_RIGHT\n            });\n          }\n        });\n      } else {\n        setIsLoaded(true);\n\n        if (res1.data.message) {\n          toast.error(res1.data.message, {\n            position: toast.POSITION.TOP_RIGHT\n          });\n        }\n      }\n    });\n  };\n\n  const handleReset = () => {\n    setCode('');\n    setDescription('');\n    setOpen(false);\n    resetFinal('');\n  };\n\n  return __jsx(React.Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 9\n    }\n  }, __jsx(Dialog, {\n    disableBackdropClick: true,\n    disableEnforceFocus: true,\n    fullWidth: true,\n    maxWidth: \"md\",\n    open: isOpen,\n    onClose: handleReset,\n    \"aria-labelledby\": \"form-dialog-title\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 255,\n      columnNumber: 13\n    }\n  }, __jsx(DialogTitle, {\n    color: \"secondary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 17\n    }\n  }, \" \", dialogTitle, \" \", __jsx(\"hr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 64\n    }\n  }), \" \"), __jsx(DialogContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 17\n    }\n  }, !isLoaded ? __jsx(LoadingSpinner, {\n    style: {\n      color: COLORS.secondary\n    },\n    size: 40,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 37\n    }\n  }) : __jsx(React.Fragment, null, __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 33\n    }\n  }, __jsx(TextField, {\n    label: \"Code\",\n    placeholder: \"Please enter code here ...\",\n    value: code,\n    style: {\n      minWidth: 500\n    },\n    onChange: e => setCode(e.target.value),\n    variant: \"outlined\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 37\n    }\n  })), __jsx(\"div\", {\n    style: {\n      marginTop: 30\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 33\n    }\n  }, __jsx(TextField, {\n    label: \"Description\",\n    placeholder: \"Please enter description here ...\",\n    value: description,\n    onChange: e => setDescription(e.target.value),\n    multiline: true,\n    style: {\n      minWidth: 500\n    },\n    rows: 1,\n    rowsMax: 4,\n    variant: \"outlined\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 37\n    }\n  })), __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 33\n    }\n  }, __jsx(FormControlLabel, {\n    control: __jsx(Checkbox, {\n      checked: isTemplate,\n      onChange: () => setIsTemplate(!isTemplate),\n      name: \"istemplate\",\n      color: \"primary\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 45\n      }\n    }),\n    label: \"Save as Template\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 37\n    }\n  })))), __jsx(DialogActions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 17\n    }\n  }, __jsx(Button, {\n    onClick: handleReset,\n    variant: \"contained\",\n    size: \"small\",\n    \"aria-label\": \"add\",\n    className: classes.actionButton,\n    disabled: !isLoaded,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 21\n    }\n  }, \"Cancel\"), __jsx(Button, {\n    onClick: handleSave,\n    className: classes.actionButton,\n    variant: \"contained\",\n    size: \"small\",\n    \"aria-label\": \"add\",\n    color: \"primary\",\n    disabled: !(description && code) || !isLoaded,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 21\n    }\n  }, \"APPLY\"))), __jsx(ToastContainer, {\n    autoClose: 8000,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 13\n    }\n  }));\n};\n\nconst mapStateToProps = state => {\n  return {\n    state: state.formReducer.pageBuilder\n  };\n};\n\nconst mapDispatchToProps = dispatch => ({\n  updateState: (stateType, stateName, value) => dispatch(updateState(stateType, stateName, value)),\n  setToState: (stateType, stateName, value) => dispatch(setToState(stateType, stateName, value))\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(WebsiteFinal);","map":{"version":3,"sources":["/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/steps/website/Final.js"],"names":["React","useState","useContext","useEffect","Dialog","DialogActions","DialogContent","DialogTitle","Button","TextField","makeStyles","Checkbox","FormControlLabel","connect","setToState","updateState","ToastContainer","toast","WebCmsGlobal","isErrorMsg","OREST_ENDPOINT","useRouter","Insert","Patch","ViewList","COLORS","SAVED_SUCCESS","UPDATE_SUCCESS","LoadingSpinner","useStyles","theme","actionButton","marginLeft","spacing","borderRadius","WebsiteFinal","props","state","dialogTitle","resetFinal","isWebsiteSelected","isOpen","setOpen","code","setCode","description","setDescription","langFileGID","setLangFileGID","isTemplate","setIsTemplate","websiteData","setWebsiteData","emptyWebsite","header","pages","footer","isLoaded","setIsLoaded","classes","GENERAL_SETTINGS","token","router","companyId","query","companyID","authToken","apiUrl","OREST_URL","endpoint","RAFILE","params","hotelrefno","Number","then","res","status","data","length","istemplate","mid","res1","gid","handleSave","insertRafile","patchRafile","filetype","filedata","Buffer","from","JSON","stringify","website","toString","contentype","langsFile","masterid","handleReset","success","position","POSITION","TOP_RIGHT","retErr","error","errorMsg","message","res2","color","secondary","minWidth","e","target","value","marginTop","mapStateToProps","formReducer","pageBuilder","mapDispatchToProps","dispatch","stateType","stateName"],"mappings":"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","sourcesContent":["import React, {useState, useContext, useEffect} from 'react';\n//material imports\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport {makeStyles} from \"@material-ui/core/styles\";\nimport {Checkbox, FormControlLabel} from \"@material-ui/core\";\n//redux imports\nimport { connect } from 'react-redux';\nimport {setToState, updateState} from \"../../../../../state/actions\";\n// imports for toaster\nimport { ToastContainer, toast } from 'react-toastify';\n//imports configs\nimport WebCmsGlobal from \"components/webcms-global\";\nimport {isErrorMsg, OREST_ENDPOINT} from \"../../../../../model/orest/constants\";\n//router import\nimport { useRouter } from \"next/router\";\n\nimport {Insert, Patch, ViewList} from \"@webcms/orest\";\nimport {COLORS, SAVED_SUCCESS, UPDATE_SUCCESS} from \"../../constants\";\nimport LoadingSpinner from \"../../../../LoadingSpinner\";\n\nconst useStyles = makeStyles(theme => ({\n    actionButton: {\n        marginLeft: theme.spacing(1),\n        borderRadius: 20,\n    }\n}));\n\nconst WebsiteFinal = (props) => {\n\n    const { state,\n        dialogTitle,\n        resetFinal,\n        updateState,\n        isWebsiteSelected\n    } = props;\n\n    const [isOpen, setOpen] = useState(true);\n    const [code, setCode] = useState('');\n    const [description, setDescription] = useState('');\n    const [langFileGID, setLangFileGID] = useState('');\n    const [isTemplate, setIsTemplate] = useState(false);\n    const [websiteData, setWebsiteData] = useState(null);\n    const emptyWebsite = {\n        header: {},\n        pages: [],\n        footer: {}\n    };\n    const [isLoaded, setIsLoaded] = useState(true);\n\n    const classes = useStyles();\n\n    const { GENERAL_SETTINGS, token } = useContext(WebCmsGlobal);\n\n    const router = useRouter();\n    const companyId = router.query.companyID;\n    const authToken = token || router.query.authToken;\n\n    useEffect(() => {\n        if (isWebsiteSelected) {\n            setIsLoaded(false);\n            ViewList({\n                apiUrl: GENERAL_SETTINGS.OREST_URL,\n                endpoint: OREST_ENDPOINT.RAFILE,\n                token: authToken,\n                params: {\n                    query: `code:${state.code},filetype::WEBSITE`,\n                    hotelrefno:  Number(companyId)\n                }\n            }).then(res => {\n                if (res.status === 200 && res?.data?.data?.length > 0) {\n                    setIsLoaded(true);\n                    setWebsiteData(res.data.data[0]);\n                    if (!res.data.data[0].istemplate) {\n                        setIsTemplate(res.data.data[0].istemplate);\n                        setCode(res.data.data[0].code);\n                        setDescription(res.data.data[0].description);\n                    }\n                    ViewList({\n                        apiUrl: GENERAL_SETTINGS.OREST_URL,\n                        endpoint: OREST_ENDPOINT.RAFILE,\n                        token: authToken,\n                        params: {\n                            query: `code:${state.code},filetype::LANG.WEBSITE,masterid::${res.data.data[0].mid}`,\n                            hotelrefno: Number(companyId),\n                        },\n                    }).then(res1 => {\n                        if (res1.status === 200 && res1.data && res1.data.data.length > 0) {\n                            setLangFileGID(res1.data.data[0].gid);\n                        }\n                    })\n                } else {\n                    setIsLoaded(true);\n                }\n            })\n        }\n    }, [isWebsiteSelected]);\n\n    const handleSave = () => { //saving website into rafile\n\n        if (isWebsiteSelected) {\n            if (websiteData && websiteData.istemplate) {\n                insertRafile();\n            } else {\n                patchRafile();\n            }\n        } else {\n            insertRafile();\n        }\n    };\n\n    const insertRafile = () => {\n        setIsLoaded(false);\n        Insert({ // insert website to rafile\n            apiUrl: GENERAL_SETTINGS.OREST_URL,\n            endpoint: OREST_ENDPOINT.RAFILE,\n            token: authToken,\n            data: {\n                code: code,\n                description: description,\n                filetype: 'WEBSITE',\n                filedata: Buffer.from(JSON.stringify(state.website)).toString(\"base64\"),\n                istemplate: isTemplate,\n                hotelrefno: Number(companyId)\n            },\n        }).then(res => {\n            if (res.status === 200 && res?.data?.data) {\n                Insert({\n                    // insert language file for web page into rafile\n                    apiUrl: GENERAL_SETTINGS.OREST_URL,\n                    endpoint: OREST_ENDPOINT.RAFILE,\n                    token: authToken,\n                    data: {\n                        code: code,\n                        description: description,\n                        contentype: '0000530',\n                        filetype: 'LANG.WEBSITE',\n                        filedata: Buffer.from(JSON.stringify(state.langsFile)).toString('base64'),\n                        masterid: res.data.data.mid,\n                        hotelrefno: Number(companyId),\n                    },\n                }).then(res1 => {\n                    if (res1.status === 200 && res1?.data?.data) {\n                        setIsLoaded(true);\n                        updateState('pageBuilder', 'pageStep', 0);\n                        updateState('pageBuilder', 'isTemplate', false);\n                        updateState('pageBuilder', 'previousStep', 0);\n                        updateState('pageBuilder', 'website', emptyWebsite);\n                        updateState('pageBuilder', 'langsFile', {});\n                        handleReset();\n                        toast.success(SAVED_SUCCESS, {\n                            position: toast.POSITION.TOP_RIGHT\n                        });\n                    } else {\n                        setIsLoaded(true);\n                        const retErr = isErrorMsg(res);\n                        toast.error(retErr.errorMsg, {\n                            position: toast.POSITION.TOP_RIGHT,\n                        })\n                    }\n                })\n            } else {\n                setIsLoaded(true);\n                if (res.data.message) {\n                    toast.error(res.data.message, {\n                        position: toast.POSITION.TOP_RIGHT\n                    });\n                }\n            }\n        })\n    }\n\n    const patchRafile = () => {\n        setIsLoaded(false);\n        Patch({ // update website into rafile\n            apiUrl: GENERAL_SETTINGS.OREST_URL,\n            endpoint: OREST_ENDPOINT.RAFILE,\n            token: authToken,\n            gid: websiteData.gid,\n            params: {\n                hotelrefno: Number(companyId)\n            },\n            data: {\n                code: code,\n                description: description,\n                filetype: 'WEBSITE',\n                filedata: Buffer.from(JSON.stringify(state.website)).toString(\"base64\"),\n                istemplate: isTemplate,\n                hotelrefno: Number(companyId)\n            },\n        }).then(res1 => {\n            if (res1.status === 200 && res1?.data?.data) {\n                Patch({\n                    // update lang file for web page to rafile\n                    apiUrl: GENERAL_SETTINGS.OREST_URL,\n                    endpoint: OREST_ENDPOINT.RAFILE,\n                    token: authToken,\n                    gid: langFileGID,\n                    params: {\n                        hotelrefno: Number(companyId)\n                    },\n                    data: {\n                        code: code,\n                        description: description,\n                        contentype: '0000530',\n                        filetype: 'LANG.WEBSITE',\n                        filedata: Buffer.from(JSON.stringify(state.langsFile)).toString('base64'),\n                        masterid: res1.data.data.mid,\n                        hotelrefno: Number(companyId),\n                    },\n                }).then(res2 => {\n                    if (res2.status === 200 && res2?.data?.data) {\n                        setIsLoaded(true);\n                        updateState('pageBuilder', 'pageStep', 0);\n                        updateState('pageBuilder', 'isTemplate', false);\n                        updateState('pageBuilder', 'previousStep', 0);\n                        updateState('pageBuilder', 'website', emptyWebsite);\n                        updateState('pageBuilder', 'langsFile', {});\n                        toast.success(UPDATE_SUCCESS, {\n                            position: toast.POSITION.TOP_RIGHT\n                        });\n                        handleReset();\n                    } else {\n                        setIsLoaded(true);\n                        const retErr = isErrorMsg(res1);\n                        toast.error(retErr.errorMsg, {\n                            position: toast.POSITION.TOP_RIGHT,\n                        })\n                    }\n                })\n            } else {\n                setIsLoaded(true);\n                if (res1.data.message) {\n                    toast.error(res1.data.message, {\n                        position: toast.POSITION.TOP_RIGHT\n                    });\n                }\n            }\n        })\n    }\n\n    const handleReset = () => {\n        setCode('');\n        setDescription('');\n        setOpen(false);\n        resetFinal('');\n    }\n\n    return (\n        <React.Fragment>\n            <Dialog disableBackdropClick disableEnforceFocus fullWidth={true} maxWidth=\"md\" open={isOpen} onClose={handleReset} aria-labelledby=\"form-dialog-title\">\n                <DialogTitle color=\"secondary\" > {dialogTitle} <hr /> </DialogTitle>\n                <DialogContent>\n                    {\n                        !isLoaded ? <LoadingSpinner style={{color: COLORS.secondary}} size={40} /> :\n                            <>\n                                <div>\n                                    <TextField\n                                        label='Code'\n                                        placeholder=\"Please enter code here ...\"\n                                        value={code}\n                                        style={{minWidth: 500}}\n                                        onChange={(e) => setCode(e.target.value)}\n                                        variant=\"outlined\"\n                                    >\n                                    </TextField>\n                                </div>\n                                <div style={{marginTop: 30}}>\n                                    <TextField\n                                        label='Description'\n                                        placeholder=\"Please enter description here ...\"\n                                        value={description}\n                                        onChange={(e) => setDescription(e.target.value)}\n                                        multiline\n                                        style={{minWidth: 500}}\n                                        rows={1}\n                                        rowsMax={4}\n                                        variant=\"outlined\"\n                                    />\n                                </div>\n                                <div>\n                                    <FormControlLabel\n                                        control={\n                                            <Checkbox\n                                                checked={isTemplate}\n                                                onChange={() => setIsTemplate(!isTemplate)}\n                                                name=\"istemplate\"\n                                                color=\"primary\"\n                                            />\n                                        }\n                                        label=\"Save as Template\"\n                                    />\n                                </div>\n                            </>\n                    }\n                </DialogContent>\n                <DialogActions>\n                    <Button\n                        onClick={handleReset}\n                        variant=\"contained\"\n                        size=\"small\"\n                        aria-label=\"add\"\n                        className={classes.actionButton}\n                        disabled={!isLoaded}\n                    >\n                        Cancel\n                    </Button>\n\n                    <Button\n                        onClick={handleSave}\n                        className={classes.actionButton}\n                        variant=\"contained\"\n                        size=\"small\"\n                        aria-label=\"add\"\n                        color=\"primary\"\n                        disabled={!(description && code) || !isLoaded}\n                    >\n                        APPLY\n                    </Button>\n                </DialogActions>\n            </Dialog>\n\n\n\n            <ToastContainer autoClose={8000} />\n        </React.Fragment>\n    )\n}\n\nconst mapStateToProps = state => {\n    return {\n        state: state.formReducer.pageBuilder\n    }\n};\n\nconst mapDispatchToProps = dispatch => ({\n    updateState: (stateType, stateName, value) => dispatch(updateState(stateType, stateName, value)),\n    setToState: (stateType, stateName, value) => dispatch(setToState(stateType, stateName, value)),\n});\n\nexport default connect(\n    mapStateToProps,\n    mapDispatchToProps\n)(WebsiteFinal);\n"]},"metadata":{},"sourceType":"module"}
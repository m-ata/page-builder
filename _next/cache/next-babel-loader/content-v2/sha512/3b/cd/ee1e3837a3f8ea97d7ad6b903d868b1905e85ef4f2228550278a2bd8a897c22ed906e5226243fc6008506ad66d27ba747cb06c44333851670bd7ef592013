{"ast":null,"code":"var _jsxFileName = \"/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/steps/faq/FAQSave.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useContext, useEffect, useState } from 'react';\nimport { Button, Dialog, DialogTitle, DialogContent, DialogActions, FormControlLabel, Checkbox, TextField } from \"@material-ui/core\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { connect } from 'react-redux';\nimport { updateState as _updateState } from \"../../../../../state/actions\";\nimport { useRouter } from \"next/router\";\nimport { Insert, Patch, ViewList } from \"@webcms/orest\";\nimport { isErrorMsg, OREST_ENDPOINT } from \"../../../../../model/orest/constants\";\nimport WebCmsGlobal from \"components/webcms-global\";\nimport { toast } from \"react-toastify\";\nimport { SAVED_SUCCESS, UPDATE_SUCCESS } from \"../../constants\";\nvar useStyles = makeStyles(function (theme) {\n  return {\n    actionButton: {\n      marginLeft: theme.spacing(1),\n      borderRadius: 20\n    }\n  };\n});\n\nvar FAQSave = function FAQSave(props) {\n  _s();\n\n  var state = props.state,\n      updateState = props.updateState,\n      resetFinal = props.resetFinal; //local state\n\n  var _useState = useState(true),\n      isOpen = _useState[0],\n      setOpen = _useState[1];\n\n  var _useState2 = useState(''),\n      code = _useState2[0],\n      setCode = _useState2[1];\n\n  var _useState3 = useState(''),\n      description = _useState3[0],\n      setDescription = _useState3[1];\n\n  var _useState4 = useState(false),\n      isTemplate = _useState4[0],\n      setIsTemplate = _useState4[1];\n\n  var classes = useStyles();\n  var router = useRouter();\n  var companyId = router.query.companyID;\n\n  var _useContext = useContext(WebCmsGlobal),\n      GENERAL_SETTINGS = _useContext.GENERAL_SETTINGS,\n      token = _useContext.token;\n\n  var authToken = token || router.query.authToken;\n  useEffect(function () {\n    if (router.query.filegid) {\n      ViewList({\n        apiUrl: GENERAL_SETTINGS.OREST_URL,\n        endpoint: OREST_ENDPOINT.RAFILE,\n        token: authToken,\n        params: {\n          hotelrefno: Number(companyId),\n          query: \"gid:\".concat(router.query.filegid)\n        }\n      }).then(function (res) {\n        if (res && res.status === 200 && res.data && res.data.data && res.data.data.length > 0) {\n          setCode(res.data.data[0].code);\n          setDescription(res.data.data[0].description);\n          setIsTemplate(res.data.data[0].istemplate);\n        }\n      });\n    }\n  }, []);\n\n  var handleReset = function handleReset() {\n    setCode('');\n    setDescription('');\n    setOpen(false);\n    resetFinal('');\n  };\n\n  var handleSave = function handleSave() {\n    router.query.filegid ? updateFAQ(router.query.filegid) : insertFAQ();\n  };\n\n  var insertFAQ = function insertFAQ() {\n    // insert faq to rafile\n    Insert({\n      apiUrl: GENERAL_SETTINGS.OREST_URL,\n      endpoint: OREST_ENDPOINT.RAFILE,\n      token: authToken,\n      data: {\n        code: code,\n        description: description,\n        contentype: '0000525',\n        filetype: 'FAQ',\n        filedata: Buffer.from(JSON.stringify(state.faq)).toString(\"base64\"),\n        istemplate: isTemplate,\n        masterid: router.query.masterid ? router.query.masterid : null,\n        langid: state.langId,\n        langcode: state.langCode,\n        langdesc: state.langDesc,\n        hotelrefno: Number(companyId)\n      }\n    }).then(function (res) {\n      if (res.status === 200 && res.data && res.data.data) {\n        updateState('pageBuilder', 'previousStep', 0);\n        updateState('pageBuilder', 'pageStep', 0);\n        updateState('pageBuilder', 'faq', [{\n          id: 'cat-0',\n          type: 'category',\n          text: 'New Category',\n          items: []\n        }]);\n        updateState('pageBuilder', 'faqActiveTab', 'cat-0');\n        toast.success(SAVED_SUCCESS, {\n          position: toast.POSITION.TOP_RIGHT\n        });\n        handleReset();\n      } else {\n        var retErr = isErrorMsg(res);\n        toast.error(retErr.errorMsg, {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      }\n    });\n  };\n\n  var updateFAQ = function updateFAQ(gid) {\n    // update faq into rafile\n    Patch({\n      apiUrl: GENERAL_SETTINGS.OREST_URL,\n      endpoint: OREST_ENDPOINT.RAFILE,\n      token: authToken,\n      gid: gid,\n      data: {\n        code: code,\n        description: description,\n        contentype: '0000525',\n        filedata: Buffer.from(JSON.stringify(state.faq)).toString('base64'),\n        istemplate: isTemplate,\n        langid: state.langId,\n        langcode: state.langCode,\n        langdesc: state.langDesc,\n        hotelrefno: Number(companyId)\n      }\n    }).then(function (res) {\n      if (res && res.status === 200 && res.data && res.data.data) {\n        updateState('pageBuilder', 'previousStep', 0);\n        updateState('pageBuilder', 'pageStep', 0);\n        updateState('pageBuilder', 'faqActiveTab', 'cat-0');\n        toast.success(UPDATE_SUCCESS, {\n          position: toast.POSITION.TOP_RIGHT\n        });\n        handleReset();\n      } else {\n        var retErr = isErrorMsg(res);\n        toast.error(retErr.errorMsg, {\n          position: toast.POSITION.TOP_RIGHT\n        });\n      }\n    });\n  };\n\n  return __jsx(Dialog, {\n    disableBackdropClick: true,\n    disableEnforceFocus: true,\n    fullWidth: true,\n    maxWidth: \"md\",\n    open: isOpen,\n    onClose: handleReset,\n    \"aria-labelledby\": \"form-dialog-title\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 9\n    }\n  }, __jsx(DialogTitle, {\n    color: \"secondary\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 13\n    }\n  }, \"Save\", __jsx(\"hr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 17\n    }\n  })), __jsx(DialogContent, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 17\n    }\n  }, __jsx(TextField, {\n    label: \"Code\",\n    placeholder: \"Please enter code here ...\",\n    value: code,\n    style: {\n      minWidth: 500\n    },\n    onChange: function onChange(e) {\n      return setCode(e.target.value);\n    },\n    variant: \"outlined\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 21\n    }\n  })), __jsx(\"div\", {\n    style: {\n      marginTop: 30\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 17\n    }\n  }, __jsx(TextField, {\n    label: \"Description\",\n    placeholder: \"Please enter description here ...\",\n    value: description,\n    onChange: function onChange(e) {\n      return setDescription(e.target.value);\n    },\n    multiline: true,\n    style: {\n      minWidth: 500\n    },\n    rows: 1,\n    rowsMax: 4,\n    variant: \"outlined\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 21\n    }\n  })), __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 17\n    }\n  }, __jsx(FormControlLabel, {\n    control: __jsx(Checkbox, {\n      checked: isTemplate,\n      onChange: function onChange() {\n        return setIsTemplate(!isTemplate);\n      },\n      name: \"isTemplate\",\n      color: \"primary\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 29\n      }\n    }),\n    label: \"Save as Template\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 21\n    }\n  }))), __jsx(DialogActions, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 13\n    }\n  }, __jsx(Button, {\n    onClick: handleReset,\n    variant: \"contained\",\n    size: \"small\",\n    \"aria-label\": \"add\",\n    className: classes.actionButton,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 17\n    }\n  }, \"Cancel\"), __jsx(Button, {\n    onClick: handleSave,\n    className: classes.actionButton,\n    variant: \"contained\",\n    size: \"small\",\n    \"aria-label\": \"add\",\n    color: \"primary\",\n    disabled: !(description && code),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 17\n    }\n  }, \"APPLY\")));\n};\n\n_s(FAQSave, \"drBaL9uAHYIbBwk0oW4vTpfHrT4=\", false, function () {\n  return [useStyles, useRouter];\n});\n\n_c = FAQSave;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    state: state.formReducer.pageBuilder\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    updateState: function updateState(stateType, stateName, value) {\n      return dispatch(_updateState(stateType, stateName, value));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FAQSave);\n\nvar _c;\n\n$RefreshReg$(_c, \"FAQSave\");","map":{"version":3,"sources":["/Users/mata/app-cloudweb/components/page-builder/PageBuilderSteps/steps/faq/FAQSave.js"],"names":["React","useContext","useEffect","useState","Button","Dialog","DialogTitle","DialogContent","DialogActions","FormControlLabel","Checkbox","TextField","makeStyles","connect","updateState","useRouter","Insert","Patch","ViewList","isErrorMsg","OREST_ENDPOINT","WebCmsGlobal","toast","SAVED_SUCCESS","UPDATE_SUCCESS","useStyles","theme","actionButton","marginLeft","spacing","borderRadius","FAQSave","props","state","resetFinal","isOpen","setOpen","code","setCode","description","setDescription","isTemplate","setIsTemplate","classes","router","companyId","query","companyID","GENERAL_SETTINGS","token","authToken","filegid","apiUrl","OREST_URL","endpoint","RAFILE","params","hotelrefno","Number","then","res","status","data","length","istemplate","handleReset","handleSave","updateFAQ","insertFAQ","contentype","filetype","filedata","Buffer","from","JSON","stringify","faq","toString","masterid","langid","langId","langcode","langCode","langdesc","langDesc","id","type","text","items","success","position","POSITION","TOP_RIGHT","retErr","error","errorMsg","gid","minWidth","e","target","value","marginTop","mapStateToProps","formReducer","pageBuilder","mapDispatchToProps","dispatch","stateType","stateName"],"mappings":"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","sourcesContent":["import React, {useContext, useEffect, useState} from 'react';\nimport {Button, Dialog, DialogTitle, DialogContent, DialogActions, FormControlLabel, Checkbox, TextField} from \"@material-ui/core\";\nimport {makeStyles} from \"@material-ui/core/styles\";\nimport { connect } from 'react-redux'\nimport {updateState} from \"../../../../../state/actions\";\nimport {useRouter} from \"next/router\";\nimport {Insert, Patch, ViewList} from \"@webcms/orest\";\nimport {isErrorMsg, OREST_ENDPOINT} from \"../../../../../model/orest/constants\";\nimport WebCmsGlobal from \"components/webcms-global\";\nimport {toast} from \"react-toastify\";\nimport {SAVED_SUCCESS, UPDATE_SUCCESS} from \"../../constants\";\n\nconst useStyles = makeStyles((theme) => ({\n    actionButton: {\n        marginLeft: theme.spacing(1),\n        borderRadius: 20,\n    },\n}))\n\nconst FAQSave = (props) => {\n\n    const { state, updateState, resetFinal } = props;\n    //local state\n    const [isOpen, setOpen] = useState(true)\n    const [code, setCode] = useState('')\n    const [description, setDescription] = useState('')\n    const [isTemplate, setIsTemplate] = useState(false)\n    const classes = useStyles();\n\n    const router = useRouter();\n    const companyId = router.query.companyID;\n    const { GENERAL_SETTINGS, token } = useContext(WebCmsGlobal);\n    const authToken = token || router.query.authToken;\n\n    useEffect(() => {\n        if (router.query.filegid) {\n            ViewList({\n                apiUrl: GENERAL_SETTINGS.OREST_URL,\n                endpoint: OREST_ENDPOINT.RAFILE,\n                token: authToken,\n                params: {\n                    hotelrefno: Number(companyId),\n                    query: `gid:${router.query.filegid}`\n                },\n            }).then(res => {\n                if (res && res.status === 200 && res.data && res.data.data && res.data.data.length > 0) {\n                    setCode(res.data.data[0].code);\n                    setDescription(res.data.data[0].description);\n                    setIsTemplate(res.data.data[0].istemplate);\n                }\n            })\n        }\n    }, []);\n\n    const handleReset = () => {\n        setCode('')\n        setDescription('')\n        setOpen(false)\n        resetFinal('')\n    }\n\n    const handleSave = () => {\n        router.query.filegid ? updateFAQ(router.query.filegid) : insertFAQ();\n    }\n\n    const insertFAQ = () => { // insert faq to rafile\n        Insert({\n            apiUrl: GENERAL_SETTINGS.OREST_URL,\n            endpoint: OREST_ENDPOINT.RAFILE,\n            token: authToken,\n            data: {\n                code: code,\n                description: description,\n                contentype: '0000525',\n                filetype: 'FAQ',\n                filedata: Buffer.from(JSON.stringify(state.faq)).toString(\"base64\"),\n                istemplate: isTemplate,\n                masterid: router.query.masterid ?  router.query.masterid : null,\n                langid: state.langId,\n                langcode: state.langCode,\n                langdesc: state.langDesc,\n                hotelrefno: Number(companyId)\n            },\n        }).then(res => {\n            if (res.status === 200 && res.data && res.data.data) {\n                updateState('pageBuilder', 'previousStep', 0);\n                updateState('pageBuilder', 'pageStep', 0);\n                updateState('pageBuilder', 'faq', [{\n                    id: 'cat-0',\n                    type: 'category',\n                    text: 'New Category',\n                    items: []\n                }]);\n                updateState('pageBuilder', 'faqActiveTab', 'cat-0');\n                toast.success(SAVED_SUCCESS, {\n                    position: toast.POSITION.TOP_RIGHT\n                });\n                handleReset();\n            } else {\n                const retErr = isErrorMsg(res);\n                toast.error(retErr.errorMsg, {\n                    position: toast.POSITION.TOP_RIGHT,\n                })\n            }\n        })\n    }\n\n    const updateFAQ = (gid) => { // update faq into rafile\n        Patch({\n            apiUrl: GENERAL_SETTINGS.OREST_URL,\n            endpoint: OREST_ENDPOINT.RAFILE,\n            token: authToken,\n            gid: gid,\n            data: {\n                code: code,\n                description: description,\n                contentype: '0000525',\n                filedata: Buffer.from(JSON.stringify(state.faq)).toString('base64'),\n                istemplate: isTemplate,\n                langid: state.langId,\n                langcode: state.langCode,\n                langdesc: state.langDesc,\n                hotelrefno: Number(companyId),\n            },\n        }).then(res => {\n            if (res && res.status === 200 && res.data && res.data.data) {\n                updateState('pageBuilder', 'previousStep', 0);\n                updateState('pageBuilder', 'pageStep', 0);\n                updateState('pageBuilder', 'faqActiveTab', 'cat-0');\n                toast.success(UPDATE_SUCCESS, {\n                    position: toast.POSITION.TOP_RIGHT\n                });\n                handleReset();\n            } else {\n                const retErr = isErrorMsg(res);\n                toast.error(retErr.errorMsg, {\n                    position: toast.POSITION.TOP_RIGHT,\n                })\n            }\n        })\n    }\n\n    return (\n        <Dialog\n            disableBackdropClick\n            disableEnforceFocus\n            fullWidth={true}\n            maxWidth=\"md\"\n            open={isOpen}\n            onClose={handleReset}\n            aria-labelledby=\"form-dialog-title\"\n        >\n            <DialogTitle color=\"secondary\">\n                Save\n                <hr />\n            </DialogTitle>\n            <DialogContent>\n                <div>\n                    <TextField\n                        label=\"Code\"\n                        placeholder=\"Please enter code here ...\"\n                        value={code}\n                        style={{ minWidth: 500 }}\n                        onChange={(e) => setCode(e.target.value)}\n                        variant=\"outlined\"\n                    />\n                </div>\n                <div style={{ marginTop: 30 }}>\n                    <TextField\n                        label=\"Description\"\n                        placeholder=\"Please enter description here ...\"\n                        value={description}\n                        onChange={(e) => setDescription(e.target.value)}\n                        multiline\n                        style={{ minWidth: 500 }}\n                        rows={1}\n                        rowsMax={4}\n                        variant=\"outlined\"\n                    />\n                </div>\n                <div>\n                    <FormControlLabel\n                        control={\n                            <Checkbox\n                                checked={isTemplate}\n                                onChange={() => setIsTemplate(!isTemplate)}\n                                name=\"isTemplate\"\n                                color=\"primary\"\n                            />\n                        }\n                        label=\"Save as Template\"\n                    />\n                </div>\n            </DialogContent>\n            <DialogActions>\n                <Button\n                    onClick={handleReset}\n                    variant=\"contained\"\n                    size=\"small\"\n                    aria-label=\"add\"\n                    className={classes.actionButton}\n                >\n                    Cancel\n                </Button>\n                <Button\n                    onClick={handleSave}\n                    className={classes.actionButton}\n                    variant=\"contained\"\n                    size=\"small\"\n                    aria-label=\"add\"\n                    color=\"primary\"\n                    disabled={!(description && code)}\n                >\n                    APPLY\n                </Button>\n            </DialogActions>\n        </Dialog>\n    )\n}\n\nconst mapStateToProps = (state) => {\n    return {\n        state: state.formReducer.pageBuilder,\n    }\n}\n\nconst mapDispatchToProps = (dispatch) => ({\n    updateState: (stateType, stateName, value) => dispatch(updateState(stateType, stateName, value)),\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FAQSave);"]},"metadata":{},"sourceType":"module"}